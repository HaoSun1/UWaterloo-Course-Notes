% header -----------------------------------------------------------------------
% Template created by texnew (author: Alex Rutar); info can be found at 'https://github.com/alexrutar/texnew'.
% version (1.6)


% doctype ----------------------------------------------------------------------
\documentclass[11pt, a4paper]{memoir}
\usepackage[ascii]{inputenc}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=4cm]{geometry}
\usepackage[protrusion=true,expansion=true]{microtype}


% packages ---------------------------------------------------------------------
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{graphicx}
\usepackage{etoolbox}

% Set enimitem
\usepackage{enumitem}
\SetEnumitemKey{nl}{nolistsep}
\SetEnumitemKey{r}{label=(\roman*)}

% Set tikz
\usepackage{tikz, pgfplots}
\pgfplotsset{compat=1.15}
\usetikzlibrary{intersections,positioning,cd}
\usetikzlibrary{arrows,arrows.meta}
\tikzcdset{arrow style=tikz,diagrams={>=stealth}}
\tikzset{
  symbol/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
  }
}


% macros -----------------------------------------------------------------------
\DeclareMathOperator{\N}{{\mathbb{N}}}
\DeclareMathOperator{\Q}{{\mathbb{Q}}}
\DeclareMathOperator{\Z}{{\mathbb{Z}}}
\DeclareMathOperator{\R}{{\mathbb{R}}}
\DeclareMathOperator{\C}{{\mathbb{C}}}
\DeclareMathOperator{\F}{{\mathbb{F}}}

% proof implications
\newcommand{\impendc}{\hspace{0.3cm}}

\newcommand{\iimp}[2]{($#1\Rightarrow#2$)}
\newcommand{\iimpe}[2]{($#1\Leftrightarrow#2$)}
\newcommand{\iimpr}{($\Rightarrow$)}
\newcommand{\iimpl}{($\Leftarrow$)}

\newcommand{\imp}[2]{\iimp{#1}{#2}\impendc}
\newcommand{\impe}[2]{\iimpe{#1}{#2}\impendc}
\newcommand{\impr}{\iimpr\impendc}
\newcommand{\impl}{\iimpl\impendc}

% multi-line align space
\newcommand{\agspace}{\ensuremath{\phantom{--}}}

% convenient brackets
\newcommand{\brac}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\norm}[1]{\ensuremath{\left\lVert#1\right\rVert}}
\newcommand{\abs}[1]{\ensuremath{\left\lvert#1\right\rvert}}

% smaller fractions
\newcommand{\sfrac}[2]{\ensuremath{\frac{\scriptstyle #1}{\scriptstyle #2}}}

% arrows
\newcommand{\lto}[0]{\ensuremath{\longrightarrow}}
\newcommand{\fto}[1]{\ensuremath{\xrightarrow{\scriptscriptstyle{#1}}}}
\newcommand{\hto}[0]{\ensuremath{\hookrightarrow}}
 
% Divides, Not Divides
\renewcommand{\div}{\bigm|}
\newcommand{\ndiv}{%
    \mathrel{\mkern.5mu % small adjustment
        % superimpose \nmid to \big|
        \ooalign{\hidewidth$\big|$\hidewidth\cr$/$\cr}%
    }%
}

% Convenient ol
\newcommand{\ol}[1]{\ensuremath{\overline{#1}}}

% Big \cdot
\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

% Disjoint Union
\makeatletter
\providecommand*{\cupdot}{%
  \mathbin{%
    \mathpalette\@cupdot{}%
  }%
}
\newcommand*{\@cupdot}[2]{%
  \ooalign{%
    $\m@th#1\cup$\cr
    \sbox0{$#1\cup$}%
    \dimen@=\ht0 %
    \sbox0{$\m@th#1\cdot$}%
    \advance\dimen@ by -\ht0 %
    \dimen@=.5\dimen@
    \hidewidth\raise\dimen@\box0\hidewidth
  }%
}

\providecommand*{\bigcupdot}{%
  \mathop{%
    \vphantom{\bigcup}%
    \mathpalette\@bigcupdot{}%
  }%
}
\newcommand*{\@bigcupdot}[2]{%
  \ooalign{%
    $\m@th#1\bigcup$\cr
    \sbox0{$#1\bigcup$}%
    \dimen@=\ht0 %
    \advance\dimen@ by -\dp0 %
    \sbox0{\scalebox{2}{$\m@th#1\cdot$}}%
    \advance\dimen@ by -\ht0 %
    \dimen@=.5\dimen@
    \hidewidth\raise\dimen@\box0\hidewidth
  }%
}
\makeatother


% macros (theorem) -------------------------------------------------------------
\usepackage[hidelinks]{hyperref}
\usepackage[thmmarks,amsmath,hyperref]{ntheorem}
\usepackage[capitalise,nameinlink]{cleveref}
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

% Numbered Statements
\theoremstyle{change}
\theoremindent\parindent
\theorembodyfont{\itshape}
\theoremheaderfont{\bfseries\boldmath}
\newtheorem{theorem}{Theorem.}[section]
\newtheorem{lemma}[theorem]{Lemma.}
\newtheorem{corollary}[theorem]{Corollary.}
\newtheorem{proposition}[theorem]{Proposition.}

% Claim environment
\theoremstyle{plain}
\theorempreskip{0.2cm}
\theorempostskip{0.2cm}
\theoremnumbering{Roman}
\theoremheaderfont{\scshape}
\newtheorem{claim}{Claim}
\AtBeginEnvironment{theorem}{\setcounter{claim}{0}}

% Case environment
\newcounter{casect}
\AtBeginEnvironment{proof}{\setcounter{casect}{0}}
\newcommand{\case}[1]{\stepcounter{casect}\textit{Case \thecasect: #1.}}

% Un-numbered Statements
\theorempreskip{0.1cm}
\theorempostskip{0.1cm}
\theoremindent0.0cm
\theoremstyle{nonumberplain}
\theorembodyfont{\upshape}
\theoremheaderfont{\bfseries\itshape}
\newtheorem{definition}{Definition.}
\theoremheaderfont{\itshape}
\newtheorem{example}{Example.}
\newtheorem{remark}{Remark.}

% Proof / solution environments
\theoremseparator{}
\theoremheaderfont{\hspace*{\parindent}\scshape}
\theoremsymbol{$//$}
\newtheorem{solution}{Sol'n}
\theoremsymbol{$\blacksquare$}
\theorempostskip{0.4cm}
\newtheorem{proof}{Proof}
\theoremsymbol{}
\newtheorem{nmproof}{Proof}

% format references
\crefformat{equation}{(Eq. #2#1#3)}
\crefformat{theorem}{(Thm. #2#1#3)}
\crefformat{lemma}{(Lem. #2#1#3)}
\crefformat{corollary}{(Cor. #2#1#3)}
\crefformat{proposition}{(Prop. #2#1#3)}
\crefformat{claim}{(cl. #2#1#3)}


% macros (algebra) -------------------------------------------------------------
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\chr}{char}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Fix}{Fix}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\Nil}{Nil}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\Tor}{Tor}

% Lagrange symbol
\newcommand{\lgs}[2]{\ensuremath{\left(\frac{#1}{#2}\right)}}

% Quotient (larger in display mode)
\newcommand{\quot}[2]{\mathchoice{\left.\raisebox{0.07em}{$#1$}\middle/\raisebox{-0.07em}{$#2$}\right.}
                                 {\left.\raisebox{0.03em}{$#1$}\middle/\raisebox{-0.03em}{$#2$}\right.}
                                 {\left.\raisebox{0.00em}{$#1$}\middle/\raisebox{-0.00em}{$#2$}\right.}
                                 {\left.\raisebox{0em}{$#1$}\middle/\raisebox{0em}{$#2$}\right.}}


% macros (analysis) ------------------------------------------------------------
\DeclareMathOperator{\M}{{\mathcal{M}}}
\DeclareMathOperator{\B}{{\mathcal{B}}}
\DeclareMathOperator{\ps}{{\mathcal{P}}}
\DeclareMathOperator{\pr}{{\mathbb{P}}}
\DeclareMathOperator{\E}{{\mathbb{E}}}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\sgn}{sgn}

\renewcommand{\Re}{\ensuremath{\operatorname{Re}}}
\renewcommand{\Im}{\ensuremath{\operatorname{Im}}}


% file-specific preamble -------------------------------------------------------
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Cl}{Cl}
\usepackage{showkeys}
\newcommand{\mbf}[1]{{\boldmath\bfseries #1}}
\setfootins{0.5cm}{0.5cm}
\renewcommand*{\thefootnote}{\fnsymbol{footnote}}


% formatting -------------------------------------------------------------------
\usepackage{kpfonts}
\usepackage{dsfont}

% Define Document Variables
\newcommand{\subject}{Algebraic Number Theory}
\newcommand{\topic}{REPLACE}
\newcommand{\semester}{Winter 2019}

% Set equation numbering pattern
\numberwithin{equation}{section}

% Format Table of Contents
\renewcommand{\thechapter}{\Roman{chapter}}
\counterwithout{section}{chapter}
\counterwithin*{chapter}{part}
\renewcommand*{\cftchaptername}{Chapter } % Place 'Chapter' before roman
\setlength\cftchapternumwidth{4em} % Add space before chapter name
\cftpagenumbersoff{chapter} % Turn off page numbers for chapter

% Format Section / Subsection headers
\newcommand*{\shortcenter}[1]{%
    \sethangfrom{\noindent ##1}%
    \Large\boldmath\scshape\bfseries
    \centering
\parbox{5in}{\centering #1}\par}
\setsecheadstyle{\shortcenter}
\setsubsecheadstyle{\large\scshape\boldmath\bfseries\raggedright}

% Format Chapter Headers
\chapterstyle{verville}

% Format Page Headers / Footers
\setsecnumdepth{section}
\copypagestyle{myruled}{ruled} % Draw formatting from existing 'ruled' style
\makeoddhead{myruled}{}{}{\scshape\subject}
\makeevenfoot{myruled}{}{\thepage}{}
\makeoddfoot{myruled}{}{\thepage}{}
\pagestyle{myruled}

% Format Titlepage
\title{\subject}
\author{Alex Rutar\thanks{\itshape arutar@uwaterloo.ca}\\\textit{University of Waterloo}}
\date{\semester\thanks{Last updated: \today}}

\begin{document}
\pagenumbering{gobble}
\hypersetup{pageanchor=false}
\maketitle
\newpage
\frontmatter
\hypersetup{pageanchor=true}
\tableofcontents*
\newpage


% main document ----------------------------------------------------------------
\chapter*{Preface}
These are course notes for PMath 441/641 (algebraic number theory) at the University of Waterloo.
The notes are not original work: they are derived from lectures taught by Matthew Satriano during the Winter 2019 semester.
If you find mistakes in the document, you can send me an email at \textit{arutar@uwaterloo.ca} or raise an issue in the repository at \textit{https://github.com/alexrutar/UWaterloo-Course-Notes/}.
\mainmatter
\chapter{Field Theory in \texorpdfstring{$\C$}{C}}
\section{Fields over \texorpdfstring{$\Q$}{Q}}
\subsection{Algebraic Numbers}
\begin{definition}
    An \mbf{algebraic integer} is a root of a monic polynomial in $\Z[x]$.
    An \mbf{algebraic number} is the root of any non-zero polynomial in $\Z[x]$.
    A \mbf{number field} is a finite extension of $\Q$.
    If $K,L$ are fields and $K\subseteq L$, we say that $L$ is an \mbf{extension field} of $K$ and $K$ is a \mbf{subfield} of $L$.
    We write $[L:K]=\dim_KL$, the dimension of $L$ over $K$.
\end{definition}
\begin{example}
    Equivalently, algebraic numbers are the roots of polynomials in $\Q[x]$.
    $\sqrt{-5}$ is a root of $x^2+5\in\Z[x]$ is an algebraic integer, and $[\Q(\sqrt{-5}):\Q]=2$.
    A basis for $\Q(\sqrt{-5})$ over $\Q$ is given by $\{1,\sqrt{-5}\}$.
\end{example}
\begin{definition}
    If $K$ is a field, then $f\in K[x]$ is \mbf{irreducible} if whenever $f=gh$, $g,h\in K[x]$, then $g$ or $h$ is constant.
\end{definition}
\begin{proposition}
    Let $K\subseteq\C$ is a subfield and suppose $f\in K[x]$ is irreducible.
    Then, $f$ has distinct roots in $\C$.
\end{proposition}
\begin{proof}
    Suppose not and write $f(x)=a_n(x-\alpha)^2g(x)$ in $\C[x]$.
    Then $f'(x)=2a_n(x-\alpha)g(x)+a_n(x-\alpha)^2g(x)$, and $f'(\alpha)=0$.
    Let $p$ be the minimal polynomial of $\alpha$.
    Then $p|f$ so $p=f$ up to a constant.
    As well, $f=p|f'$, a contradiction.
\end{proof}
\subsection{Field Extensions}
\begin{definition}
    If $K\subseteq L$ are fields, then we write $L/K$ and say that $L$ is a \mbf{extension} of $K$.
    If $K\subseteq\C$ is a field $\theta\in\C$, then the field \mbf{$K$ adjoin $\theta$}, denoted $K(\theta)$, is defined to be the smallest subfield of $\C$ containing $K$ and $\theta$.
\end{definition}
\begin{example}
    Set $L:=\{a+b\sqrt{-5}:a,b\in\Q\}$; why is it that $\Q(\sqrt{-5})=L$?
    Certainly $L$ is a field: the inverse of $a+b\sqrt{-5}$ is given by $\frac{a-b\sqrt{-5}}{a^2+5b^2}$, which always since $a^2+5b^2$ is not zero whenever $\alpha\neq 0$.
    To see equality, let $M$ be any field containing $\Q$ and $\sqrt{-5}$.
    Then if $a,b$ are both rational, then $a\in M$ and $b\sqrt{-5}\in M$ so $a+b\sqrt{-5}\in M$.
    Thus $L$ is the smallest field containing $\Q$ and $\sqrt{-5}$.
\end{example}
\begin{example}
    Consider $\zeta=e^{2\pi i/3}$.
    Then one can verify that $\Q(\zeta)=\{a+b\zeta+c\zeta^2:a,b,c\in\Q\}$.
\end{example}
\begin{definition}
    Let $K\subseteq\C$ be a subfield.
    Then we say $\theta\in\C$ is \mbf{algebraic over $K$} if there exists a polynomial $f\in K[x]$ such that $f(\theta)=0$.
    We say $p\in K[x]$ is the \mbf{minimal polynomial} of $\theta$ if it is monic, has $\theta$ as a root, and if it has minimal degree.
    The \mbf{degree of $\theta$ over $K$} is $\deg p(x)$.
\end{definition}
\begin{example}
    $\sqrt{-5}$ has minimal polynomial $x^2+5$, and $\zeta$ has minimal polynomial $x^2+x+1$.
\end{example}
\begin{proposition}[Properties of the Minimal Polynomial]
    Let $K\subseteq\C$ be a subfield, $\theta\in\C$ algebraic over $K$.
    Then there exists a unique minimal polynomial $p(x)$ of $\theta$ over $K$.
    In particular, the following hold:
    \begin{enumerate}[nolistsep]
        \item If $f(\theta)=0$, $p|f$.
        \item $p$ is irreducible in $K[x]$
    \end{enumerate}
\end{proposition}
\begin{proof}
    If $p,q\in K[x]$ are both minimal polynomials, then $r=p-q$ has lower degree and $r(\theta)=0$.
    If $r$ is non-zero, let it have leading coefficient $c$ so that $r(x)/c$ is monic.
    But then $\deg(r/c)<\deg p$ and $r(\theta)/c=0$, contradicting minimality of $p$.
    \begin{enumerate}[nolistsep]
        \item By the division algorithm, write $f=pq+r$.
            If $r\neq 0$, then $\deg r<\deg p$ and $r(\theta)=0$, a contradiction by the same reasoning above.
        \item If $p$ is reducible, write $p=fg$ where $f,g$ are not constant.
            Since $F[x]$ is a UFD, $0=p(\theta)=f(\theta)g(\theta)$ so $\theta$ is a root of $f$ or $g$, contradicting minimality.
    \end{enumerate}
    Thus the result holds.
\end{proof}
\begin{remark}
    Since $p$ is irreducible, $p$ has $n=\deg p$ distinct roots in $\C$.
\end{remark}
\begin{definition}
    Suppose $\theta$ has minimal polynomial $p(x)$.
    The roots $\theta_1,\ldots,\theta_n\in\C$ of $p$ are called the \mbf{conjugates} of $\theta$.
\end{definition}
\begin{proposition}
    Let $K\subseteq\C$, $\theta\in \C$ algebraic over $K$, and let $n=\deg p$ be the degree of the minimal polynomial.
    Then every element $\alpha\in K(\theta)$ has a unique representation in the form
    \begin{equation*}
        \alpha=a_0+a_1\theta+\cdots+a_{n-1}\theta^{n-1}
    \end{equation*}
    where $a_i\in K$.
\end{proposition}
\begin{proof}
    First note that
    \begin{equation*}
        K(\theta)=\left\{\frac{f(\theta)}{g(\theta)}: f,g\in K[x],g(\theta)\neq 0\right\}
    \end{equation*}
    Set $\alpha=f(\theta)/g(\theta)\in K(\theta)$.
    Let's first see that $p$ and $g$ are coprime.
    Suppose not; then there exists non-constant $h\in K[x]$ such that $h|p$ and $h|g$.
    Since $p$ is irreducible, $h=cp$ for some $c\in K^\times$.
    Then since $h|g$, $p|g$ as well and $g(\theta)=0$, a contradiction.

    Since $K[x]$ is a PID and $p,g$ are coprime, there exist polynomials $s,t\in K[x]$ so that $sp+tg=1$.
    Evaluating at $g$, we must have $t(\theta)g(\theta)=1$ and
    \begin{equation*}
        \alpha=\frac{f(\theta)}{g(\theta)}=f(\theta)t(\theta)
    \end{equation*}
    so $\alpha$ is a polynomial in $\theta$.
    By the division algorithm, $ft=pq+r$ where $\deg r\leq n-1$ and $\alpha=r(\theta)$ is a polynomial expression in $\theta$ with degree $n-1$.

    It remains to see uniqueness.
    Suppose $\alpha=r_1(\theta)=r_2(\theta)$ where $r_1,r_2\in K[x]$ and $\deg r_i<n$.
    If $r_1(x)-r_2(x)\neq 0$, then $\deg(r_1-r_2)<n$.
    But then $r_1-r_2$ has $\theta$ as a root and $\deg(r_1-r_2)<n$, contradicting minimality of $p$.
\end{proof}
\begin{remark}
    This says that $\{1,\theta,\ldots,\theta^{n-1}\}$ is a basis for $K(\theta)$ over $K$.
    In general, when $\theta$ is algebraic over $K$, $K(\theta)=K[\theta]$.
\end{remark}
\begin{corollary}
    Suppose $M/L/K$.
    Then $[M:K]=[M:L][L:K]$.
\end{corollary}
\begin{proof}
    Exercise.
\end{proof}
\section{Finite Extensions and Embeddings}
\begin{definition}
    An injective ring homomorphism $\phi:R\to S$ is called an \mbf{embedding}.
    We write $R\hto S$ is the inclusion map.
\end{definition}
\begin{theorem}\label{t:embed}
    Let $K\subseteq\C$ is a subfield, $L/K$ is a finite extension field.
    If $\sigma:K\hto \C$ is an embedding, then $\sigma$ extends to an embedding $L\hto \C$ in exactly $[L:K]$ ways.
\end{theorem}
\begin{proof}
    First, let's prove the theorem for extensions of the form $K(\alpha)/K$.
    Let $p(x)=a_0+\cdots+a_mx^m\in K[x]$ be the minimal polynomial of $\alpha$ over $K$.
    Since $\sigma$ is injective, $K\cong\sigma(K)\subseteq\C$.
    Let $g(x)=\sigma(a_0)+\cdots+\sigma(a_{m-1})x^{m-1}+x^m$, which is irreducible over $\sigma(K)$.
    To see this, if $(c_0+c_1x+\cdots+c_u x^u)(d_0+d_1x+\cdots+d_vx^v)$ is any factorization (with $c_i,d_i\in\sigma(K)$), then $(\sigma^{-1}(c_0)+\sigma^{-1}(c_1)x+\cdots+x^u)(\sigma^{-1}(d_0)+\sigma^{-1}(d_1)x+\cdots+x^v)$ is a factorization of $p(x)$, so it must be trivial.
    Now, let $\beta_1,\ldots,\beta_m\in\C$ be the distinct roots of $g(x)$, and let $\beta:=\beta_i$ be arbitrary.
    Given an element $\gamma=b_0+b_1\alpha+b_2\alpha^2+\cdots+b_{m-1}\alpha^{m-1}$ in $K(\alpha)$, let
    \begin{equation*}
        \lambda_\beta(\gamma)=\sigma(b_0)+\sigma(b_1)\beta+\cdots+\sigma(b_{m-1})\beta^{m-1}
    \end{equation*}
    One can verify that this is a ring homomorphism which respects $\sigma$.
    Furthermore, there no other embeddings $\lambda$ since $0=\lambda(0)=\lambda(p(\alpha))=g(\lambda(\alpha))$.
    Thus, $\lambda(\alpha)$ is a root of $g$, so $\lambda(\alpha)=\beta_i$ for some $i$.
    Since $\lambda$ is a homomorphism, if $\lambda_1(\alpha)=\lambda_2(\alpha)$, then $\lambda_1=\lambda_2$, so there are at most $[K(\alpha):K]$ embeddings.

    Now, the proof follows by induction.
    If $[L:K]=1$, we are done; if $[L:K]>1$, get $\alpha\in L\setminus K$.
    From above, $\sigma$ extends to $[K(\alpha):K]$ embeddings $\lambda:K(\alpha)\to\C$, and by induction, any such embedding extends to $[L:K(\alpha)]$ embeddings $\lambda:L\to\C$.
    Thus there are $[L:K(\alpha)][K(\alpha):K]=[L:K]$ embeddings extending $\sigma$, as desired.
\end{proof}
\begin{remark}
    Our most common use case will be when $\sigma$ is the identity map on $K$.
\end{remark}
\begin{example}
    Consider the embedding of $\Q\hto\C$.
    If $\Q(\sqrt{d})/\Q$, then the two embeddings are given by $\sqrt{d}\mapsto\sqrt{d}$ or $\sqrt{d}\mapsto-\sqrt{d}$.
    Note that $\pm\sqrt{d}$ are conjugates: both are roots of the minimal polynomial $x^2-d$.
\end{example}
\begin{example}
    Suppose $K=\Q$, and $L=\Q(\sqrt[3]{2})$.
    Since $x^3-2$ is the minimal polynoial of $\sqrt[3]{2}$, its conjugates are $\sqrt[3]{2},\sqrt[3]{2}\omega,\sqrt[3]{2}\omega^2$ where $\omega=e^{2\pi i/3}$.
    All embedings extend $\Q\subseteq\C$ are given by $\sqrt[3]{2}\mapsto\sqrt[3]{2}\omega^k$ for $k=0,1,2$.
\end{example}
\begin{theorem}[Primitive Element]
    Let $K\subseteq L\subseteq\C$ with $[L:K]<\infty$.
    Then there $\theta\in L$ such that $L=K(\theta)$.
\end{theorem}
\begin{proof}
    Since $[L:K]<\infty$, we have $L=K(\alpha_1,\alpha_2,\ldots,\alpha_m)$ for some $m$.
    By induction on $m$, it suffices to handle the case $L=K(\alpha,\beta)$.

    Let $\{\alpha_1,\ldots,\alpha_n\}$ be the conjugates of $\alpha$ and $\{\beta_1,\ldots,\beta_m\}$ are conjugates of $\beta$ (over $K$).
    Let $c\in K^\times$ be such that $\alpha+c\beta\neq\alpha_i+c\beta_j$ for any $(i,j)\neq(1,1)$ ($K$ is an infinite field, so such a $c$ certainly exists), and set $\theta:=\alpha+c\beta$.
    Certainly $K(\theta)\subseteq K(\alpha,\beta)$; for the reverse inclusion, it suffices to show that $\beta\in K(\theta)$.
    Let $f(x)$ be the minimal polynomial of $\alpha$ over $K$, and $g(x)$ the minimal polynomial of $\beta$ over $K$.
    Note that $\beta$ is a root of both $f(\theta-cx)$ and $g(x)$; and by choice of $c$, there are no others in common.

    Let $h(x)$ be the minimal polynomial of $\beta$ over $K(\theta)$.
    Since $\beta$ is a root of both $f(\theta-cx)$ and $g(x)\in K[x]\subseteq K(\theta)[x]$, we must have $h|f(\theta-cx)$ and $h|g(x)$, so $\deg h=1$ and $\beta\in K(\theta)$.
\end{proof}
\subsection{Normal Extensions}
\begin{definition}
    Let $K\subseteq L\subseteq\C$, $[L:K]<\infty$.
    We say $L$ is a \mbf{normal extension} of $K$ if it is closed under taking conjugates over $K$.
\end{definition}
\begin{example}
    For example, $\Q(\sqrt{d})/\Q$ is a normal extension.
    If $\alpha\in L$, then $\alpha=a+b\sqrt{d}$.
    The conjugate of $\alpha$ is $a-b\sqrt{d}$, which is also an element of $L$.
    On the other hand, a classic non-example is $L=\Q(\sqrt[3]{2})/\Q$.
    Then $\sqrt[3]{2}\in L$ but $\omega\sqrt[3]{2}\notin L$, since $\omega\sqrt[3]{2}\notin\R$.
\end{example}
\begin{proposition}
    Let $K\subseteq L\subseteq\C$, $[L:K]<\infty$.
    Then $L/K$ is normal if and only if for all $\sigma:L\hto\C$ such that $\sigma|_K=\id_K$, $\sigma$ is an automorphism of $L$.
\end{proposition}
\begin{proof}
    Note that $\sigma$ is an automorphism of $L$ if and only if $\sigma(L)=L$.

    If $L/K$ is normal, let $\alpha\in L$ be such that $L=K(\alpha)$.
    Then $\sigma:L\hto\C$ is specified fully by $\sigma(\alpha)=\alpha_i$, where $\alpha_i$ is a conjugate of $\alpha$.
    But then $\sigma:K(\alpha)\to K(\alpha_i)$ is an isomorphism, and since $L/K$ is normal, $K(\alpha)=K(\alpha_i)$ and $\sigma$ is an automorphism of $L$.

    Conversely, let's show that $L/K$ is normal.
    Let $\alpha\in L$, let $\alpha_i$ be the conjugates of $\alpha$ over $K$: we need to show that $\alpha_i\in L$.
    Let $\sigma(\alpha)=\alpha_i$ extend $\id_K$, and by hypothesis, $\sigma$ is an automorphism so $\alpha_i\in K(\alpha)=L$.
\end{proof}
\begin{remark}
    Recall that there are $[L:K]$ embeddings that fix $K$; in other words, $\sigma:L\hto\C$ such that $\sigma|_K=\id_K$.
    The corollary says that $L/K$ is normal if and only if all of these embeddings are automorphisms.
    Thus $L/K$ is normal if and only if exactly $[L:K]$ automorphisms of $L$ fixing $K$.
\end{remark}
\begin{corollary}
    Let $K\subseteq\C$, $\alpha_i\in\C$ algebraic over $K$.
    Then $L=K(\alpha_1,\ldots,\alpha_n)$ is normal over $K$ if all the conjugates of $\alpha_i$ are in $L$.
\end{corollary}
\begin{proof}
    Let $\sigma:L\hto\C$ be an embedding extending $\id_K$.
    If $\theta\in L$, then $\theta=f(\alpha_1,\ldots,\alpha_n)$ for $f(x)\in K[x_1,x_2,\ldots,x_n]$.
    Then $\sigma(\theta)=f(\sigma(\alpha_1),\ldots,\sigma(\alpha_n))$ where $\sigma(\alpha_i)$ is some conjugate of $\alpha_i$, an element of $L$ by hypothesis.
    Thus $\sigma(\theta)\in L$ so $\theta\in L$ as well.
\end{proof}
\begin{corollary}
    $K\subseteq L\subseteq\C$, $[L:K]<\infty$.
    Then there exists a finite extension $M/L$ such that $M/K$ is normal.
\end{corollary}
\begin{proof}
    Get $\alpha\in L$ so that $L=K(\alpha)$.
    Let $\alpha_1,\ldots,\alpha_n$ be the conjugates of $\alpha$ over $K$.
    Set $M=K(\alpha_1,\ldots,\alpha_n)$, and by the previous corollary, $M/K$ is normal.
\end{proof}
\begin{example}
    Let $L=\Q(\sqrt[3]{2})$, $K=\Q$.
    $L/K$ is not normal, but $M=\Q(\sqrt[3]{2},\sqrt[3]{2}\omega,\sqrt[3]{2}\omega^2)/\Q$ is normal.
\end{example}
\section{Galois Theory over \texorpdfstring{$\Q$}{Q}}
\begin{definition}
    Let $L/K$ be any finite extension.
    The \mbf{Galois group} of $L/K$ is defined
    \begin{equation*}
        \Gal(L/K)=\bigl\{\sigma\in\Aut(L)\,\bigm|\,\sigma|_K=\id_K\bigr\}
    \end{equation*}
    Now if $H\leq\Gal(L/K)$, $L^H=\{\alpha\in L:\sigma(\alpha)=\alpha\forall\sigma\in H\}$ is called the \mbf{fixed field of $H$}.
\end{definition}
\begin{remark}
    Recall that $|\Gal(L/K)|\leq[L:K]$, with equality if and only if $L/K$ is normal.
    As well, one can verify that $L^H$ is indeed a field, so $L/L^H$ is an extension.
    In particular, this extension has certain properties:
\end{remark}
\begin{theorem}\label{t:galfix}
    Given $K\subseteq L\subseteq\C$, $L/K$ a finite normal extension.
    Let $G=\Gal(L/K)$.
    Then
    \begin{itemize}[nolistsep]
        \item $L^G=K$
        \item If $H\leq G$ and $L^H=K$, then $H=G$
    \end{itemize}
\end{theorem}
\begin{proof}
    We first see that $K=L^G$.
    Let $\sigma:L\hto\C$ be an embedding fixing $K$.
    Since $L$ is normal, $\sigma\in\Gal(L/K)$, so by definition of $L^G$, $\sigma$ fixes $L^G$.
    But then $[L:L^G][L^G:K]\leq[L:L^G]$, so $[L^G:K]\leq 1$ and $L^G=K$.

    Suppose now that $L^H=K$.
    Set $L=K(\alpha)$ and consider the polynomial
    \begin{align*}
        f(x) &= \prod_{\sigma\in H}(x-\sigma(\alpha))= x^{|H|}-e_1x^{|H|-1}+\cdots+e_{|H|}(-1)^{|H|}
    \end{align*}
    where the $e_i$ are elementary symmetric functions in the $\sigma(\alpha)$.
    If $\tau\in H$, then
    \begin{align*}
        \tau(e_1)&=\sum\limits_{\sigma\in H}\tau\sigma(\alpha)= \sum\limits_{\sigma\in H}\sigma(\alpha)=e_1
    \end{align*}
    since $\tau\in H$ permutes the $\sigma(\alpha)$ and $e_1$ is a symmetric polynomial in $\sigma(\alpha)$.
    The same argument holds for any $e_i$, so $e_i\in L^H=K$ for all $i$; thus, $f(x)\in K[x]$.
    Since $\id\in H$, $f(\alpha)=0$; and $\deg f=|H|$.
    Since the minimal polynomial of $\alpha$ over $K$ has degree $\leq|H|$,
    \begin{align*}
        [L:K] &= [K(\alpha):K]\leq|H|\leq|G|=[L:K]
    \end{align*}
    so $H=G$.
\end{proof}
\begin{remark}
    Suppose $L/K$ is normal, and $L\supseteq F\supseteq K$ where $F$ is a field.
    Then $L/F$ is also normal since conjugates of $\alpha\in L$ over $F$ are a subset of conjugates of $\alpha$ over $K$.
\end{remark}
\begin{theorem}[Fundamental Theorem of Galois Theory]\label{t:ftgt}
    Let $K\subseteq L\subseteq\C$, $L/K$ normal, with $L/F/K$.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $L^{\Gal(L/F)}=F$
        \item If $H\leq G=\Gal(L/K)$, then $\Gal(L/L^H)=H$.
        \item $F/K$ is normal if and only if $\Gal(L/F)\trianglelefteq\Gal(L/K)$.
            In this case,
            \begin{equation*}
                \Gal(F/K)\cong\quot{\Gal(L/K)}{\Gal(L/F)}
            \end{equation*}
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}[label=(\roman*)]
        \item Since $L/K$ is normal, $L/F$ is normal and \cref{t:galfix} states that $F=L^{\Gal(L/F)}$.
        \item Let $H'=\Gal(L/L^H)$.
            By definition, $H$ fixes $L^H$, so $H\leq H'=\Gal(L/L^H)$.
            Since $L/L^H$ is normal and $H\leq\Gal(L/L^H)$ has $L^H$ as its fixed field, by the previous theorem, $H=\Gal(L/L^H)=H'$.
        \item Let $H=\Gal(L/F)$.
            If $\sigma\in\Gal(L/K)$, then $\sigma:F\longrightarrow\sigma(F)$ is an isomorphism and $\sigma\Gal(L/F)\sigma^{-1}=\Gal(L/\sigma(F))$.
            Thus,
            \begin{align*}
                \Gal(L/F)\trianglelefteq\Gal(L/K) &\Longleftrightarrow \Gal(L/\sigma(F))=\sigma\Gal(L/F)\sigma^{-1}=\Gal(L/F)\\
                                                  &\Longleftrightarrow \sigma(F)=F\text{ for all }\sigma\\
                                                  &\Longleftrightarrow F/K\text{ is normal}
            \end{align*}
            since a field is normal if and only if it is fixed by all its automorphisms.

            When this holds, we can compute $\Gal(F/K)$.
            Since $\sigma(F)=F$, we have a well-defined map $\Gal(L/K)\to\Gal(F/K)$ given by $\sigma\mapsto\sigma|_F$.
            The kernel is $\{\sigma\in\Gal(L/K):\sigma|_F=\id_F\}=\Gal(L/F)$.
            Then by first isomorphism theorem,
            \begin{equation*}
                \Gal(F/K)\cong\quot{\Gal(L/K)}{\Gal(L/F)}
            \end{equation*}
            as required.
    \end{enumerate}
\end{proof}
\chapter{The Ring of Algebraic Integers}
\section{Number Fields}
We now focus our attention on extensions, in particular finite extensions, of $\Q$ in $\C$.
A major example throughout this section are the cyclotomic extensions of $\Q$; many of the theorems we will prove will provide tools to better understand extensions $\Q(\zeta_n)/\Q$.
Recall that $\alpha$ is an algebraic integer if it has a minimal polynomial in $\Z[x]$.
\begin{definition}
    $K$ is a \mbf{number field} if $K$ is a finite extension of $\Q$.
    The set of \mbf{algebraic numbers} over $\Q$ is denoted $\ol{\Q}$.
    The set of \mbf{algebraic integers} is denoted $\mathcal{O}_{\ol{\Q}}$.
    We write $\mathcal{O}_K\subseteq K=\mathcal{O}_{\ol{\Q}}\cap K$ to denote the subset of \mbf{algebraic integers of $K$}.
\end{definition}
We can prove Gauss' Lemma under the observation that $\Z_p[x]$ is an integral domain.
\begin{lemma}[Gauss]\label{l:gauss}
    If $f,g\in\Z[x]$ are primitive (their coefficients have no non-trivial common factor), then $fg$ is also primitive.
\end{lemma}
\begin{proof}
    Suppose $f,g\in\Z[x]$ are primitive.
    If $fg$ is not primitive, then some prime $p$ divides all coefficients of $fg$.
    Consider modulo $p$, so $\ol{f}\ol{g}=0$.
    Then $\ol{f}=0$ or $\ol{g}=0$, so $p$ divides all coefficients of $f$ or $g$ and $f,g$ are not primitive.
\end{proof}
\begin{proposition}\label{p:min-int}
    Let $\alpha$ be an algebraic integer.
    Then the minimal polynomial of $\alpha$ over $\Q$ is in $\Z[x]$.
\end{proposition}
\begin{proof}
    Let $\alpha$ be an algebraic integer, so there exists $h\in\Z[x]$ monic such that $h(\alpha)=0$.
    Let $f\in\Q[x]$ be the minimal polynomial of $\alpha$ over $\Q$.
    Then $h=fg$ in $\Q[x]$.
    Since $h,f$ are monic, $g$ is also monic.
    Let $a,b\in\Z$ so that $af,bg\in\Z[x]$ and $af,bg$ are primitive polynomials.
    Then by Gauss's Lemma \cref{l:gauss}, $abh=(af)(bg)\in\Z[x]$ is primitive, so $ab=\pm1$, so $a,b=\pm1$ and $f,g\in\Z[x]$ to begin with.
\end{proof}
A simple observation following from this fact is that $\mathcal{O}_{\Q}=\Z$.
\begin{example}[Quadratic Extensions]
    Let $d$ be a squarefree integer.
    Then
    \begin{equation*}
        \mathcal{O}_{\Q(\sqrt{d})}=\begin{cases}
            \Z[d] &:d\equiv 2,3\pmod{4}\\
            \left\{\frac{a+b\sqrt{d}}{2}: a\equiv b\pmod{2}\right\} &:d\equiv 1\pmod{4}
        \end{cases}
    \end{equation*}
    Let $\alpha=r+s\sqrt{d}$, $r,s\in\Q$.
    If $s=0$, then $\alpha=r\in\Q$, so $\alpha\in\mathcal{O}_{\Q(\sqrt{d})}$.
    Now consider $s\neq 0$.
    The minimal polynomial of $\alpha$ over $\Q$ is
    \begin{align*}
        \left(x-(r+s\sqrt{d})\right)\left(x-(r-s\sqrt{d})\right) = x^2-2rx+(r^2-ds^2)
    \end{align*}
    By $\alpha\in\mathcal{O}_{\Q(\sqrt{d})}$ if and only if $2r\in\Z$, $r^2-ds^2\in\Z$.

    First, if $r\in\Z$, so $ds^2\in\Z$ and since $d$ is squarefree, $s\in\Z$.

    The other case is $r=\frac{a}{2}$, where $a$ is an odd integer.
    Then $ds^2=\text{integer}+a^2/4$, so $s=b/2$ where $b$ is an odd integer.
    Since $r^2-ds^2\in\Z$, we need $4\mid(a^2-db^2)$.
    Modulo 4, $a^2\equiv db^2$, and since $a,b$ are odd, $a^2=b^2\equiv 1\pmod{4}$ and $d\equiv 1\pmod{4}$.
\end{example}
\begin{remark}
    Notice in the preceding examples, we got
    \begin{align*}
        \mathcal{O}_{\Q}&=\Z&\mathcal{O}_{\Q(\sqrt{d})}&=\begin{cases}
            \Z[\sqrt{d}]\\\Z\left[\frac{1+\sqrt{d}}{2}\right]
        \end{cases}
    \end{align*}
    which are all rings!
\end{remark}
\begin{theorem}\label{t:alg-int}
    Let $\alpha\in\C$.
    Then the following are equivalent:
    \begin{enumerate}[nl,r]
        \item $\alpha$ is an algebraic integer
        \item $\Z[\alpha]$ is finitely generated as an additive group
        \item $\alpha$ is an element of some subring of $\C$ having finitely generated additive group.
        \item $\alpha A\subseteq A$ for some finitely generated additive subgroup $A\subseteq\C$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \imp{i}{ii}
    We know $\Z[\alpha]=\{a_0+a_1\alpha+\cdots+a_{n-1}\alpha^{n-1}:a_i\in\Z\}$ where $n$ is the degree of $\alpha$ over $\Q$.
    Then it is generated over $\Z$ by $\{1,\alpha,\alpha^2,\ldots,\alpha^{n-1}\}$.

    \imp{ii}{iii}
    $\alpha\in\Z[\alpha]$ and $\Z[\alpha]$ is a subring of $\C$ with finitely generated additive group.

    \imp{iii}{iv}
    Let $A\subseteq\C$ denote the subring with $\alpha\in A$; then $\alpha A\subseteq A$.

    \imp{iv}{i}
    Let $\{a_1,\ldots,a_n\}$ generate $A$ as an additive group with $\alpha A\subseteq A$.
    In particular, $\alpha a_i\in A$, so there exists $\{m_{ij}:j=1,\ldots,n\}\subset\Z$ such that $\alpha a_i=\sum_{j=1}^n m_{ij}a_j$.
    Let $M=(m_{ij})$ in $\Z$, so that
    \begin{equation*}
        (\alpha I_n-M)\begin{bmatrix}a_1\\\vdots\\a_n\end{bmatrix}=0
    \end{equation*}
    Thus, $\alpha$ is a root of $\det(xI_n-M)\in\Z[x]$.
\end{proof}
\begin{remark}
    The proof of \iimp{iv}{i} gives a general method for computing polynomials which have a specific algebraic integer as a root.
\end{remark}
\begin{corollary}
    $\mathcal{O}_{\ol{\Q}}$ is a ring.
    In particular, $\mathcal{O}_K$ is a ring for any number field $K$.
\end{corollary}
\begin{proof}
    Say $\alpha$ has degree $n$ and $\beta$ has degree $m$ over $\Q$.
    Then $\Z[\alpha,\beta]\subseteq\C$ is a subring with a finitely generated additive group because it is generated by $\alpha^i\beta^j$ where $0\leq i<n$, $0\leq j<m$.
    Since $\alpha\beta,\alpha+\beta\in\Z[\alpha,\beta]$ we are done by (iii) in \cref{t:alg-int}.
    Finally, $\mathcal{O}_K=K\cap\mathcal{O}_{\ol{\Q}}$ is an intersection of rings and thus also a ring.
\end{proof}
\begin{proposition}
    Let $\alpha$ be an algebraic number.
    Then there exists $r\in\Z^+$ such that $r\alpha$ is an algebraic integer.
\end{proposition}
This essentially says that if $\alpha\in K$ and $K$ is a number field, then there exists $r\in\Z^+$ such that $r\alpha\in\mathcal{O}_K$.
\begin{proof}
    Since $\alpha$ is an algebraic number, $\alpha$ satisfies a polynomial in $\Q[x]$.
    Clear denominators to get $h\in\Z[x]$ so $h(\alpha)=0$.
    Write $h(x)=a_nx^n+a_{n-1}x^{n-1}+\cdots+a_0$.
    Then
    \begin{align*}
        a_n^{n-1}h(x)&=a_n^nx^n+a_n^{n-1}a_{n-1}x^{n-1}+\cdots+a_n^{n-1}a_0\\
                     &= (a_nx)^n+a_{n-1}(a_nx)^{n-1}+\cdots+a_n^{n-1}a_0
    \end{align*}
    Let $g(x)=x^n+a_{n-1}x^{n-1}+\cdots+a_n^{n-1}a_0$, so $g(a_n\alpha)=0$ and $a_n\alpha$ is an algebraic integer.
    If $a_n$ is negative, take $-a_n\alpha$ instead.
\end{proof}
\subsection{Cyclotomic Extensions I: Introduction}
\begin{definition}
    We say $\zeta_n$ is a \mbf{primitive $n$\textsuperscript{th} root of unity} if $\zeta_n^n=1$ and $\zeta_n^k\neq 1$ for any $k<n$.
    We call the extension $\Q(\zeta_n)$ a \mbf{cyclotomic field}.
\end{definition}
\begin{example}
    The $4^\text{th}$ roots of unity are $1,i,-1,-i$, so $i$ and $-i$ are the primitive $4^\text{th}$ roots of unity.
\end{example}
The cyclotomic fields play a fundamental role in number theory.
For example, in class field theory, we have the following theorem:
\begin{theorem}[Kronecker-Weber]
    If $K/\Q$ is a finite normal extension and $\Gal(K/\Q)$ is abelian, then $K\subseteq\Q(\zeta_n)$ for some $n$.
\end{theorem}
We will not prove this theorem in full generality, but we will see partial results on assignments.
\begin{theorem}
    $\zeta_n$ is an algebraic integer with minimal polynomial
    \begin{equation*}
        \Phi_n(x):=\prod_{j\in(\Z_n)^\times}(x-\zeta_n^j)
    \end{equation*}
\end{theorem}
\begin{proof}
    Note that $\zeta_n$ is a root of $x^n-1$, so $\zeta_n$ is an algebraic integer.
    As in \cref{p:min-int}, let $f(x)\in\Z[x]$ be the minimal polynomial of $\zeta_n$ over $\Q$ so that $f(x)\div(x^n-1)$ over $\Z[x]$.
    Recall that
    \begin{equation*}
        x^n-1=\prod\limits_{j\in\Z_n}(x-\zeta_n^j)
    \end{equation*}
    If $j\notin(\Z_n)^\times$, then $\zeta_n^j$ satisfies $x^{\frac{n}{\gcd(n,j)}}-1$ but $\zeta_n$ does not, so $\zeta$ and $\zeta_n^j$ are not conjugates.
    Thus the only possible conjugates for $\zeta_n$ are the $\zeta_n^j$ where $j\in(\Z_n)^\times$; it suffices to show that these are precisely the conjugates.
    In particular, let's show that if $\theta=\zeta_n^t$ and $p$ is prime with $p\nmid n$, then $\theta^p$ is conjugate to $\theta$.
    With this, the result follows: if $j$ is coprime to $n$, write $j=p_1^{e_1}\cdots p_m^{e_m}$ with $p_i\nmid n$ and repeatedly apply the above result to $\zeta_n$ for each $p_i$, $e_i$ times.

    Thus let's prove the claim.
    Write $x^n-1=f(x)g(x)$ with $f,g\in\Z[x]$; since $\theta^p$ is a root of $x^n-1$, either it is a root of $f(x)$ - in which case we're done - or it is a root of $g(x)$.
    Suppose $g(\theta^p)=0$, so $\theta$ is a root of $g(x^p)\in\Z[x]$ so $f(x)\div g(x^p)$ over $\Z[x]$.
    Modulo $p$, $\ol{f}(x)\div\ol{g}(x^p)=\ol{g}(x)^p$ in $\Z_p[x]$.
    Since $\Z_p[x]$ is a UFD, let $s(x)$ be an irreducible factor of $f(x)$ so that $s|\ol{f}$ and thus $s|\ol{g}$.
    But then $x^{n}-\ol{1}=\ol{f}\ol{g}$, so $s^2\div(x^n-1)$ and $s\div\ol{n}x^{n-1}$.
    Since $n$ is coprime to $p$, this implies $s=cx$ for some $c\in\Z_p$.
    But then $cx\div x^n-\ol{1}$, a contradiction.
\end{proof}
\begin{remark}
    \begin{enumerate}[nl]
        \item For $p$ prime, we have
            \begin{align*}
                \Phi_p(x) &= \prod\limits_{j=1}^{p-1}(x-\zeta_p^j)= \frac{x^p-1}{x-1}= x^{p-1}+x^{p-2}+\cdots+1
            \end{align*}
        \item $\Q(\zeta_n)/\Q$ is a normal extension since conjugates of $\zeta_n$ are $\zeta_n^j\in\Q(\zeta_n)$.
            As well, $[Q(\zeta_n):\Q]=|(\Z_n)^\times|=\phi(n)$.
    \end{enumerate}
\end{remark}
\begin{proposition}
    $\Gal(\Q(\zeta_n)/\Q)\cong(\Z_n)^\times$.
\end{proposition}
\begin{proof}
    Set $G=\Gal(\Q(\zeta_n)/\Q)$, which consists of automorphisms $\sigma:\Q(\zeta_n)\to\Q(\zeta_n)$ fixing $\Q$.
    For such a $\sigma$, we must have $\sigma(\zeta_n)=\zeta_n^j$ for some $\gcd(j,n)=1$.
    Thus to every $\sigma\in G$, we can associate the index $j\in(Z_n)^\times$ so that $\sigma_j(\zeta_n)=\zeta_n^j$.
    This gives us a map $G\to(\Z_n)^\times$ by $\sigma_j\mapsto j$.
    This map is a homomorphism:
    \begin{equation*}
        \sigma_k\sigma_j(\zeta_n)=\sigma_k(\zeta_n^j)=\sigma_k(\zeta_n)^j=\zeta_n^{jk}=\sigma_{jk}(\zeta_n)
    \end{equation*}
    and bijectivity is left as a straightforward exercise.
\end{proof}
\section{Traces, Norms, and Units}
\begin{definition}
    Suppose $K$ is a number field with $[K:\Q]=n$, and let $\sigma_1,\ldots,\sigma_n:K\hto\C$ be the usual embeddings extending $\Q\subseteq\C$.
    Given $\alpha\in K$, we say its \mbf{trace} is
    \begin{equation*}
        \Tr_{\Q}^K=Tr_{\Q}^K(\alpha)=\sum\limits_{i=1}^n\sigma_i(\alpha)
    \end{equation*}
    and its \mbf{norm}
    \begin{equation*}
        N_{\Q}^K(\alpha)=\prod\limits_{i=1}^n\sigma_i(\alpha)
    \end{equation*}
\end{definition}
\begin{proposition}
    Let $r\in\Q$, $\alpha,\beta\in K$ as above.
    Then
    \begin{enumerate}[nl,r]
        \item $\Tr_{\Q}^K(r\alpha)=r\Tr_{\Q}^k(\alpha)$
        \item $\Tr_{\Q}^K(\alpha+\beta)=\Tr_{\Q}^K(\alpha)+\Tr_{\Q}^K(\beta)$
        \item $N_{\Q}^K(\alpha\beta)=N_{\Q}^K(\alpha)N_{\Q}^K(\beta)$
        \item $N_{\Q}^K(r\alpha)=r^nN_{\Q}^K(\alpha)$
    \end{enumerate}
\end{proposition}
\begin{proof}
    Exercise.
\end{proof}
\begin{example}
    Consider $\sqrt{2}\in\Q(\sqrt{2},\sqrt{3})=K$.
    The minimal polynomial of $\sqrt{2}$ is $x^2-2$.
    The 4 embeddings $K\hto\C$ are given by $\sqrt{2},\sqrt{3}\mapsto\pm\sqrt{2},\pm\sqrt{3}$, so $N_{\Q}^K(\sqrt{2})=\sqrt{2}\sqrt{2}(-\sqrt{2})(-\sqrt{2})=4$.
\end{example}
\begin{theorem}\label{t:relntr}
    If $[K:\Q]=n$, $\alpha\in K$, then
    \begin{equation*}
        \frac{1}{[K:\Q]}\Tr_{\Q}^K(\alpha)=\frac{1}{[\Q(\alpha):\Q]}\Tr_{\Q}^{\Q(\alpha)}(\alpha)
    \end{equation*}
    and
    \begin{equation*}
        N_{\Q}^K(\alpha)^{\frac{1}{[K:\Q]}}=N_{\Q}^{\Q(\alpha)}(\alpha)^{\frac{1}{[\Q(\alpha):\Q]}}
    \end{equation*}
\end{theorem}
\begin{proof}
    Each of the $[\Q(\alpha):\Q]$ embeddings $\Q\hto\Q(\alpha)$ extend to $[K:\Q(\alpha)]$ embeddings $\Q\hto K$.
    So, letting $\sigma_i$ be the embeddings $\Q(\alpha)\hto\C$, let $\sigma_{ij}$ be the $[K:\Q(\alpha)]$ extensions.
    Then
    \begin{align*}
        \Tr_{\Q}^K(\alpha) = \sum_{j=1}^{[K:\Q(\alpha)]}\sum_{i=1}^n\sigma_{ij}(\alpha)= \sum_{j=1}^{[K:\Q(\alpha)]}\left(\sum_{i=1}^n\sigma_{i}(\alpha)\right)=[K:\Q(\alpha)]\Tr_{\Q}^{\Q(\alpha)}\sigma_i(\alpha)
    \end{align*}
    and the proof is identical for $N_{\Q}^K(\alpha)$.
\end{proof}
\begin{remark}
    Given $\alpha$ an algberaic integer, the value $\Tr(\alpha)$ does not necessarily make sense since you need to choose the number field $K$ containing $\alpha$.
    However, the previous proposition \cref{t:relntr} says that this distinction is not too important: if we divide by $1/[K:\Q]$, the trace does not depend on $K$ containing $\alpha$.
\end{remark}
\begin{corollary}
    If $\alpha\in K$, $K$ is a number field, then $\Tr_{\Q}^K(\alpha)$, $N_{\Q}^K(\alpha)\in\Q$.
    In particular, if $\alpha\in\mathcal{O}_K$, then $\Tr_{\Q}^K(\alpha)$, $N_{\Q}^K(\alpha)\in\Z$.
\end{corollary}
\begin{proof}
    Let $\alpha$ have minimal polynomial $x^n+a_{n-1}x^{n-1}+\cdots+a_0$.
    Note that $\Tr_{\Q}^{\Q(\alpha)}$ is the $-a_{n-1}$ coefficient and $N_{\Q}^{\Q(\alpha)}$ is the $\pm a_0$ coefficient of the minimal polynomial.
    These are both rationals, and if $\alpha$ is an algebraic integer, then they are both integers.
    Then by \cref{t:relntr}, $\Tr_{\Q}^K$ and $\N_{\Q}^K$ are integer multples / powers, and are thus still rational or integer.
\end{proof}
Since $\mathcal{O}_K$ is a ring, it is natural to ask what the units are.
\begin{proposition}\label{p:unit}
    Let $K$ be a number field and $\alpha\in\mathcal{O}_K$.
    Then $\alpha\in\mathcal{O}_K^\times$ if and only if $N_{\Q}^K(\alpha)=\pm 1$.
\end{proposition}
\begin{proof}
    If $\alpha\in\mathcal{O}_K^\times$, then $\alpha\beta=1$ for some $\beta\in\mathcal{O}_K$.
    Then $1=N_{\Q}^K(1)=N_{\Q}^K(\alpha\beta)=N_{\Q}^K(\alpha)N_{\Q}^K(\beta)$ is a product of integers, so they must be $\pm 1$.

    Otherwise, suppose $\alpha\in\mathcal{O}_K$ and $N_{\Q}^K(\alpha)=1$, so that $N_{\Q}^{\Q(\alpha)}(\alpha)=\pm 1$.
    Then if $\sigma_i$ are the embeddings $\Q(\alpha)\hto\C$ fixing $\Q$, $\sigma_1=\id$,
    \begin{equation*}
        \pm 1 =\prod_{i=1}^n\sigma_i(\alpha)=\alpha\prod_{i=2}^n\sigma_i(\alpha)
    \end{equation*}
    Note that each $\sigma_i(\alpha)\in\mathcal{O}_{\ol{Q}}$, but since $\Q(\alpha)$ may not be normal, $\sigma_i(\alpha)$ may not be in $\Q(\alpha)$.
    However $\prod_{i=2}^n\sigma_i(\alpha)=\pm\alpha^{-1}\in\Q(\alpha)$ is an algebraic integeer and thus in $\mathcal{O}_K$, so $\alpha$ is a unit.
\end{proof}
\begin{example}
    In $K=\Q(i)$, $\mathcal{O}_K^\times=\Z[i]^\times$ and $N(a+bi)=a^2+b^2$.
    Thus the units are given by $\{\pm 1,\pm i\}$
    More generally, if $\zeta$ is a root of unity and $\zeta\in K$, then $\zeta\in\mathcal{O}_K^\times$.
    This follows since $N_{\Q}^{\Q(\zeta)}(\zeta)=1$ and we can apply \cref{t:relntr}.
\end{example}
\subsection{Units in Quadratic Extensions}
\begin{proposition}
    Let $d$ be a square-free negative integer.
    Then $\mathcal{O}_{\Q(\sqrt{d})}^\times=\{\pm 1\}$ unless
    \begin{itemize}[nolistsep]
        \item $d=-1$, in which case the units are $\{\pm 1$, $\pm i\}$.
        \item $d=-3$, in which case the units are $\left\{\pm 1,\frac{\pm 1\pm\sqrt{-3}}{2}\right\}$.
    \end{itemize}
\end{proposition}
\begin{proof}
    First suppose $\alpha\in\mathcal{O}_{\Q(\sqrt{d})}^\times$, where $d$ is square-free.
    If $d\nequiv 1\pmod{4}$, then $\alpha=a+b\sqrt{d}$, so $\alpha\in\Z[\sqrt{d}]^\times$ if and only if $N(\alpha)=a^2-db^2=\pm 1$.
    So $a+b\sqrt{d}$ is a unit if and only if $(a,b)$ is a solution to the diophantine equation $x^2-dy^2=\pm1$.
    Similarly, $\frac{a+b\sqrt{d}}{2}\in\mathcal{O}_{\Q(\sqrt{d})}$ for $d\equiv 1\pmod{4}$ is a unit if and only if $a^2-db^2=\pm 4$.
    Now suppose additionally that $d<1$.

    \case{$d\nequiv 1\pmod{4}$}
    If $d<-1$, then the only solution to $x^2-dy^2=\pm 1$ is $(\pm 1,0)$.
    If $d=-1$, then solutions to $x^2+y^2=\pm 1$ are $(\pm 1,0)$ and $(0,\pm 1)$.

    \case{$d\equiv 1\pmod{4}$}
    We want solutions to $x^2-dy^2=\pm 4$.
    If $d<-3$, then the only solutions are $(\pm 2,0)$, which correspond to $\{\pm 1\}\in\mathcal{O}_K$.
    If $d=-3$, then the solutions are $(\pm 1,0)$ and $(0,\pm 1)$.
\end{proof}
\begin{remark}
    When $d<0$, the graph of $x^2-dy^2=\{\pm 1,\pm 4\}$ is an ellipse so there are only a finite number of integer pair solutions.
    On the other hand, consider $d=2$, so the graph is a hyperbola with asymptotes $\pm\sqrt{2}$.
    If we want integer solutions, we want solutions $b/a$ that are close to $\sqrt{2}$, so we're looking for (good) rational approximations to $\sqrt{2}$.
    In a precise sense, one can define the ``best'' rational approximation to $\sqrt{2}$.
    One intuition about ``best'' is to bound the denominator and be close to $\sqrt{2}$.
    Given $\alpha$, its continued fraction approximation of $\alpha$ is
    \begin{equation*}
        \alpha=a_0+\frac{1}{a_1+\frac{1}{a_2+\cdots}}
    \end{equation*}
    The first few convergents to the continued fraction expansion of $\sqrt{2}$ are $1,3/2,7/5$.

    Consider $\epsilon=1+\sqrt{2}\in\Z[\sqrt{2}]^\times$, so $N(\epsilon)=-1$.
    As well, $\epsilon^n$ is also a unit for any $n$.
    For example, $\epsilon^2=3+2\sqrt{2}$, $\epsilon^3=7+5\sqrt{2}$.
    It turns out that $\epsilon^n=p_n+q_n\sqrt{2}$, where $p_n/q_n$ is the $n^\text{th}$ convergent of the continued fraction expansion of $\sqrt{2}$.
\end{remark}
\begin{theorem}[Dirichlet Approximation]\label{t:dir-approx}
    Let $\alpha\in\R\setminus\Q$, let $Q>1$, $Q\in\Z$.
    Then there exists $p,q\in\Z$ such that $1\leq q\leq Q$ and $|q\alpha-p|<\frac{1}{Q}$.
    In particular, there are infinitely many pairs $(p,q)\in\Z^2$ for which $|\alpha-p/q|<1/q^2$.
\end{theorem}
\begin{proof}
    The ``in particular'' statement follows from the first statement because $|\alpha-p/q|<\frac{1}{Qq}\leq\frac{1}{q^2}$.
    Since $Q$ can be chosen arbitrarily, there are infinitely many such solutions.

    Let's now prove the main statement.
    For any $x\in\R$, let $\{x\}=x-\lfloor x\rfloor$ denote the integer part of $x$.
    Consider the $Q$ intervals
    \begin{equation*}
        \left\{\left(0,\frac{1}{Q}\right),\left(\frac{1}{Q},\frac{2}{Q}\right),\ldots,\left(\frac{Q-1}{Q},1\right)\right\}
    \end{equation*}
    and consider the $Q+1$ numbers $\left\{\{\alpha\},\{2\alpha\},\ldots,\{(Q+1)\alpha\}\right\}$.
    Since $\alpha$ is irrational, each of these numbers lies in one of the above intervals.
    By the pidgeonhole principle, get $1\leq m<n\leq Q$ such that $|\{n\alpha\}-\{m\alpha\}|<1/Q$ so that
    \begin{equation*}
        \bigl\lvert n\alpha-\lfloor n\alpha\rfloor-m\alpha+\lfloor m\alpha\rfloor\bigr\rvert=\bigl\lvert(n-m)\alpha-(\lfloor n\alpha\rfloor-\lfloor m\alpha\rfloor)\bigr\rvert<\frac{1}{Q}
    \end{equation*}
    Take $q=n-m$, $p=\lfloor n\alpha\rfloor-\lfloor m\alpha\rfloor$, and we are done.
\end{proof}
\begin{theorem}[Dirichlet Unit, Quadratic Extensions]\label{t:dir-unit-q}
    If $d>1$ be squarefree and set $K=\Q(\sqrt{d})$.
    Then, there exists a smallest unit $\epsilon>1$ such that
    \begin{equation*}
        \mathcal{O}_K^\times=\{\pm\epsilon^n:n\in\Z\}\cong \Z_2\times\Z
    \end{equation*}
\end{theorem}
\begin{proof}
    We treat the case where $d\nequiv 1\pmod{4}$; the proof when $d\equiv 1\pmod{4}$ follows identically.

    Let $\theta=p+q\sqrt{d}$, $p,q\in\Z$, $q>0$.
    Then,
    \begin{align*}
        |N(\theta)| &= |p+q\sqrt{d}||p-q\sqrt{d}| = \left\lvert\frac{p}{q}+\sqrt{d}\right\rvert\left\lvert\frac{p}{q}-\sqrt{d}\right\rvert q^2
    \end{align*}
    By Dirichlet approximation \cref{t:dir-approx}, there are infinitely many pairs $(p,q)\in\Z^2$ such that $|p/q-\sqrt{d}|<1/q^2$.
    For such $(p,q)$, $\left\lvert\frac{p}{q}+\sqrt{d}\right\rvert<2\sqrt{d}+1$.
    Since $2\sqrt{d}+1$ is independent of the value of $(p,q)$, by the pidgeonhole principle, there exists $m\in\Z^+$ such that there are infinintely many $\theta=p+q\sqrt{d}$ with $|N(\theta)|=m$.
    Enumerate these by $\theta_i=p_i+q_i\sqrt{d}$ for $i\in\N$.

    Let's show that $\mathcal{O}_K^\times$ is an infinite set.
    We might take $\theta_i/\theta_1$ for infinitely many $\theta_i$ (which certainly has norm 1), but $\theta_i/\theta_1$ might not be an algebraic integer.
    We can, however, amend this as follows.
    By the pidgeonhole principle, there exists some $\theta_0:=\theta_j$ such there are infinitely many $\theta_i$ with $p_i\equiv p_0\pmod{m}$ and $q_i\equiv q_0\pmod{m}$.
    Let $\theta_0'$ be the conjugate of $\theta_0$, so that
    \begin{align*}
        \frac{\theta_i}{\theta_0} &= 1+\frac{\theta_i-\theta_0}{\theta_0}= 1+\frac{\theta_i-\theta_0}{\theta_0\theta_0'}\theta_0'\\
                                  &= 1+\frac{(p_i-p_0)+(q_i-q_0)\sqrt{d}}{m}\theta_0'\in\mathcal{O}_K
    \end{align*}
    Thus, we have infinitely many $\beta\in\mathcal{O}_K^\times$.

    Now, let $S=\{\gamma\in\mathcal{O}_K^\times:\gamma>0\}$, so $|S|=\infty$; let's show that $S$ has a minimal element.
    Assuming this, let $\epsilon\in S$ be minimal and set $\lambda\in\mathcal{O}_K^\times$: taking $-\lambda$ if necessary, we may assume $\lambda>0$.
    Then there exists $n\in\Z$ so that $\epsilon^n\leq\lambda<\epsilon^{n+1}$.
    Then $1\leq\lambda\epsilon^n<\epsilon$, and since $\epsilon>1$ is minimal, we must have $\lambda/\epsilon^n=1$; i.e. $\lambda=\epsilon^n$.

    Note the following: if $1<\gamma=x+y\sqrt{d}$ is a unit, then $x,y\geq 1$.
    To see this, consider the four values $\gamma,-\gamma,\gamma^{-1},-\gamma^{-1}$, which are $\frac{\pm x\pm y\sqrt{d}}{2}$.
    Since $x$ and $x^{-1}$ cannot both be greater than 1, exactly one of the four values are greater than 1, so it must be the largest one; i.e. the one with $x,y\geq 1$.
    But now let $\gamma>1$ be arbitrary; by positivity, there are only finitely many $\gamma_0<\gamma$, so there must be some minimal element.
\end{proof}
\begin{remark}
    A natural question is to ask this question for a general number field.
    For example, if $K$ is cubic, then $\mathcal{O}_K^\times$ may or may not have a smallest unit $\epsilon>1$; see \cref{t:dir-unit} for the general case.
\end{remark}
\section{Discriminants and Integral Bases}
\begin{definition}
    Let $K$ be a number field, and let $\sigma_1,\ldots,\sigma_n:K\hto\C$ be embeddings extending $\Q\subseteq\C$.
    Given $\alpha_1,\ldots,\alpha_n\in K$, we define the \mbf{discriminant of $\alpha_1,\ldots,\alpha_n$} to be
    \begin{equation*}
        \disc(\alpha_1,\ldots,\alpha_n)=\det
        \begin{pmatrix}
            \sigma_1(\alpha_1) & \hdots & \sigma_1(\alpha_n)\\
            \vdots &\ddots&\vdots\\
            \sigma_n(\alpha_1) & \hdots & \sigma_n(\alpha_n)
        \end{pmatrix}^2
    \end{equation*}
    If $K=\Q(\alpha)$, for notational simplicity, we say $\disc(\alpha)=\disc(1,\alpha,\ldots,\alpha^{n-1})$.
\end{definition}
\begin{remark}
    The value of $\disc(\alpha_1,\ldots,\alpha_n)$ is independent of the ordering of the $\alpha_i$: swapping rows or columns only changes sign in the determinant.
\end{remark}
\begin{example}
    If $K=\Q(\sqrt{d})$, then
    \begin{equation*}\disc(1,\sqrt{d})=\det\begin{pmatrix}1&1\\\sqrt{d}&-\sqrt{d}\end{pmatrix}^2=4d\end{equation*}
\end{example}
\begin{proposition}
    Let $K$ be a number field of degree $n$.
    Then
    \begin{equation*}
        \disc(\alpha_1,\ldots,\alpha_n)=\det
        \begin{pmatrix}
            \Tr_{\Q}^K(\alpha_1\alpha_1)&\hdots&\Tr_{\Q}^K(\alpha_1\alpha_n)\\
            \vdots&\ddots&\vdots\\
            \Tr_{\Q}^K(\alpha_n\alpha_1)&\hdots&\Tr_{\Q}^K(\alpha_n\alpha_n)
        \end{pmatrix}
    \end{equation*}
\end{proposition}
\begin{proof}
    Let $M=(\sigma_i(\alpha_j))_{ij}$.
    Then
    \begin{align*}
        \disc(\alpha_1,\ldots,\alpha_n) &= \det(M)^2 = \det(M^tM)
    \end{align*}
    where
    \begin{align*}
        \left(M^tM\right)_{ij} =\sum_{k=1}^n M_{ik}M_{jk}=\sum_{k=1}^n\sigma_k(\alpha_i)\sigma_k(\alpha_j)=\sum_{k=1}^n\sigma_k(\alpha_i\alpha_j)=\Tr(\alpha_i\alpha_j)
    \end{align*}
\end{proof}
\begin{example}
    Again, take $K=\Q(\sqrt{d})$.
    Then
    \begin{equation*}
        \disc(1,\sqrt{d})=\det\begin{pmatrix}\Tr(1)&\Tr(\sqrt{d})\\\Tr(\sqrt{d})&\Tr(d)\end{pmatrix}=\det\begin{pmatrix}2&0\\0&2d\end{pmatrix}=4d
    \end{equation*}
    which is the same as the previous example.
\end{example}
\begin{corollary}
    We have $\disc(\alpha_1,\ldots,\alpha_n)\in\Q$, and if $\alpha_i\in\mathcal{O}_K$, then $\disc(\alpha_1,\ldots,\alpha_n)\in\Z$.
\end{corollary}
\begin{proof}
    $\Tr(\alpha_i\alpha_j)\in\Q$ and if the $\alpha_i\in\mathcal{O}_K$, then $\Tr(\alpha_i\alpha_j)\in\Z$.
\end{proof}
\subsection{Change of Basis}
Let's now understand how discriminants change under change of basis.
Suppose $\alpha_1,\ldots,\alpha_n$ is a basis for $K/\Q$, and let $\beta_1,\ldots,\beta_n\in K$ are arbitrary (possibly not a basis).
Since $\sigma_i(\beta_k)\in K$, there exists $c_{kj}$ such that $\sigma_i(\beta_k)=\sum_{j=1}^n c_{kj}\sigma_i(\alpha_j)$.
Then
\begin{align*}
    \begin{pmatrix}
        \sigma_1(\beta_1) &\cdots&\sigma_n(\beta_1)\\
        \vdots&&\vdots\\
        \sigma_1(\beta_n)&\cdots&\sigma_n(\beta_n)
    \end{pmatrix}
    =
    \begin{pmatrix}
        c_{11} &\cdots&c_{1n}\\
        \vdots&&\vdots\\
        c_{n1}&\cdots&c_{nn}
    \end{pmatrix}
    \begin{pmatrix}
        \sigma_1(\alpha_1) &\cdots&\sigma_n(\alpha_1)\\
        \vdots&&\vdots\\
        \sigma_1(\alpha_n)&\cdots&\sigma_n(\alpha_n)
    \end{pmatrix}
\end{align*}
Let $C=\left(c_{ij}\right)$ denote the above transition matrix; then,
\begin{equation*}
    \disc(\beta_1,\ldots,\beta_n)=\det(C)^2\disc(\alpha_1,\ldots,\alpha_n)
\end{equation*}
Now, if $K/\Q$ is a finite extension, then we know there exists $\theta\in K$ such that $K=\Q(\theta)$.
Thus, $\{1,\theta,\ldots,\theta^{n-1}\}$ is a basis for $K/\Q$.
In particular,
\begin{align*}
    \disc(1,\theta,\ldots,\theta^{n-1}) &= \det\begin{pmatrix}\sigma_1(1) &\sigma_1(\theta)&\cdots&\sigma_1(\theta^{n-1})\\\vdots&\vdots&&\vdots\\\sigma_n(1)&\sigma_n(\theta)&\cdots&\sigma_n(\theta^{n-1})\end{pmatrix}^2\\
                                        &=\det\begin{pmatrix}\sigma_1(1) &\sigma_1(\theta)&\cdots&\sigma_1(\theta)^{n-1}\\\vdots&\vdots&&\vdots\\\sigma_n(1)&\sigma_n(\theta)&\cdots&\sigma_n(\theta)^{n-1}\end{pmatrix}^2\\
                                        &= \prod_{i<j}(\sigma_i(\theta)-\sigma_j(\theta))^2
\end{align*}
since it is the square of the determinant of a Vandermonde matrix.
In particular, this value is non-zero since the $\sigma_i(\theta)$ are distinct.
Now the following proposition follows from this discussion:
\begin{proposition}
    Let $\alpha_1,\ldots,\alpha_n\in K$ where $n=[K:\Q]$.
    Then $\disc(\alpha_1,\ldots,\alpha_n)\neq 0$ if and only if $\alpha_1,\ldots,\alpha_n$ is a basis for $K/\Q$.
\end{proposition}
\begin{proof}
    Let $C$ denote the transition matrix for $\{\alpha_1,\ldots,\alpha_n\}$ in terms of the $(\theta^j)$.
    Then
    \begin{equation*}
        \disc(\alpha_1,\ldots,\alpha_n)=\det(C)^2\disc(1,\theta,\ldots,\theta^{n-1})
    \end{equation*}
    so that $\disc(\alpha_1,\ldots,\alpha_n)=0$ if and only if $\det(C)=0$ if and only if $\alpha_1,\ldots,\alpha_n$ are linearly dependent.
\end{proof}
\begin{theorem}\label{t:disc-pb}
    Let $K=\Q(\theta)$, $[K:\Q]=n$.
    Then
    \begin{equation*}
        \disc(\theta):=\disc(1,\theta,\ldots,\theta^{n-1})=(-1)^{\binom{n}{2}}N_{\Q}^K(f'(\theta))
    \end{equation*}
    where $f(x)\in\Q[x]$ is the minimal polynomial of $\theta$ over $\Q$.
\end{theorem}
\begin{proof}
    Let $\theta_1,\ldots,\theta_n$ be the conjugates of $\theta$.
    Then $f(x)=\prod_{i=1}^n(x-\theta_i)$, so $f'(x)=\sum_{j=1}^n\prod_{i\neq j}(x-\theta_i)$.
    Thus
    \begin{align*}
        N_{\Q}^K(f'(\theta))&=\prod_{k=1}^n\sigma_n(f'(\theta)) = \prod_{k=1}^n f'(\theta_k)\\
                            &= \prod_{k=1}^n\prod_{i\neq k}(\theta_k-\theta_i)= \prod_{i<k}(\theta_k-\theta_i)(\theta_i-\theta_k)\\
                            &= (-1)^{\binom{n}{2}}\prod_{i<k}(\theta_i-\theta_k)^2= \disc(1,\theta,\ldots,\theta^{n-1})
    \end{align*}
\end{proof}
\subsection{Cyclotomic Extensions II: Discriminants}
\begin{theorem}\label{t:disc-cycl}
    Let $\zeta_n=e^{2\pi i/n}$ and set $d=\disc\left(1,\zeta_n,\ldots,\zeta_n^{\phi(n)-1}\right)$.
    Then $d\div n^{phi(n)}$, and if $p$ is an odd prime, $d=(-1)^{\binom{p}{2}}p^{p-2}$.
\end{theorem}
\begin{proof}
    Let $\Phi_n(x)$ be the minimal polynomial of $\zeta_n$, and write $x^n-1=\Phi_n(x)g(x)$ where $g(x)\in\Z[x]$.
    Then $nx^{n-1}=\Phi'_n(x)g(x)+\Phi_n(x)g'(x)$, so $n\zeta_n^{n-1}=\Phi'(\zeta_n)g(\zeta_n)$.
    Thus
    \begin{equation*}
        N\left(n\zeta_n^{n-1}\right)=N\left(\Phi'(\zeta_n)\right)\cdot N\left(g(\zeta_n)\right)
    \end{equation*}
    Since $\zeta_n\in\mathcal{O}^\times_{\Q(\zeta_n)}$, $N(\zeta_n)=\pm 1$.
    Thus
    \begin{equation*}
        \pm n^{\phi(n)}=(-1)^{\binom{\phi(n)}{2}}N\left(\Phi'_n(\zeta_n)\right)\cdot N(g(\zeta_n))
    \end{equation*}
    so $\pm\disc(\zeta_n)N(g(\zeta_n))=n^{\phi(n)}$.
    Since $g\in\Z[x]$, $g(\zeta_n)\in\mathcal{O}_{\Q(\zeta_n)}$ and $N(g(\zeta_n))\in\Z$.
    Thus $\disc(\zeta_n)\div n^{\phi(n)}$, as required.

    Now, if $p$ is an odd prime, $x^p-1=\Phi_p(x)(x-1)$, so $px^{p-1}=\Phi'_p(x)(x-1)+\Phi_p(x)$.
    Thus $p\zeta_p^{p-1}=\Phi_p(\zeta_p)(\zeta_p-1)$.
    Note that $N(\zeta_p^{p-1})=N(\zeta_p)^{p-1}=1$ and since $p-1$ is even.
    We can also compute
    \begin{equation*}
        N(\zeta_p-1)=(-1)^{p-1}\prod_{i=1}^{p-1}(1-\zeta_p^i)=\Phi_p(1)=p
    \end{equation*}
    so that
    \begin{align*}
        p\zeta_p^{p-1}=\Phi_p'(\zeta_p)(\zeta_p-1) &\Rightarrow p^{p-1} = N(\Phi_p'(\zeta_p))p\\
                                                   &\Rightarrow (-1)^{\binom{p}{2}}p^{p-2}=\disc(\zeta_p)
    \end{align*}
    as required.
\end{proof}
\begin{remark}
    In general, we have
    \begin{equation*}
        \disc\left(1,\zeta_n,\ldots,\zeta_n^{\phi(n)-1}\right) = (-1)^{\phi(n)/2}\frac{n^{\phi(n)}}{\prod_{p|n}p^{\phi(n)/(p-1)}}
    \end{equation*}
    which we state here without proof.
\end{remark}
\subsection{Integral Bases}
\begin{definition}
    Let $K$ be a number field, $[K:\Q]=n$.
    We say $A=\{\alpha_1,\ldots,\alpha_n\}$ is an \mbf{integral basis} for $K$ if $\mathcal{O}_K=\spn_{\Z}(A)$.
    When it exists, a \mbf{power basis} for $\mathcal{O}_K$ is an integral basis of the form $\{1,\alpha,\cdots,\alpha^{n-1}\}$; i.e. $\mathcal{O}_K=\Z[\alpha]$.
\end{definition}
\begin{remark}
    Clearly we must have $\alpha_i\in\mathcal{O}_K$.
    As well, $\alpha_1,\ldots,\alpha_n$ is a basis for $K/\Q$: given $\theta\in K$, there exists $r\in\Z^+$ such that $r\theta\in\mathcal{O}_K$, so $r\theta\in\spn_{\Z}(A)$ and $\theta\in\spn_{\Q}(A)$.
    Since $[K:\Q]=n$, $\alpha_1,\ldots,\alpha_n$ is a basis.
    In particular, this means that $A$ is in fact a $\Z-$basis for $\mathcal{O}_K$ (justifying the terminology).
\end{remark}
\begin{theorem}
    If $K$ is a number field, then $K$ has an integral basis.
\end{theorem}
\begin{proof}
    Write $K=\Q(\theta)$ where $\theta\in\mathcal{O}_K$.
    Consider the set of all bases $\{\beta_1,\ldots,\beta_n\}$ for $K/\Q$ such that $\beta_i\in\mathcal{O}_K$.
    Such a basis certainly exists; given any basis, we can clear denominators such that they are in $\mathcal{O}_K$.
    Let $A$ have $|\disc(A)|$ minimal (the discriminant is an integer, so such an $A$ exists); let's show that $A$ is in fact an integral basis.

    Suppose not.
    Then there exists $\gamma\in\mathcal{O}_K$ where $\gamma=a_1\alpha_1+\cdots+a_n\alpha_n$ and $a_1\notin\Z$.
    Let $a_1=a+r$ with $a\in\Z$, $0<r<1$; consider the basis $\{\alpha_1',\ldots,\alpha_n'\}$ where $\alpha_i'=\alpha_i$ for $i>1$, and $\alpha_1'=\gamma-a\alpha_1$.
    Then
    \begin{align*}
        \disc(\alpha_1',\alpha_2',\ldots,\alpha_n') &= \det
        \begin{pmatrix}
            a_1-a&a_2&a_3&\cdots&a_n\\
            0&1&0&\cdots&0\\
            0&0&1&\cdots&0\\
            \vdots&\vdots&\vdots&\ddots&\vdots\\
            0&0&0&\cdots&1
        \end{pmatrix}^2\disc(\alpha_1,\ldots,\alpha_n)\\
        &= r^2\disc(\alpha_1,\ldots,\alpha_n)
    \end{align*}
    Since $0<r<1$, $|\disc(\alpha_1',\ldots,\alpha_n')|<|\disc(\alpha_1,\ldots,\alpha_n)|$, contradicting minimality.
\end{proof}
\begin{proposition}
    If $K$ is a number field, then all integral bases have the same discriminant.
\end{proposition}
\begin{proof}
    Let $\{\alpha_1,\ldots,\alpha_n\}$ and $\{\beta_1,\ldots,\beta_n\}$ be two integral bases; then
    \begin{equation*}
        \alpha_j=\sum\limits_{i=1}^n c_{ij}\beta_i
    \end{equation*}
    for $\alpha_j\in\mathcal{O}_K$ and $c_{ij}\in\Z$.
    Let $C=(c_{ij})$.
    Since $\{\alpha_1,\ldots,\alpha_n\}$ is also an integral basis, $\left(C^{-1}\right)_{ij}\in\Z$ as well.
    Thus $C\in\GL_n(\Z)$ so $\det(C)^2=1$ and
    \begin{equation*}
        \disc(\alpha_1,\ldots,\alpha_n)=\det(C)^2\disc(\beta_1,\ldots,\beta_n)
    \end{equation*}
    indeed have the same discriminant.
\end{proof}
\begin{definition}
    If $K$ is a number field, we say its \mbf{discriminant} $\disc(K)$ is the discriminant of any integral basis.
\end{definition}
\begin{example}[Quadratic Extensions]
    Consider $\Q(\sqrt{d})$.
    If $d\nequiv 1\pmod{4}$, then $\{1,\sqrt{d}\}$ is an integral basis; if $d\equiv 1\pmod{4}$, then $\left\{1,\frac{1+\sqrt{d}}{2}\right\}$ is an integral basis.
    Thus
    \begin{equation*}
        \disc(\Q(\sqrt{d}))=
        \begin{cases}
            4d & d\nequiv 1\pmod{4}\\
            d & d\equiv 1\pmod{4}
        \end{cases}
    \end{equation*}
\end{example}
\begin{proposition}\label{p:ext}
    Let $K$ be a number field, $\{\alpha_1,\ldots,\alpha_n\}$ a basis for $K/\Q$ with $\alpha_i\in\mathcal{O}_K$.
    If $d=\disc(\alpha_1,\ldots,\alpha_n)$, then for all $\alpha\in\mathcal{O}_K$, there exists $m_i\in\Z$ such that
    \begin{align*}
        \alpha&=\frac{\sum_{i=1}^n m_i\alpha_i}{d} &  d&\div m_i^2
    \end{align*}
\end{proposition}
\begin{example}
    Consider $\Q(\sqrt{d})$, where $d\equiv 1\pmod{4}$.
    Then $\{1,\sqrt{d}\}$ is a $\Q-$basis, $\sqrt{d}\in\mathcal{O}_K$, and $\disc(1,\sqrt{d})=4d$.
    Since $d$ is squarefree, if $4d\div m_i^2$, then $d\div m_i$.
    Thus, the proposition states that any $\gamma\in\mathcal{O}_K$ can be expressed in the form $\frac{m_1+m_2\sqrt{d}}{2}$ for some $m_1,m_2\in\Z$.
    Note that the converse is not necessarily true: not all such expressions are in $\mathcal{O}_K$ (indeed, we need $m_1\equiv m_2\pmod{2}$).
\end{example}
\begin{proof}
    Let $\alpha\in\mathcal{O}_K$ be arbitrary so that $\alpha=a_1\alpha_1+\cdots+a_n\alpha_n$ for some $a_i\in\Q$.
    Let $\sigma_1,\ldots,\sigma_n:K\hto\C$ extend $\Q\subseteq\C$.
    For each $j=1,\ldots,n$, we have $\sigma_j(\alpha)=a_1\sigma_j(\alpha_1)+\cdots+a_n\sigma_j(\alpha_n)$ so that
    \begin{equation*}
        \begin{pmatrix}
            \sigma_1(\alpha_1)&\hdots&\sigma_1(\alpha_n)\\
            \vdots&&\vdots\\
            \sigma_n(\alpha_1)&\hdots&\sigma_n(\alpha_n)
        \end{pmatrix}
        \begin{pmatrix}
            a_1\\\vdots\\a_n
        \end{pmatrix}
        =
        \begin{pmatrix}
            \sigma_1(\alpha)\\\vdots\\\sigma_n(\alpha)
        \end{pmatrix}
    \end{equation*}
    Define
    \begin{equation*}
        \gamma_j:=\det\begin{pmatrix}
            \sigma_1(\alpha_1)&\cdots&\sigma_1(\alpha)&\hdots&\sigma_1(\alpha_n)\\
            \vdots&&\vdots&&\vdots\\
            \sigma_n(\alpha_1)&\hdots&\sigma_n(\alpha)&\hdots&\sigma_n(\alpha_n)
        \end{pmatrix}
    \end{equation*}
    where the $j^\text{th}$ column is replaced, and $\delta=\det(\sigma_j(\alpha_i))$.
    Since $\alpha_i\in\mathcal{O}_K$, $\sigma_j(\alpha_i)\in\mathcal{O}_K$ for any $j$, so $\gamma_j,\delta\in\mathcal{O}_K$.
    Note that $d:=\disc(K)=\delta^2$.
    By Cramer's rule, $a_j=\frac{\gamma_j}{\delta}$.
    Take $m_j:= da_j\in\Q$; but then $da_j=\delta\gamma_j\in\mathcal{O}_K$, so $m_j\in\Q\cap\mathcal{O}_K=\Z$.

    For the second part, we have
    \begin{align*}
        \frac{m_j^2}{d} &= da_j^2=d\left(\frac{\gamma_j}{\delta}\right)^2= \frac{d\gamma_j^2}{\delta^2}=\gamma_j^2\in\mathcal{O}_K
    \end{align*}
    so $m_j^2/d\in\Z$ as well.
\end{proof}
\subsection{Real and Complex Embeddings}
Let $K$ be a number field and let $\sigma_1,\ldots,\sigma_n:K\hto\C$ be the embeddings extending $\Q\subseteq\C$.
Let $r_1$ denote the number of embeddings where $K\hto\R$; then, the other embeddings come in pairs: if $\sigma:K\hto\C$, then $\ol{\sigma}:K\hto\C$ is a (distinct) embedding.

We say that $r_1$ is the number of real embeddings, and $2r_2$ is the number of complex embeddings; in this case, $n=r_1+2r_2$.
\begin{example}
    Let $d$ be squarefree.
    Then $\Q(\sqrt{d})$ for $d>0$ has $r_1=2$, $r_2=0$, while $\Q(\sqrt{d})$ for $d<0$ has $r_1=0$, $r_2=1$.
\end{example}
\begin{proposition}
    Let $[K:\Q]=n$; then, the sign of $\disc(K)$ is $(-1)^{r_2}$.
\end{proposition}
\begin{proof}
    Let $\alpha_1,\ldots,\alpha_n$ be an integral basis for $K/\Q$.
    Consider
    \begin{align*}
        \delta&=\det
        \begin{pmatrix}
            \sigma_1(\alpha_1)&\hdots&\sigma_1(\alpha_n)\\
            \vdots&&\vdots\\
            \sigma_n(\alpha_1)&\hdots&\sigma_n(\alpha_n)
        \end{pmatrix}
        &
        \ol{\delta}&=\det
        \begin{pmatrix}
            \ol{\sigma_1}(\alpha_1)&\hdots&\ol{\sigma_1}(\alpha_n)\\
            \vdots&&\vdots\\
            \ol{\sigma_n}(\alpha_1)&\hdots&\ol{\sigma_n}(\alpha_n)
        \end{pmatrix}
    \end{align*}
    where $\disc(K)=\delta^2$.
    If $\sigma_i$ is real, then $\ol{\sigma_i}=\sigma_i$.
    If $(\sigma_i,\sigma_j)$ are complex conjugate pairs, then in $\ol{\delta}$ we swap column $i$ with column $j$.
    Thus $\ol{\delta}=(-1)^{r_2}\delta$, so $\delta$ is purely imaginary if $r_2$ is odd, and real if $r_2$ is even.
    This proves the claim.
\end{proof}
\subsection{Cyclotomic Extensions III: Algebraic Integers in \texorpdfstring{$\Q(\zeta_{p^r})$}{Qzpr}}
\begin{theorem}\label{t:cepr}
    If $p$ is prime, $r\in\Z^+$, then $\mathcal{O}_{\Q(\zeta_{p^r})}=\Z[\zeta_{p^r}]$.
\end{theorem}
\begin{proof}
    For notation $\zeta=\zeta_{p^r}$ and we take $\Q(\zeta)=\Q(1-\zeta)$.

    Let $s=\phi(p^r)$, so $\{1,1-\zeta,\ldots,(1-\zeta)^{s-1}\}$ is a $\Q-$basis for $\Q(\zeta)$.
    Let's show that it is an integral basis.
    By \cref{p:ext}, we know if $\alpha\in\mathcal{O}_K$, there exist $m_i\in\Z$ such that $\alpha=\frac{\sum_{i=1}^n m_j(1-\zeta)^j}{d}$ where
    \begin{align*}
        d &= \disc(1-\zeta)= \prod_{\substack{i<j\\i,j\in(\Z/p^r)^\times}}((1-\zeta^i)-(1-\zeta^j))^2\\
          &= \prod_{\substack{i<j\\i,j\in(\Z/p^r)^\times}}(\zeta^i-\zeta^j)^2= \disc(\zeta)=\pm p^{p-2}
    \end{align*}

    Let's first treat the case $\beta=\frac{l_1+l_2(1-\zeta)+\cdots+l_s(1-\zeta)^{s-1}}{p}$.
    Let $i$ be minimal so that $p\nmid l_i$.
    Set
    \begin{equation*}
        \gamma=\frac{l_i(1-\zeta)^{i-1}+\cdots+l_s(1-\zeta)^{s-1}}{p}\in\mathcal{O}_K
    \end{equation*}
    Since $(1-x)\div(1-x^j)$ in $\Z[x]$, $(1-\zeta)\div(1-\zeta^j)$ in $\mathcal{O}_K$ so that
    \begin{equation*}
        (1-\zeta)^s\div \prod_{p\nmid j}(1-\zeta^j)=\Phi_{p^r}(1)=p
    \end{equation*}
    over $\mathcal{O}_K$.
    Thus $p=(1-\zeta)^s\lambda$ for some $\lambda\in\mathcal{O}_K$.
    Since $\lambda,\gamma,1-\zeta\in\mathcal{O}_K$, $(1-\zeta)^{s-i}\lambda\gamma\in\mathcal{O}_K$.
    However,
    \begin{align*}
        (1-\zeta)^{s-i}\lambda\gamma &= \lambda\frac{l_i(1-\zeta)^{s-1}}{p}+\lambda\frac{l_{i+1}(1-\zeta)^s}{p}+\cdots
    \end{align*}
    where the tail terms are all algebraic integers, so
    \begin{equation*}
        \theta:=\frac{l_i}{1-\zeta}=\lambda\frac{l_i(1-\zeta)^{s-1}}{p}\in\mathcal{O}_K
    \end{equation*}
    Then $(1-\zeta)\theta=l_i$ and, taking norms, $N(1-\zeta)N(\theta)=N(l_i)$ so that $pN(\theta)=l_i^s$ and $p\mid l_i$ and no such $l_i$ exists.
    But now since $d=\pm p^{p-2}$, we may repeat the above argument for each factor of $p$, and we are done.
\end{proof}
\begin{remark}
    This proof demonstrates a general tool for verifying that a given basis of algebraic integers is indeed integral.
    One need simply check each prime $p$ such that $p^2\div d$; if there are no algebraic integers of the form $\alpha=\frac{m_1\beta_1+\cdots+m_n\beta_n}{p}$ where $|m_i|<p$ for every such $p$, then $\beta$ is indeed an integral basis.

    If there is some $\alpha$ of this form, then update $\{\beta_1,\ldots,\beta_n\}$ with the new algebraic integer $\alpha$; the new discriminant is $d/p^2$, and we may repeat the above process.
    This process will terminate after a finite number of steps (though it may take a while), giving a general procedure to compute integral bases for arbitrary number fields.
\end{remark}
\section{Composita and Resultants}
\subsection{Composita}
\begin{definition}
    If $K,L$ are number fields, then the \mbf{compositum} of $K$ and $L$ is the smallest field containing $K\cup L$.
    We denote it by $KL=LK$.
\end{definition}
% \begin{remark}
    % For the skeptical, such a compositum always exists.
    % Take $F=K\otimes_{\Q} L$, which is a non-zero ring; then $(0)$ extends to a maximal ideal $I$ and $\quot{K\otimes_{\Q} L}{I}$ is a field containing both $K$ and $L$.
% \end{remark}
Our goal in this section is to relate $\mathcal{O}_K$, $\mathcal{O}_L$, and $\mathcal{O}_{KL}$.
\begin{lemma}\label{l:ext-comp}
    Suppose $[K:\Q]=m$, $[L:\Q]=n$.
    \begin{enumerate}[nl,r]
        \item $[KL:\Q]\leq mn$.
        \item $[KL:\Q]=mn$ if and only if for any embeddings $\sigma:K\hto\C$, $\tau:L\hto\C$ embeddings, there exists a unique embedding $\epsilon:KL\hto\C$ such that $\epsilon|_K=\sigma$, $\epsilon|_L=\tau$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[nl,r]
        \item We have $[KL:\Q]=[KL:K]\cdot[K:\Q]\leq[L:\Q]\cdot[K:\Q]=mn$.
        \item Consider $\epsilon|_K:K\hto \C$ and $\epsilon|_L:L\hto\C$; since the products $\alpha\beta$ for $\alpha\in K$ and $\beta\in L$ generate $KL$, $\epsilon$ is determined uniquely by $\epsilon|_K$ and $\epsilon|_L$.
            Since $[KL:\Q]=mn$, then there are $mn$ embeddings $\epsilon:KL\hto\C$, so this must be all of them, and the equivalence follows.
    \end{enumerate}
\end{proof}
\begin{theorem}\label{t:comp}
    Let $[K:\Q]=n$, $[L:\Q]=m$, $[KL:\Q]=mn$, and $d=\gcd(\disc(K),\disc(L))$.
    Then $\mathcal{O}_{KL}\subseteq\frac{1}{d}\mathcal{O}_K\mathcal{O}_L$.
\end{theorem}
\begin{proof}
    Let $\{\alpha_1,\ldots,\alpha_n\}$ be an integral basis for $K/\Q$ and $\{\beta_1,\ldots,\beta_m\}$ an integral basis for $L/\Q$.
    Then $KL=\spn_{\Q}\{\alpha_i\beta_j:(i,j)\in[n]\times[m]\}$.
    Since $[KL:\Q]=mn$, the $\alpha_i\beta_j$ are a $\Q-$basis of algebraic integers.
    Then $\alpha\in KL$ can be represented as
    \begin{equation*}
        \alpha=\sum\limits_{i=1}^m\sum\limits_{j=1}^n\frac{\alpha_i\beta_ja_{ij}}{r}
    \end{equation*}
    with $a_{ij},r\in\Z$ and $\gcd(a_{11},\ldots,a_{nm},r)=1$.
    If $\alpha\in\mathcal{O}_{KL}$ we want to show that $r\mid\disc(K)$ and $r\mid\disc(L)$ so that $r|d$ and $\alpha\in\frac{1}{d}\mathcal{O}_K\mathcal{O}_L$.
    
    By symmetry, let's show that $r\mid\disc(K)$.
    Given $\sigma_1,\ldots,\sigma_n:K\hto\C$, by \cref{l:ext-comp} there exists $\sigma_i':KL\hto\C$ so that $\sigma_i'|_K=\sigma_i$ and $\sigma_i'|_L=\id_L$.
    Then
    \begin{align*}
        \sigma_i'(\alpha)&= \sum\limits_{i=1}^m x_i\sigma(\alpha_i)& x_i&=\sum\limits_{j=1}^n\frac{a_{ij}\beta_j}{r}
    \end{align*}
    since $x_i\in L$.
    Equivalently,
    \begin{equation*}
        \begin{pmatrix}
            \sigma_1(\alpha_1)&\hdots&\sigma_1(\alpha_n)\\
            \vdots&\ddots&\vdots\\
            \sigma_n(\alpha_1)&\hdots&\sigma_n(\alpha_n)
        \end{pmatrix}
        \begin{pmatrix}
            x_1\\\vdots\\x_n
        \end{pmatrix}
        =
        \begin{pmatrix}
            \sigma_1'(\alpha)\\\vdots\\\sigma_n'(\alpha)
        \end{pmatrix}
    \end{equation*}
    Let
    \begin{equation*}
        \gamma_i=
        \begin{pmatrix}
            \sigma_1(\alpha_1)&\cdots&\sigma_1'(\alpha_1)&\cdots&\sigma_1(\alpha_n)\\
            \vdots&&\vdots&&\vdots\\
            \sigma_n(\alpha_1)&\hdots&\sigma_n'(\alpha_n)&\cdots&\sigma_n(\alpha_n)
        \end{pmatrix}
    \end{equation*}
    where the $i$\textsuperscript{th} column is replaced.
    Then by Cramer's rule, $x_i=\frac{\gamma_i}{\delta}$ where $\gamma_i,\delta\in\mathcal{O}_K$ and $\delta^2=\disc(K)$.
    Thus $\disc(K)x_i=\delta\gamma_i\in\mathcal{O}_K$ is an algebraic integer, but also $\disc(K)\in\Z$ so $\disc(K)x_i\in L$.
    Thus $\disc(K)x_i\in \mathcal{O}_L$; but then, since
    \begin{equation*}
        \disc(K)x_i = \sum\limits_{j=1}^m\left(\frac{\disc(K)a_{ij}}{r}\right)\beta_j
    \end{equation*}
    and the $\beta_j$ form an integral basis for $\mathcal{O}_L$, we have $\frac{\disc(K)a_{ij}}{r}\in\Z$.
    Since $\gcd(a_{11},\ldots,a_{mn},r)=1$, this forces $r\mid\disc(K)$.
\end{proof}
\subsection{Cyclotomic Extensions IV: Algebraic Integers in \texorpdfstring{$\Q(\zeta_n)$}{Qzn}}
\begin{theorem}
    $\mathcal{O}_{\Q(\zeta_n)}=\Z[\zeta_n]$.
\end{theorem}
\begin{proof}
    Let's do this by induction on the number of prime factors of $n$; we already did the base case $n=p^r$ in \cref{t:cepr}.
    For $k\geq 2$ let
    \begin{align*}
        n&=p_1^{e_1}\cdots p_k^{e_k} &
        m:&=p_1^{e_1}\cdots p_{k-1}^{e_{k-1}} &
        K&=\Q\left(\zeta_{m}\right) &
        L&=\Q\left(\zeta_{p_k^{e_k}}\right)
    \end{align*}
    First, let's see that $KL=\Q(\zeta_n)$.
    Note that $\zeta_n\in KL$ since $m$ and $p_k^{e_k}$ are coprime; thus, there exists $x,y\in\Z$ so that $xm+yp_k^{e_k}=1$.
    Then $\zeta_m^y\zeta_{p_k^{e_k}}^x=e^{2\pi i/n}$, so $\Q(\zeta_n)\subseteq KL$.
    As well,
    \begin{equation*}
        \phi(n)=\phi(m)\phi\left(p_k^{e_k}\right)=[K:\Q]\cdot[L:\Q]\geq [KL:\Q]\geq[\Q(\zeta_n):\Q]=\phi(n)
    \end{equation*}
    so $\Q(\zeta_n)=KL$ and $[KL:\Q]=[K:\Q][L:\Q]$.
    Thus, $\Q(\zeta_n)=KL$ and $[KL:\Q]=[K:\Q][L:\Q]$ and by \cref{t:comp}, we have
    \begin{equation*}
        \Z[\zeta_n]\subseteq \mathcal{O}_{\Q(\zeta_n)}\subseteq\frac{1}{d}\mathcal{O}_{\Q(\zeta_m)}\mathcal{O}_{\Q(\zeta_{p_k^{e_k}})}=\frac{1}{d}\Z[\zeta_m]\Z[\zeta_{p_k^{e_k}}]=\frac{1}{d}\Z[\zeta_n]
    \end{equation*}
    where $d=\gcd(\disc K,\disc L)$.
    Recall by \cref{t:disc-cycl}, we have $\disc\left(\Q(\zeta_n)\right)\div n^{\phi(n)}$.
    Thus $\disc(K)\div m^{\phi(m)}$ and $\disc(L)\div (p_k^{e_k})^{\phi(p_k^{e_k})}$ so that $d=1$ and $\mathcal{O}_{\Q(\zeta_n)}=\Z[\zeta_n]$.
\end{proof}
\subsection{Resultants}
\begin{definition}
    Let $f(x),g(x)\in\C[x]$ with $f(x)=a_nx^n+\cdots+a_1x+a_0$, $g(x)=b_mx^m+\cdots+b_1x+b_0$.
    The \mbf{resultant} of $f$ and $g$ is
    \begin{equation*}
        R(f,g) =\det
        \begin{pmatrix}
            a_n&a_{n-1}&\cdots&a_1&a_0&0&\cdots&0\\
            0&a_n&a_{n-1}&\cdots&a_1&a_0&\ddots&\vdots\\
            \vdots&\ddots&\ddots&\ddots&\ddots&\ddots&\ddots&0\\
            0&\cdots&0&a_n&a_{n-1}&\cdots&a_1&a_0&\\
            b_m&b_{m-1}&\cdots&b_0&0&0&\cdots&0\\
            0&b_m&\cdots&b_1&b_0&0&\cdots&0\\
            0&0&b_m&\cdots&b_1&b_0&\ddots&\vdots\\
            \vdots&\vdots&\ddots&\ddots&\ddots&\ddots&\ddots&0\\
            0&0&\cdots&0&b_m&\cdots&b_1&b_0
        \end{pmatrix}
    \end{equation*}
\end{definition}
\begin{remark}
    $R(f,g)$ is homoeneous of degree $m$ in the $a_i$ and degree $n$ in the $b_j$.
\end{remark}
We want to show that if $f,g\in\Q[x]$, then $R(f,g)=0$ if and only if $f$ and $g$ have a common factor in $\Q[x]$.
In particular, we have the following proposition:
\begin{proposition}\label{p:res}
    Let $f,g\in\C[x]$.
    The following are equivalent:
    \begin{enumerate}[nl,r]
        \item $f$ and $g$ have a common root in $\C$
        \item There exists $h,k\in\C[x]$ such that $hf=kg$ and $\deg(h)\leq m-1$, $\deg(k)\leq n-1$.
        \item $R(f,g)=0$
    \end{enumerate}
\end{proposition}
\begin{proof}
    \imp{i}{ii} If $f,g$ have a common root $\alpha\in\C$, then $(x-\alpha)\mid f$ and $(x-\alpha)\mid g$.
    Then $f=(x-\alpha)k$, $g=(x-\alpha)h$ and $hf=(x-\alpha)kh=kg$.

    \imp{ii}{i} If $hf=kg$ with $\deg h\leq m-1$, $\deg k\leq n-1$, then by Pigeonhole principle, the roots of $k$ cannot contain all the roots of $f$, so one root must be a root of $g$.

    \impe{ii}{iii} We can now turn our question into one of linear algebra.
    Given $f,g$, we want to compute $h,k$ such that $hf=kg$ where $\deg h=\deg g-1$, and $\deg k =\deg f-1$.
    Let
    \begin{align*}
        h&=c_{m-1}x^{m-1}+\cdots+c_1x+c_0\\
        k&=d_{n-1}x^{n-1}+\cdots+d_0
    \end{align*}
    Treate $c_i$, $d_j$ as indeterminants so that the statement $hf=kg$ encodes $n+m$ equations by comparing coefficients of the same degree.
    For example, the $x^{n+m-2}$ equation $a_nc_{m-2}+a_{n-1}c_{m-1}=b_md_{n-2}+b_{m-1}d_{n-1}$.
    In particular, $(c_0,\ldots,c_{m-1};-d_0,\ldots,-d_{n-1})$ is a solution if and only if it is in the kernel of the matrix
    \begin{equation*}
        A=
        \begin{pmatrix}
            a_n&0&\cdots&0&b_m&0&0&\cdots&0\\
            a_{n-1}&a_n&\ddots&\vdots&b_{m-1}&b_m&0&\cdots&0\\
            \vdots&a_{n-1}&\ddots&0&\vdots&\vdots&b_m&\ddots&\vdots\\
            a_1&\vdots&\ddots&a_n&b_0&b_1&\vdots&\ddots&0\\
            a_0&a_1&\ddots&a_{n-1}&0&b_0&b_1&\ddots&b_m\\
            0&a_0&\ddots&\vdots&0&0&b_0&\ddots&\vdots\\
            \vdots&\ddots&\ddots&a_1&\vdots&\vdots&\ddots&\ddots&b_1\\
            0&\cdots&0&a_0&0&0&\cdots&0&b_0
        \end{pmatrix}
    \end{equation*}
    and this matrix has non-trivial kernel if and only if $0=\det(A)=\det(A^t)=R(f,g)$.
\end{proof}
Let $x_1,\ldots,x_n$ denote the roots of $f$ and $y_1,\ldots,y_m$ denote roots of $g$.
Then $a_1,\ldots,a_n$ are $a_n$ times an elementary symmetric function in the $x_i$, $b_1,\ldots,b_{m-1}$ are $b_m$ times an elementary symmetric function in the $y_i$.
Thus $R(f,g)\in \C[x_1,\ldots,x_n,y_1,\ldots,y_m]=:P$ is a symmetric polynomial times $a_n^mb_m^n$.
By \cref{p:res}, if $x_i=y_j$, then $R(f,g)=0$.
In other words, every $(x_i-y_j)\mid R(f,g)$ (as polynomials).
Since each $(x_i-y_j)$ is an irreducible coprime factor of $P$, $\prod_{i,j}(x_i-y_j)\div R(f,g)$.
Set $S:=a_n^mb_m^n\prod_{i,j}(x_i-y_j)$.

In particular, note that $g(x)=b_m\prod_{j=1}^m(x-y_j)$ so that $a_n^m\prod_{i=1}^ng(x_i)=S$ and
\begin{align}
    S=a_n^m\prod_{i=1}^ng(x_i)\label{eq:S1}
\end{align}
Similarly, $f(x)=a_n\prod_{i=1}^n(x-x_i)=(-1)^na_n\prod_{i=1}^n(x_i-x)$ so that
\begin{align}
    S=(-1)^{mn}b_m^n\prod_{i=1}^nf(y_i)\label{eq:S2}
\end{align}
\cref{eq:S1} tells us that $S$ is homogeneous of degree $n$ in the $b_j$'s, and \cref{eq:S2} says $S$ is homogenous of degree $m$ in the $a_i$.
Since $R(f,g)$ has the same property and $S\div R(f,g)$, $R=cS$ for some $c\in\C$.
However, $S$ has constant term $a_n^mb_m^n$, which is the same as $R(f,g)$; thus, $c=1$.
In particular, we've shown the following proposition:
\begin{proposition}\label{p:res-alt}
    Let $f,g\in\C[x]$ with $\deg f=n$, $\deg g=m$, and $f$ have roots $x_1,\ldots,x_n$ and $g$ have roots $y_1,\ldots,y_m$ (perhaps with repetitions).
    Then
    \begin{equation*}
        \displaystyle R(f,g)=a_n^mb_m^n\prod_{i,j}(x_i-y_j)
    \end{equation*}
\end{proposition}
This gives us an easy way to compute certain types of discriminants:
\begin{corollary}
    Let $\alpha$ be algebraic over $\Q$ and $f$ the minimal polynomial of $\alpha$.
    Then $\disc(\alpha)=(-1)^{\binom{n}{2}}R(f,f')$.
\end{corollary}
\begin{proof}
    Let's apply \cref{p:res-alt} in the case where $g=f'$.
    Let $f(x)=x^n+a_{n-1}x^{n-1}+\cdots+a_0=(x-\alpha_1)\cdots(x-\alpha_n)$.
    Let $\sigma_1,\ldots,\sigma_n:\Q(\alpha)\hto\C$ extend $\Q\subseteq\C$.
    Then applying \cref{eq:S1}, we have
    \begin{align*}
        R(f,f')=\prod_{i=1}^n f'(\alpha_i)=\prod_{i=1}^n\sigma_i(f'(\alpha))=N_{\Q}^{\Q(\alpha)}(f'(\alpha))
    \end{align*}
    and the result follows by \cref{t:disc-pb}.
\end{proof}
As a fun application of this result, let's prove the following proposition.
Note that the result was not strictly necessary to do this, but we get to use it to do one of the computations.
\begin{proposition}
    Let $\theta$ be a root of $f(x)=x^3+x^2-2x+8$, and $K=\Q(\theta)$.
    Then $\mathcal{O}_K$ has no power basis.
\end{proposition}
\begin{proof}
    Let's calculate $\mathcal{O}_K$.
    First, we have
    \begin{equation*}
        \disc(\theta)=-R(f,f')=
        \det
        \begin{pmatrix}
            1&1&-2&8&0\\
            0&1&1&-2&8\\
            3&2&-2&0&0\\
            0&3&2&-2&0\\
            0&0&3&2&-2
        \end{pmatrix}^2
        =-4\cdot 503
    \end{equation*}
    Thus $\disc(K)=-4\cdot 503$ or $\disc(K)=-503$ since, under change of basis, the factor must change by a square of an integer.
    We know from a homework assignment (or by direct computation) that $\mathcal{O}_K\neq\Z[\theta]$ since $(\theta^2-\theta)/2\in\mathcal{O}_K$ and $\disc(K)=-503$.
    In particular, one has that $\disc(1,\theta,\frac{\theta^2-\theta}{2})=-503$ by change of basis.
    Since $503$ is squarefree, $\left\{1,\theta,\frac{\theta^2-\theta}{2}\right\}$ is an integral basis of $\mathcal{O}_K$.

    Now, let $\lambda\in\mathcal{O}_K$.
    We'll show that $2\mid\disc(\lambda)$ so that $\disc(\lambda)\neq -503$ and $\{1,\lambda,\lambda^2\}$ is not an integral basis.
    We can write $\lambda=a+b\theta+c\frac{\theta^2-\theta}{2}$ for $a,b,c\in\Z$.
    In particular, after some computation, one has $\lambda^2=A_1+A_2\theta+A_3\frac{\theta^2-\theta}{2}$, where
    \begin{align*}
        A_1&=a^2-2c^2-8bc\\
        A_2&=-2c^2+2ab+2bc-b^2\\
        A_3&= 2b^2+2ac+c^2
    \end{align*}
    Then by change of basis,
    \begin{align*}
        \disc(\lambda)&=-503\cdot\det
        \begin{pmatrix}
            1&0&0\\
            a&b&c\\
            A_1&A_2&A_3
        \end{pmatrix}^2
        = -503\cdot (bA_3-cA_2)^2\\
        &=-503\cdot(2b^3-bc^2+b^2c+2c^3)^2
    \end{align*}
    where $2b^3-bc^2+b^2c+2c^3\equiv bc(b-c)\equiv 0\pmod{2}$.
\end{proof}
\chapter{Prime Ideals in Number Rings}
\section{Dedekind Domains}
\begin{definition}
    $R$ is \mbf{Noetherian} if every ideal of $R$ is finitely generated; that is, $I=(r_1,\ldots,r_n)$.
\end{definition}
\begin{proposition}\label{t:noe}
    The following are equivalent:
    \begin{enumerate}[nl,r]
        \item Every ascending chain of ideals in $R$ stabilizes.
        \item Every non-empty set $S$ of ideals of $R$ has a maximal element in $S$.
        \item $R$ is Noetherian.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \imp{i}{ii}
    Let $S$ be a non-empty set of ideals with no maximal element.
    Since $S$ is non-empty, get $I_1\in S$.
    Then for any $I_k\in S$, $I_k$ is not maximal and get $I_{k+1}\supsetneq I_k$.
    This is an infinite chain of ideal which does not stabilize.

    \imp{ii}{i}
    Let $I_1\subseteq I_2\subseteq\cdots$ be an ascending chain of ideals, and let $S=\{I_k:k\in\N\}$.
    By assumption, $S$ has a maximal element, $I_N$; but then for any $n\geq N$, $I_n=I_N$ and the chain stabilizes.

    \imp{i}{iii}
    Let $I$ be an ideal of $R$ not finitely generated.
    Then $I\neq(0)$, so get $a_1\in I$.
    For any finite $a_1,\ldots,a_k\in I$, since $I$ is not finitely generated, there exists $a_{k+1}\in I\setminus(a_1,\ldots,a_k)$.
    But then $\{(a_1,\ldots,a_i):i\in\N\}$ does not stabilize, a contradiction.

    \imp{iii}{i}
    Let $I_1\subseteq I_2\subseteq\cdots$ be an ascending chain of ideals, and set $I=\bigcup_{i=1}^\infty I_n$.
    By assumption, $I=(x_1,\ldots,x_n)$.
    Since each $x_i\in I_j$ for some $j$, get $k$ so that $x_1,\ldots,x_n\in I_k$; but then $I_k=I_n$ for all $n\geq k$ and the chain stabilizes.
\end{proof}
\begin{theorem}[Hilbert]
    If $R$ is Noetherian, then $R[x]$ is Noetherian.
\end{theorem}
\begin{proof}
    See PMATH 446 notes.
\end{proof}
\begin{remark}
    The most basic example of a Noetherian domain is a PID.
    It is also easy to see that if $R$ is Noetherian, $R/I$ is also Noetherian.
    This means that a lot of rings are Noetherian.
\end{remark}
\begin{definition}
    If $R\subseteq S$ subrings with $R,S$ integral domains, we say $s\in S$ is \mbf{integral over $R$} if there exists $f(x)\in R[x]$, $f$ monic, such that $f(s)=0$.
    We say $R$ is \mbf{integrally closed in $S$} if $s\in S$ is integral over $R$ if and only if $s\in R$.
\end{definition}
\begin{example}
    \begin{enumerate}[nl]
        \item Let $K$ be a number field so that $\Z\subseteq K$.
            Then $\alpha\in K$ is integral over $\Z$ if and only if $\alpha\in\mathcal{O}_K$.
        \item If $R=\Z$, $\Frac(R)=\Q$ and $\alpha\in\Q$ is integral over $R$ if and only if  $\alpha\in\Z$, so $\Z$ is integrally closed in $\Q$.

        \item If $R=\Z[\sqrt{5}]$, then $\Frac(R)=\Q(\sqrt{5})$.
            Note that $(1+\sqrt{5})/2$ is integral over $\Z[\sqrt{5}]$ (in fact, it is not even integral over $\Z$), so $\Z[\sqrt{5}]$ is not integrally closed in $\Q(\sqrt{5})$.
    \end{enumerate}
\end{example}
\begin{definition}
    A \mbf{Dedekind domain} is an integral domain $R$ satisfying $3$ properties:
    \begin{enumerate}[nolistsep]
        \item $R$ is Noetherian.
        \item Every prime ideal is maximal.
        \item $R$ is integrally closed in its field of fractions.
    \end{enumerate}
\end{definition}
\begin{proposition}\label{p:id-scale}
    Let $K$ be a number field, $0\neq I\subseteq\mathcal{O}_K$ an ideal.
    Then there exists $a\in\Z\setminus\{0\}$ such that $a\in I$.
\end{proposition}
\begin{proof}
    Say $\alpha\in I$, $\alpha\neq 0$.
    Let $\alpha_1,\ldots,\alpha_n$ be conjugates of $\alpha=\alpha_1$ so that $a:=N_{\Q}^{\Q(\alpha)}(\alpha)=\alpha_1\cdots\alpha_n\in\Z\setminus\{0\}$.
    As in the proof of \cref{p:unit}, $\alpha_2\cdots\alpha_n\in\mathcal{O}_K$ so that $a\in I$.
\end{proof}
\begin{remark}
    If $0\neq I\subseteq\mathcal{O}_K$, this proposition show that $I\cap\Z\subseteq\Z$ is a non-zero ideal.
\end{remark}
\begin{definition}
    Given $I\subseteq\mathcal{O}_K$ an ideal, then $\{\alpha_1,\ldots,\alpha_n\}$ is called an \mbf{integral basis} of $I$ if $\alpha_i\in I$ and every element of $I$ has a unique representation as an integer linear combination of the $\alpha_i$.
\end{definition}
\begin{theorem}\label{t:id-basis}
    Every non-zero ideal $I\subseteq\mathcal{O}_K$ has an integral basis.
    More specifically, if $\{\omega_1,\ldots,\omega_n\}$ is an integral basis for $\mathcal{O}_K$, then there exists $a_{ij}\in\Z$, $a_{ii}\in\Z^+$ such that $\{\alpha_1,\ldots,\alpha_n\}$ is an integral basis for $I$ and
    \begin{equation*}
        \begin{pmatrix}
            \alpha_1\\\vdots\\\alpha_n
        \end{pmatrix}
        =
        \begin{pmatrix}
            a_{11}&0&\hdots&0\\
            a_{21}&a_{22}&\ddots&\vdots\\
            \vdots&\vdots&\ddots&0\\
            a_{n1}&a_{n2}&\hdots&a_{nn}
        \end{pmatrix}
        \begin{pmatrix}
            \omega_1\\\vdots\\\omega_n
        \end{pmatrix}
    \end{equation*}
\end{theorem}
\begin{proof}
    From \cref{p:id-scale} there exists $a\in I\cap\Z^+$; in particular, for any $\omega\in\mathcal{O}_K$, $a\omega\in I$.
    We shall use this fact throughout the proof.
    We thus inductively define $a_{ij}$ as follows:
    \begin{itemize}[nl]
        \item Let $a_{11}\in\Z^+$ be minimal such that $a_{11}\omega_1\in I$; set $\alpha_1:=a_{11}\omega_1$.
        \item Let $a_{21}\in\Z$ and $a_{22}\in\Z^+$ minimal such that $\alpha_2:=a_{21}\omega_1+a_{22}\omega_2\in I$.
            Again, such an $\alpha_2$ exists since $a(\omega_1+\omega_2)\in I$.
        \item In general, let $\alpha_i:=a_{i1}\omega_1+a_{i(i-1)}\omega_{i-1}+\cdots+a_{ii}\omega_i\in I$ with $a_{ii}\in\Z^+$ minimal.
    \end{itemize}
    Let $A=(a_{ij})$ which satisfies the requirements; it remains to show that $\{\alpha_1,\ldots,\alpha_n\}$ is in fact an integral basis.
    Since $\{\omega_1,\ldots,\omega_n\}$ is a basis for $K/\Q$ and $\det(A)\neq 0$, $\{\alpha_1,\ldots,\alpha_n\}$ is as well.

    Now, let $\beta\in I$ be arbitrary.
    Since $\{\omega_1,\ldots,\omega_n\}$ is an integral basis for $\mathcal{O}_K$, get $b_i\in\Z$ such that $\beta=b_1\omega_1+\cdots+b_n\omega_n$.
    Write $b_n=a_{nn}q+r$ with $0\leq r<a_{nn}$ and $q,r\in\Z$.
    Then
    \begin{equation*}
        b_1\omega_1+\cdots+b_{n-1}\omega_{n-1}+r\omega_n=\beta-q\alpha_n\in I
    \end{equation*}
    so by minimaliy of $a_{nn}$, we must have $r=0$.
    Thus
    \begin{align*}
        \beta&=b_1\omega_1+\cdots+b_{n-1}\omega_{n-1}+qa_{nn}\omega_n & a_{nn}\omega_n&=\alpha_n+\gamma
    \end{align*}
    where $\gamma\in\spn_{\Z}\{\omega_1,\ldots,\omega_{n-1}\}$.
    Thus $b_1\omega_1+\cdots+b_{n-1}\omega_{n-1}+q\gamma=\beta-q\alpha_n\in I$.

    The proof follows by repeating the same argument with $\beta-q\alpha_n$.
\end{proof}
% \begin{corollary}
    % Suppose $I\subseteq\mathcal{O}_K$ is a non-zero ideal, $\{\omega_1,\ldots,\omega_n\}$, $\{\alpha_1,\ldots,\alpha_n\}$, $A$ as in \cref{t:id-basis}.
    % Then
    % \begin{equation*}
        % \quot{\mathcal{O}_K}{I}\cong \Z_{a_{11}}\times\cdots\times\Z_{a_{nn}}
    % \end{equation*}
% \end{corollary}
% \begin{proof}
    % Consider the map
    % \begin{equation*}
        % \phi(r_1\alpha_1+\cdots+r_n\alpha_n)=(r_1\pmod{a_{11}},\ldots,r_n\pmod{a_{nn}})
    % \end{equation*}
    % (TODO: is this true? try to show well-defined, surjective, $\ker(\phi)=I$.)
    % If true, fix $\cref{t:id-norm}$ to use this fact (the theorem follows immediately).
% \end{proof}
\begin{example}
    Consider $I=(7)\subseteq\Z[\sqrt{2}]$.
    An integral basis for $(7)$ is $\{7,7\sqrt{2}\}$ since $7,7\sqrt{2}\in I$ and every element of $I$ is of the form $7(a+b\sqrt{2})$ for some $a,b\in\Z$.
\end{example}
\begin{theorem}
    If $K$ is a number field, then $\mathcal{O}_K$ is a Dedekind domain.
\end{theorem}
\begin{proof}
    We verify the three requirements:
    \begin{enumerate}
        \item \textit{$\mathcal{O}_K$ is Noetherian.}
            Suppose $I\subseteq\mathcal{O}_K$.
            If $I=(0)$ we're done; otherwise, choose an integral basis $\{\alpha_1,\ldots,\alpha_n\}$ for $I$ and $I=(\alpha_1,\ldots,\alpha_n)$.
        \item \textit{Every non-zero prime ideal is maximal.}
            Let $0\neq P\subseteq\mathcal{O}_K$ be prime.
            It suffices to show that $\abs{\quot{\mathcal{O}_K}{P}}<\infty$ since finite integral domains are fields\footnote{Let $R$ be an integral domain and consider $\alpha:R\to R$ by $\alpha(x)=xr$.
                This is injective since $R$ is an integral domain and, since $R$ is finite, it is surjective as well.
            Thus there exists $s\in R$ with $rs=1$.}.

            Let $\{\omega_1,\ldots,\omega_n\}$ be an integral basis for $\mathcal{O}_K$.
            Then by \cref{p:id-scale}, there exists $a\in\Z^+\cap P$ so that $a\omega_i\in P$.
            Thus there are at most $a^n$ possible elements in $\quot{\mathcal{O}_K}{P}$.
        \item \textit{$\mathcal{O}_K$ is integrally closed in $K$.}
            Suppose $\gamma\in K$ is integral over $\mathcal{O}_K$, so that $\gamma^n+\alpha_{n-1}\gamma^{n-1}+\cdots+\alpha_1\gamma+\alpha_0=0$.
            Note that $\gamma\in\Z[\alpha_0,\alpha_1,\ldots,\alpha_{n-1},\gamma]=A$; it suffices to show that $A$ is finitely generated as an additive group by \cref{t:alg-int}.
            Since $A$ is generated over $\Z$ by all $\alpha_0^{m_0}\cdots\alpha_{n-1}^{m_{n-1}}\gamma^{m_n}$, let's show that only finitely many such products are necessary.
            Since $\alpha_i\in\mathcal{O}_K$, we can take $m_i<[K:\Q]$; and, since $\gamma^n$ is expressible as a product over the $\alpha_i$ from its minimal polynomial, we can take $m<n$.
    \end{enumerate}
    Thus $\mathcal{O}_K$ is a Dedekind domain.
\end{proof}
\section{Prime Factorization of Ideals}
\subsection{Unique Factorization}
\begin{lemma}\label{l:id-cont}
    Let $Q$ be a prime ideal in a ring $R$ such that $Q\supseteq J_1\cdots J_r$.
    Then $Q\supseteq J_i$ for some $i$.
\end{lemma}
\begin{proof}
    Suppose $J_1,\ldots,J_{r-1}\not\subset Q$.
    Thus get $j_i\in J_i$ for $i<r$ with $j_i\notin Q$.
    If $\alpha\in J_r$ arbitrary, then $j_1\cdots j_{r-1}\alpha\in q$ so by primality, $\alpha\in Q$ and $J_r\subseteq\alpha$.
\end{proof}
\begin{lemma}\label{l:prod-id}
    If $R$ is a Dedekind domain, then every non-zero ideal contains a product of prime ideals.
\end{lemma}
\begin{proof}
    Let $S$ be the set of non-zero ideals that don't contain a product of primes; suppose $S\neq\emptyset$.
    Since $R$ is Noetherian, by \cref{t:noe}, there exists $M\in S$ maximal.
    Since $M$ is not prime, get $r,s\in R\setminus M$ with $rs\in M$.
    But then $M_1:=M+(r)$ and $M_2:=M+(s)$ properly contain $M$ and are not in $S$, so $M_1$ and $M_2$ both contains products of primes.
    Furthermore, $M_1M_2\subseteq M$ so $M$ contains a product of prime ideals, forcing $S=\emptyset$.
\end{proof}
\begin{lemma}\label{l:id-frac}
    Let $R$ be a Dedekind domain, $I\subsetneq R$, and $K=\Frac(R)$.
    Then there exists $\gamma\in K\setminus R$ such that $\gamma I\subseteq\R$.
\end{lemma}
\begin{proof}
    This is obvious if $I=(0)$, so we may assume $I\neq(0)$ and let $0\neq a\in I$.
    Since $I\subsetneq R$, $a$ is not a unit, so $\frac{1}{a}\in K\setminus R$.
    By \cref{l:prod-id}, $(a)\supseteq P_1\cdots P_r$ where $P_i$ are prime ideals; we may take $r$ to be minimal.
    Let $M$ be a maximal ideal containing $I$, so $M\supseteq I\supseteq(a)\supseteq P_1\cdots P_r$, and since $M$ is maximal, $M$ is prime.

    Without loss of generality, $P_1\subseteq M$ by \cref{l:id-cont}; since $R$ is Dedekind, $M=P_1$.
    If $r=1$, set $b=1$; and if $r>1$, let $b\in P_2\cdots P_r$.
    Set $\gamma=\frac{b}{a}$ so that
    \begin{equation*}
        \gamma I=\frac{b}{a}I\subseteq\frac{b}{a}P_1\subseteq\frac{1}{a}P_1\cdots P_r\subseteq\frac{1}{a}(a)=R
    \end{equation*}
\end{proof}
\begin{proposition}\label{p:id-inv}
    Suppose $R$ is a Dedekind domain and $(0)\neq I\subseteq R$ is an ideal.
    Then for any $0\neq \alpha\in I$, there exists an ideal $J\subseteq R$ such that $IJ=(\alpha)$ is principal.
\end{proposition}
\begin{proof}
    Set $J=\{\beta\in R:\beta I\subseteq(\alpha)\}$\footnote{From commutative algebra, this is the \textbf{ideal quotient}, denoted $((\alpha):I)$.}.
    Certainly $IJ\subseteq(\alpha)$ by definition, so we need to show that $(\alpha)\subseteq IJ$.

    Let $B=\frac{1}{\alpha}IJ$.
    We know $B\subseteq R$ is an ideal, so we want to show that $B=R$.
    Suppose not.
    Then by \cref{l:id-frac}, get $\gamma\in \Frac(R)\setminus R$ such that $\gamma B\subseteq R$.
    Since $\alpha\in I$, $J\subseteq B$ and $\gamma J\subseteq\gamma B\subseteq R$.
    Then, $\gamma\frac{1}{\alpha} IJ=\gamma B\subseteq R$ which can be rephrased as $(\gamma J)I\subseteq(\alpha)$; thus, $\gamma J\subseteq J$ by definition of $J$.

    Now since $J$ has an integral basis, it is a finitely generated additive group.
    But then since $\gamma\in K\setminus R$, we cannot have $J\supseteq\gamma J\supseteq\gamma J^2\supseteq\cdots$.
    Thus in fact $B=R$ and the result follows.
\end{proof}
\begin{definition}
    If $A,B$ are ideals in $R$, we say that \mbf{$A$ divides $B$} and write $A\mid B$ if there exists an ideal $C$ such that $AC=B$.
\end{definition}
\begin{corollary}\label{cor:id-div}
    Let $A,B,C$ be ideals in a Dedekind domain, with $C\neq 0$.
    Then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $A\supseteq B$ if and only if $A\mid B$.
        \item If $AC=BC$, then $A=B$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    \begin{enumerate}[label=(\roman*)]
        \item If $A|B$, then get $C$ such that $B=AC\subseteq A$.
            Conversely, suppose $A\supseteq B$.
            This is clear if $A=(0)$; else, let $0\neq\alpha\in A$.
            Then by \cref{p:id-inv}, get $J$ such that $JA=(\alpha)$.
            Then $(\alpha)=JA\supseteq JB$, so $R\supseteq\frac{1}{\alpha}JB$.
            Let $C=\frac{1}{\alpha}JB$ so that $AC=\frac{1}{\alpha}AJB=B$.
        \item By \cref{p:id-inv}, get $I$ such that $CI=(\alpha)$.
            Then $(\alpha)A=ACI=BCI=(\alpha)B$, so $A=B$.
    \end{enumerate}
\end{proof}
\begin{theorem}
    In a Dedekind domain, every proper non-zero ideal factors uniquely into a product of prime ideals.
\end{theorem}
\begin{proof}
    Let $S$ be the set of non-zero proper ideals that cannot be written as a product of primes.
    If $S\neq\emptyset$, let $M\in S$ be a maximal.
    Since $M$ is not prime, so $M$ is not maximal: thus, let $P\supsetneq M$ be maximal.
    Since $M\subseteq P$, $P|M$ so there is an ideal $C$ such that $M=PC$; since $M\neq\rho$, $C\neq R$.
    $C$ cannot be a product of prime ideals, or $M$ is a product of prime ideals, so $C\in S$.
    But then by maximality of $M$, $M=C$ and $M=PC=PM$, so $P=R$, a contradiction.

    It remains to show unique factorization.
    Given $I\neq 0$, $R$, say $I=P_1\cdots P_r=Q_1\cdots Q_s$.
    Then $I\subseteq P_1$, so without loss of generality, $P_1\supseteq Q_1$ by \cref{l:id-cont}.
    Since prime ideals are maximal, this forces $P_1=Q_1$ so we can cancel to get $P_2\cdots P_r=Q_2\cdots Q_s$ and we are done by induction.
\end{proof}
\begin{example}
    Consider the ring $\Z[\sqrt{-5}]$, which does not have unique factorization: $6=2\cdot 4=(1+\sqrt{-5})(1-\sqrt{-5})$.
    In particular, this means that $(2)$ is not a prime ideal: $1+\sqrt{-5},1-\sqrt{-5}\notin(2)$, but $6\in(2)$.
    We do, however, still have unique factorization:
    \begin{align*}
        (2)&=(2,1+\sqrt{-5})(2,1-\sqrt{-5})\\
        (6)&=(2,1+\sqrt{-5})(2,1-\sqrt{-5})(3,1+\sqrt{5})(3,1-\sqrt{-5})
    \end{align*}
\end{example}
\begin{theorem}
    $R$ is a PID if and only if $R$ is a UFD and a Dedekind domain.
\end{theorem}
\begin{proof}
    \impr Since every PID is a UFD; it suffices to show that $R$ is also Dedekind.
    This is left as an assignment exercise.

    \impl Let $R$ be a UFD and a Dedekind domain.
    By unique factorization, it suffices to show that every non-zero prime ideal $P$ is principal.
    Let $0\neq\alpha\in P$; since $P$ is proper, $\alpha$ is not a unit.
    Since $R$ is a UFD, write $\alpha=p_1^{a_1}\cdots p_k^{a_k}$ with $k>0$.
    Since $P$ is prime, without loss of generality, $p_1\in P$.
    Then $(p_1)\subseteq P$ but $(p_1)$ is prime and thus maximal (since $R$ is Dedekind), so $P=(p_1)$ is principal.
\end{proof}
\begin{corollary}
    If $K$ is a number field, then $\mathcal{O}_K$ has unique factorization into primes if and only if $\mathcal{O}_K$ is a PID.
\end{corollary}
\begin{proof}
    This follows immediately since $\mathcal{O}_K$ is Dedekind.
\end{proof}
\begin{example}
    Consider $K=\Q(\sqrt{-d})$, for $d>0$.
    For $d=1,2$, $K$ is in fact a Euclidean domain; more generally, we may ask when $\mathcal{O}_K$ is a PID.
    It was conjectured (correctly) by Gauss that this is true when $d\in\{1,2,3,7,11,19,43,67,163\}$.
\end{example}
\subsection{Ramification}
Suppose $P\subseteq\mathcal{O}_K$ is a prime ideal and let $0\neq a\in P\cap\Z^+$.
Write $a=p_1^{e_1}\cdots p_r^{e_r}$, so by primality, some $p:=p_i\in P$.
Then $(p)\subseteq P$, so $P\mid(p)$; thus, $PQ_1\cdots Q_s=(p)$ for some prime ideals $Q_i$.
In particular, every prime ideal of $\mathcal{O}_K$ is a factor of $(p)$ for some $p\in\Z$.

Furthermore, $P$ cannot be a factor of $(p)$ and $(q)$ for distinct primes $p,q\in\Z$: otherwise, $p,q\in P$ so $1\in\rho$.
Thus $p\in \Z^+$ is the unique prime number such that $(p)\subseteq P$; in this case, we say that \mbf{$P$ lies over $p$}.
\begin{definition}
    Let $K$ be a number field, $p\in\Z^+$ a prime.
    We say \mbf{$p$ ramifies in $K$} if there exists some prime ideal $P\subseteq\mathcal{O}_K$ such that $P^2\mid(p)$ in $\mathcal{O}_K$.
\end{definition}
\begin{remark}
    By unique factorization into prime ideals, we can write $(p)=P_1^{e_1}\cdots P_r^{e_r}$.
    Then $p$ ramifies in $K$ if $e_i>1$ for some $i$.
    We say that $e_i$ is the \mbf{ramification index} for the prime $P_i$.

\end{remark}
We can interpret the idea of ramification in the sense of algebraic geometry.
First, let's consider a well-known example: consider the map $f:\C\to\C$ be given by $x\mapsto x^n$.
Then most points $z\in\C$ have $n$ distinct preimages - in fact, all of them except $z=0$.

In algebraic geometry, since $\mathcal{O}_K/\Z$ is an integral extension of rings, we consider $\pi:\Spec(\mathcal{O}_K)\to\Spec(\Z)$ given by $\rho\mapsto\rho\cap\Z$.
This is a surjective homeomorphism.
In general, if $R\subseteq S$ is integral and $R$ is Noetherian, then for any prime $P\subseteq R$, the set of primes $Q\subseteq S$ containing $P$ are precisely those given by $\pi^{-1}(P)$.
In the number field case, if $K/L$ is a finite field extension so that $\mathcal{O}_K\subseteq\mathcal{O}_L$; then $Q\subseteq\mathcal{O}_L$ lies over $P\subseteq\mathcal{O}_K$ precisely when $Q$ occurs in the prime factorization of $P\mathcal{O}_L$.
If we take $K=\Q$, then $\mathcal{O}_K=\Z$ and we consider prime ideals $(p)\subseteq\Z$.
As we will see shortly, for most points, $\pi^{-1}((p))$ consists of distinct prime factors; the question of checking if $p$ is ramified is searching for points where this is not true.
\begin{theorem}\label{t:id-ram}
    Let $D=\disc(K)$ and $p\in\Z^+$.
    Then $p$ is ramified if and only if $p\mid D$.
\end{theorem}
\begin{proof}
    \impr
    Get $P$ such that $P^2\mid(p)$; let $(p)=P^2Q$.
    Note that $PQ\neq  P^2Q$ since $P$ is proper; thus, let $\alpha\in PQ\setminus P^2Q$.
    In particular, $\frac{\alpha}{p}\notin\mathcal{O}_K$ but $\alpha^2\in P^2Q^2\subseteq (p)$ so $\frac{\alpha^2}{p}\in\mathcal{O}_K$.
    Thus if $\beta\in\mathcal{O}_K$ is arbitrary, then $\frac{(\alpha\beta)^p}{p}\in\mathcal{O}_K$.
    Note that $\Tr((\alpha\beta)^p)=p\Tr\left(\frac{(\alpha\beta)^p}{p}\right)$, so $p\div \Tr((\alpha\beta)^p)$ and
    \begin{align*}
        \Tr\left((\alpha\beta)^p\right) &=\left(\sum_{i=1}^n\sigma_i(\alpha\beta)\right)^p=\sum_{i=1}^n\sigma_i(\alpha\beta)^p+p\gamma= \Tr((\alpha\beta)^p)+p\gamma
    \end{align*}
    for some $\gamma\in\mathcal{O}_K$.
    Thus $p\mid\Tr(\alpha\beta)^p$, so $p\mid\Tr(\alpha\beta)$.

    Let $\{\omega_1,\ldots,\omega_n\}$ be an integral basis for $K$ so that $\alpha=a_1\omega_1+\cdots+a_n\omega_n$ for $a_i\in\Z$.
    Since $\frac{\alpha}{p}\notin\mathcal{O}_K$, without loss of generality, $p\nmid a_1$.
    Note that $p\mid\Tr(\alpha\omega_i)$ for any $i$ and
    \begin{equation*}
        \Tr(\alpha\omega_i)=\Tr((a_1\omega_1+\cdots+a_n\omega_n)\omega_i)=\sum_{j=1}^n a_j\Tr(\omega_j\omega_i)
    \end{equation*}
    Now,
    \begin{equation*}
        D=\disc(K)=\det
        \begin{pmatrix}
            \Tr(\omega_1\omega_1) &\cdots&\Tr(\omega_1\omega_n)\\
            \vdots&\ddots&\vdots\\
            \Tr(\omega_n\omega_1) &\cdots&\Tr(\omega_n\omega_n)
        \end{pmatrix}
    \end{equation*}
    so that by standard matrix manipulation preserving the determinant,
    \begin{align*}
        a_1D &=\det
        \begin{pmatrix}
            a_1\Tr(\omega_1\omega_1) &\cdots&a_1\Tr(\omega_1\omega_n)\\
            \Tr(\omega_2\omega_1) &\cdots&\Tr(\omega_2\omega_n)\\
            \vdots&\ddots&\vdots\\
            \Tr(\omega_n\omega_1) &\cdots&\Tr(\omega_n\omega_n)
        \end{pmatrix}
        =\det
        \begin{pmatrix}
            \sum_{i=1}^n a_i\Tr(\omega_i\omega_1) &\cdots & \sum_{i=1}^n\Tr(\omega_i\omega_n)\\
            \Tr(\omega_2\omega_1) &\cdots&\Tr(\omega_2\omega_n)\\
            \vdots&\ddots&\vdots\\
            \Tr(\omega_n\omega_1) &\cdots&\Tr(\omega_n\omega_n)
        \end{pmatrix}
    \end{align*}
    and $p\mid a_1D$.
    Since $p\nmid a_i$, $p\mid D$.

    \impl This implication is beyond the scope of this course.
\end{proof}
\begin{example}
    Consider $\Z[\sqrt{3}]=\mathcal{O}_K$.
    Since $\disc(K)=12$, we see that $(3)=(\sqrt{3})^2$ indeed ramifies.
\end{example}

\section{Norms of Ideals}
\begin{definition}
    Let $(0)\neq I\subseteq\mathcal{O}_K$.
    Then we define \mbf{norm} of $I$ to be $\left\lvert\quot{\mathcal{O}_K}{I}\right\rvert$, and write $N_{\Q}^K(I)$ or $N(I)$ or $\norm{I}$ when the context is clear.
\end{definition}
\begin{remark}
    Equivalently, $N(I)=[\mathcal{O}_K:I]$ since $I\subseteq\mathcal{O}_K$ is an additive subgroup.
\end{remark}
\begin{theorem}\label{t:id-norm}
    Let $K$ be a number field, $I\subseteq\mathcal{O}_K$ and let $\{\alpha_1,\ldots,\alpha_n\}$ be an integral basis for $I$.
    Then
    \begin{equation*}
        N(I)=\left\lvert\frac{\disc(\alpha_1,\ldots,\alpha_n)}{\disc(K)}\right\rvert^{1/2}
    \end{equation*}
\end{theorem}
\begin{proof}
    Let's first show that this quantity does not depend on the choice of integral basis.
    Suppose $\{\alpha_1,\ldots,\alpha_n\}$ and $\{\beta_1,\ldots,\beta_n\}$ are choices of integral bases for $I$.
    Then if $P$ is a change of basis, $P\in\GL_n(\Z)$, so $\det(P)=\pm 1$.

    It thus suffices to do this with the integral basis as in \cref{t:id-basis}.
    Fix $\{\omega_1,\ldots,\omega_n\}$ an integral basis for $\mathcal{O}_K$, and let
    \begin{align*}
        A&=
        \begin{pmatrix}
            a_{11}&0&\hdots&0\\
            a_{21}&a_{22}&\ddots&\vdots\\
            \vdots&\vdots&\ddots&0\\
            a_{n1}&a_{n2}&\hdots&a_{nn}
        \end{pmatrix}
        &
        \begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix}&=A\begin{pmatrix}\omega_1\\\vdots\\\omega_n\end{pmatrix}
    \end{align*}
    so that
    \begin{equation*}
        \disc(\alpha_1,\ldots,\alpha_n) = \det(A)^2\disc(\omega_1,\ldots,\omega_n)
    \end{equation*}
    Thus,
    \begin{equation*}
        \frac{\disc(\alpha_1,\ldots,\alpha_n)}{\disc(K)}=(a_{11}\cdots a_{nn})^2
    \end{equation*}
    Thus we need to show that $N(I)=\prod_{i=1}^n a_{ii}$.
    Let's show that every element of $\quot{\mathcal{O}_K}{I}$ has a unique representation as $r_1\omega_1+\cdots+r_n\omega_n$ where $0\leq r_i<a_{ii}$.

    First let $\gamma\in\mathcal{O}_K$ be arbitrary and write $\gamma=\sum_{i=1}^n b_i\omega_i$.
    \begin{itemize}[nl]
        \item Write $b_n=q_na_{nn}+r_n$, where $0\leq r_n<a_{nn}$ and set $\gamma_n=\gamma-q_n\alpha_n$.
        \item Let $c_{n-1}$ denote the coefficient of $\omega_{n-1}$ in $\gamma_n$, and write $c_{n-1}=q_{n-1}a_{n-1,n-1}+r_{n-1}$, and set $\gamma_{n-1}=\gamma_n-q_{n-1}\alpha_{n-1}$.
    \end{itemize}
    Repeating the above process, we note that
    \begin{equation*}
        r_1\omega_1+\cdots+r_n\omega_n = \gamma-\left(q_1\alpha_1+\cdots+q_n\alpha_n\right)
    \end{equation*}
    and since $\sum_{i=1}^n q_i\alpha_i\in I$, $\gamma$ has a representation in the desired form.

    Furthermore, such a representation is unique: suppose
    \begin{equation*}
        r_1\omega_1+\cdots+r_n\omega_n\equiv s_1\omega_1+\cdots+s_n\omega_n\pmod{I}
    \end{equation*}
    where $r_i,s_i<a_{ii}$.
    Then since $\{\alpha_1,\ldots,\alpha_n\}$ is an integral basis for $I$, we have
    \begin{align*}
        \sum_{i=1}^n(r_i-s_i)\omega_i = \sum_{i=1}^n t_i\alpha_i = 
        \begin{pmatrix}
            t_1a_{11}&0&\hdots&0\\
            t_2a_{21}&t_2a_{22}&\ddots&\vdots\\
            \vdots&\vdots&\ddots&0\\
            t_na_{n1}&t_na_{n2}&\hdots&t_na_{nn}
        \end{pmatrix}\cdot
        \begin{pmatrix}
            \omega_1\\\vdots\\\omega_n
        \end{pmatrix}
    \end{align*}
    But then comparing coefficients starting at the last row, since $|r_i-s_i|<a_{ii}$, we have $t_n=\cdots=t_1=0$ so that $r_i=s_i$ for all $i$.
\end{proof}
\begin{corollary}
    Let $K$ be a number field, $I=(\alpha)$.
    Then $N(I)=|N(\alpha)|$.
\end{corollary}
\begin{proof}
    Let $\{\omega_1,\ldots,\omega_n\}$ be a basis for $\mathcal{O}_K$ so that $\{\alpha\omega_1,\ldots,\alpha\omega_n\}$ is a basis for $I$.
    Let $\sigma_1,\ldots,\sigma_n$ be the embeddings of $K\hto\C$.
    Then
    \begin{equation*}
        \begin{pmatrix}
            \sigma_1(\alpha\omega_1) &\hdots&\sigma_1(\alpha\omega_n)\\
            \vdots&\ddots&\vdots\\
            \sigma_n(\alpha\omega_1) &\hdots&\sigma_n(\alpha\omega_n)
        \end{pmatrix}
        =
        \begin{pmatrix}
            \sigma_1(\alpha) &&\\
                             &\ddots&\\
                             &&\sigma_n(\alpha)
        \end{pmatrix}
        \begin{pmatrix}
            \sigma_1(\omega_1) &\hdots&\sigma_1(\omega_n)\\
            \vdots&\ddots&\vdots\\
            \sigma_n(\omega_1) &\hdots&\sigma_n(\omega_n)
        \end{pmatrix}
    \end{equation*}
    so that $\disc(\alpha\omega_1,\ldots,\alpha\omega_n)=N(\alpha)^2\disc(\omega_1,\ldots,\omega_n)$.
    Then $N(I)=|N(\alpha)|$ by \cref{t:id-norm}.
\end{proof}
\begin{remark}
    In the sense of the previous two propositions, we see that $N(I)$ is a generalization of norms of elements.
\end{remark}
\begin{theorem}[Fermat]
    Let $K$ be a number field, $P\subseteq\mathcal{O}_K$ a prime ideal, $\alpha\in\mathcal{O}_K$, and $P\nmid(\alpha)$.
    Then $\alpha^{N(p)-1}\equiv 1\pmod{P}$.
\end{theorem}
\begin{proof}
    Since $\quot{\mathcal{O}_K}{P}$ is a field, so $(\quot{\mathcal{O}_K}{P})^\times$ is a group with size $N(P)-1$.
    Then $P\nmid(\alpha)$ if and only if $\alpha\notin\rho$ and the result follows by Lagrange's theorem.
\end{proof}
\begin{proposition}\label{p:norm-in-id}
    If $I\subseteq\mathcal{O}_K$ is an ideal, then $N(I)\in I$.
\end{proposition}
\begin{proof}
    Consider the element $1+I\in\quot{\mathcal{O}_K}{I}$.
    Since $\abs{\quot{\mathcal{O}_K}{I}}=N(I)$, by Lagrange, $N(I)(1+I)=N(I)+I=0$, so $N(I)\in I$.
\end{proof}
\begin{corollary}\label{cor:fin-norm}
    If $K$ is a number field and $a\in\Z^+$, then there are only finitely many ideals $I\subseteq\mathcal{O}_K$ with $N(I)=a$.
\end{corollary}
\begin{proof}
    If $I\subseteq\mathcal{O}_K$ is an ideal and $N(I)=a$, then $a\in I$.
    Thus $(a)\subseteq I$ so $I\mid (a)$; since we have unique factorization of ideals, there are only finitely many such $I$.
\end{proof}
\begin{example}
    Which $I\subseteq\Z[i]$ have norm 5?
    Note that $5=(1+2i)(1-2i)$ is a factorization into primes, since if $N(I)=5$, then $I=(1+2i)^a(1-2i)^b$ for $a,b\in\{0,1\}$.
    Thus one can verify $N(I)=5$ if and only if $I=(1+2i)$ or $I=(1-2i)$.
\end{example}
\subsection{The Ideal Norm is Multiplicative}
\begin{definition}
    If $B,C\subseteq\mathcal{O}_K$ are ideals, we say $D\subseteq\mathcal{O}_K$ is the \mbf{gcd of $B,C$} if $D\mid B$, $D\mid C$ and, whenever $E|B$ and $E|C$, we have $E\mid D$.
    We also say $L=\subseteq\mathcal{O}_K$ is the \mbf{lcm of $B,C$} if $B\mid L$, $C\mid L$, and $L$ is minimal with this property.
\end{definition}
\begin{remark}
    One can see that the gcd and lcm both exist and are unique by factorization of ideals into primes.
    Alternatively, in light of \cref{cor:id-div}, $\gcd(I,J)=I+J$ is the smallest ideal containing both $I$ and $J$, and $\lcm(I,J)=I\cap J$ is the smallest ideal contained in $I$ and $J$.
\end{remark}
\begin{lemma}\label{l:gcd-pr}
    Suppose $B,C\subseteq\mathcal{O}_K$ are non-zero ideals.
    Then there exists $\alpha\in B$ such that $\gcd\left(\frac{(\alpha)}{B},C\right)=1$.
\end{lemma}
\begin{remark}
    This makes sense since if $\alpha\in B$, then $(\alpha)\subseteq B$ and $B\mid (\alpha)$.
\end{remark}
\begin{proof}
    If $C=\mathcal{O}_K$, choose any $\alpha\in B$.
    Otherwise, write $C=\prod_{i=1}^r P_i^{e_i}$ as a product of prime ideals.
    If $r=1$, then $C=P^e$.
    Let $\alpha\in B\setminus BP$ be arbitrary, so that
    \begin{align*}
        \gcd\left(\frac{(\alpha)}{B},P^e\right)=P^m
    \end{align*}
    Suppose for contradiction $m\geq 1$; then, $P\div\frac{(\alpha)}{B}$ so $(\alpha)=B\frac{(\alpha)}{B}=BP E\subseteq BP$ so that $\alpha\in BP$, a contradiction.

    Now suppose $r>1$; then by the $r=1$ case for any $m\in\{1,\ldots,r\}$, set
    \begin{align*}
        B_m:&=B\frac{P_1\cdots P_r}{P_m} & \alpha_m \in B_m &\quad\text{s.t.}\quad\gcd\left(\frac{(\alpha_m)}{B_m},P_m\right)=1 & \alpha=\sum_{i=1}^r\alpha_i
    \end{align*}
    In particular, since $B\supseteq B_i$, $\alpha_i\in B$ for any $i$ so that $\alpha\in B$.
    Furthermore, for $i\neq m$, $\alpha_i\in B_i\subseteq BP_m$.

    Let's show that $\alpha\notin BP_m$ for any $m$.
    If $\alpha\in BP_m$, then since $\alpha_i\in BP_m$ for $i\neq m$, we have $\alpha_m\in BP_m$.
    Thus $BP_m\div(\alpha_m)$ and $B_m\div(\alpha_m)$ by assumption so that $P_m\div\frac{(\alpha_m)}{B}$ and $\frac{P_1\cdots P_r}{P_m}\div\frac{(\alpha_m)}{B}$.
    Thus $BP_1\cdots P_r\div(\alpha_m)$.
    But then since $\frac{BP_1\cdots P_r}{B_m}=P_m$, $P_m\div\frac{(\alpha)}{B_m}$, contradicting the choice of $\alpha_m$.

    Now suppose $\gcd\left(\frac{(\alpha)}{B},C\right)\neq 1$.
    Then there exists $m$ such that $P_m\div\frac{(\alpha)}{B}$, so $BP_m\mid(\alpha)$ and $\alpha\in BP_m$, a contradiction.
    Thus the result follows.
\end{proof}
\begin{lemma}\label{l:gcd-cp}
    Suppose $B,C\subseteq\mathcal{O}_K$ are non-zero ideals.
    If $\alpha\beta\equiv 0\pmod{BC}$ and $\gcd\left(\frac{(\alpha)}{B},C\right)=1$, then $\beta\equiv 0\pmod{C}$.
\end{lemma}
\begin{proof}
    Since $\alpha\beta\in BC$, $BC\div(\alpha)(\beta)$ so that $C\div\frac{(\alpha)}{B}(\beta)$.
    Since $\gcd\left(\frac{(\alpha)}{B},C\right)=1$, we have $C\mid(\beta)$ so $\beta\in C$.
\end{proof}
\begin{theorem}
    If $B,C\subseteq\mathcal{O}_K$ are non-zero ideals, then $N(BC)=N(B)N(C)$.
\end{theorem}
\begin{proof}
    By \cref{l:gcd-pr}, get $\alpha\in B$ such that $\gcd\left(\frac{(\alpha)}{B},C\right)=1$.
    Let $\beta_1,\ldots,\beta_{N(B)}\in\mathcal{O}_K$ and $\gamma_1,\ldots,\gamma_{N(C)}\in\mathcal{O}_K$ represent the distinct classes in $\quot{\mathcal{O}_K}{B}$and $\quot{\mathcal{O}_K}{C}$ respectively.
    Let's show that $\beta_i+\alpha\gamma_j$ represent the distinct classes in $\quot{\mathcal{O}_K}{BC}$, which would give the result $N(BC)=N(B)N(C)$.

    Let's first see that $\beta_i+\alpha\gamma_j$ are distinct mod $BC$ and suppose
    \begin{align*}
        \beta_i+\alpha\gamma_j \equiv\beta_k+\alpha\gamma_l\pmod{BC}&\iff \beta_i-\beta_k \equiv\alpha(\gamma_l-\gamma_i)\pmod{BC}
    \end{align*}
    Thus since $BC\subseteq B$, the congruence also holds mod $B$.
    Then since $\alpha\in B$, $\beta_i-\beta_k\equiv 0\pmod{B}$ and $i=k$.
    As a result, $0\equiv\alpha(\gamma_l-\gamma_j)\pmod{BC}$, so by \cref{l:gcd-cp}, $\gamma_l-\gamma_j\equiv 0\pmod{C}$ and $j=l$.

    Next, we need to show if $\omega\in\mathcal{O}_K$, then there exists $i,j$ such that $\omega\equiv\beta_i+\alpha\gamma_j\pmod{BC}$.
    Let $i$ be such that $\omega\equiv\beta_i\pmod{B}$.
    Then $\omega-\beta_i\in B=\gcd((\alpha),BC)=(\alpha)+BC$ so that $\omega-\beta_i=\alpha a+b$ for some $a\in\mathcal{O}_K$ and $b\in BC$.
    Let $j$ be such that $a\equiv\gamma_j\pmod{C}$.
    Then
    \begin{equation*}
        \omega=\beta_i+\alpha\gamma_j+\alpha(a-\gamma_j)+b
    \end{equation*}
    with $\alpha\in B$, $a-\gamma_j\in C$.
    Then $\alpha(a-\gamma_j)\in BC$ and $b\in BC$, so $\omega=\beta_i+\alpha\gamma_j\pmod{BC}$.
\end{proof}
\begin{remark}
    Note that $N(I)=1$ if and only if $I=\mathcal{O}_K$.
    If $[K:\Q]=n$ and $P$ is a prime ideal, we already showed $P\mid(p)$ for some prime $p\in\Z$.
    Factor $(p)=PJ$ and since the norm is multiplicative, $N((p))=N(P)N(J)$ so $N(P)=p^f$ for some $1\leq f\leq n$.
    We write $f(P|p):=f$.
    If $N(I)$ is prime, then $I$ is a prime ideal (though the converse is not true!)
\end{remark}
\section{Class Group}
Fix $\mathcal{O}_K$ and let $I,J\subseteq\mathcal{O}_K$ be ideals.
Define an equivalence relation $\sim$ on the set of ideals of $\mathcal{O}_K$ by $I\sim J$ if there exists $\alpha,\beta\in\mathcal{O}_K$ such that $(\alpha)I=(\beta)J$.
One can verify that this is indeed an equivalence relation.
\begin{definition}
    The \mbf{class group of $K$} is $\Cl(\mathcal{O}_K)$ is the set of ideals modulo the above equivalence relation, where the group operation is multiplication of ideals.
    We define the \mbf{class number} $h_K:=|\Cl(\mathcal{O}_K)|$.
\end{definition}
\begin{theorem}\label{t:ck}
    If $K$ is a number field, then there exists a constant $C_K$ such that for all $0\neq A\subseteq\mathcal{O}_K$ ideal, there exists $\alpha\in A$ such that $|N(\alpha)|\leq C_K N(A)$.
\end{theorem}
\begin{proof}
    Let $\{\omega_1,\ldots,\omega_n\}$ be an integral basis for $\mathcal{O}_K$ and let $t:=\lfloor N(A)^{1/m}\rfloor$.
    Consider all elements of $\mathcal{O}_K$ of the form $c_1\omega_1+\cdots+c_n\omega_n$ where $0\leq c_i\leq t$.
    There are $(t+1)^n$ such elements where $(t+1)^n>N(A)$; thus, by the pidgeonhole principle, there exists some $\beta_1\neq\beta_2$ so that $\beta_1\equiv\beta_2\pmod{A}$.
    Set $\alpha=\beta_1-\beta_1\in A$; then, $\alpha=t_1\omega_1+\cdots+t_n\omega_n$ with $|t_i|\leq t$.
    Then
    \begin{align*}
        |N(\alpha)| &= \left\lvert\prod_{j=1}^n\sigma_j(\alpha)\right\rvert= \left\lvert\prod_{j=1}^nt_1\sigma_j(\omega_1)+\cdots+t_n\sigma_j(\omega_n)\right\rvert\\
                    &\leq \prod_{j=1}^n\left(|t_1|\cdot|\sigma_j(\omega_1)|+\cdots+|t_n|\cdot|\sigma_j(\omega_n)|\right)\\
                    &\leq t^n\prod_{j=1}^n(|\sigma_j(\omega_1)|+\cdots+|\sigma_j(\omega_n)|)<N(A)C_K
    \end{align*}
    where $C_K=\prod_{j=1}^n\left(\sum_{j=1}^n|\sigma_j(\omega_i)|\right)$ depends only on $K$.
\end{proof}
\begin{remark}
    This bound is not very good; we will later show that much better bounds are indeed possible.
\end{remark}
\begin{theorem}\label{t:cl-bound}
    If $K$ is a number field, then the class number $h_K<\infty$.
\end{theorem}
\begin{proof}
    By \cref{cor:fin-norm}, it suffices to show that that every ideal class contains an ideal with norm at most $C_K$.

    Let $0\neq I\subseteq\mathcal{O}_K$; then, get $0\neq A$ such that $IA$ is principal.
    By \cref{t:ck}, there exists $0\neq\alpha\in A$ such that $|N((\alpha))|\leq C_KN(A)$.
    Since $\alpha\in A$, it follows that $(\alpha)\subseteq A$, so $(\alpha)=AB$ for some $B$.
    Thus, in the class group $\Cl(\mathcal{O}_K)$, we have $A=I^{-1}$ and $B=A^{-1}$, so $B=I$ in $\Cl(\mathcal{O}_K)$.
    Since $AB=(\alpha)$, $N(A)N(B)\leq C_KN(A)$, so $N(B)\leq C_K$.
    In other words, $B$ and $I$ are in the same class and $N(B)\leq C_K$.
\end{proof}
\subsection{Computing an ideal class group}
Last time, we showed every ideal class has a representation of norm at most $C_K$; this yields a general procedure for computing the class group, assuming we have a bound $M$ of $C_K$.
\begin{enumerate}[nl]
    \item Take a bound $M$ for $C_K$; for example, we may take $M=\sqrt{|\disc(K)|}$.
    \item From the proof of \cref{t:cl-bound}, it suffices to consider ideals with norm at most $M$.
        Since $I=\prod P_i^{e_i}$ is a factorization, the primes $P$ with $N(P)\leq M$ will generate $\Cl(\mathcal{O}_K)$.
    \item Since $N(P)\in P$ by \cref{p:norm-in-id}, $P$ lies over a prime $p$ with $p\leq M$.
        Thus $P\subseteq (p)$, so every such prime will arise as a factor of $(p)$ with $p\leq C_K$.
\end{enumerate}
\begin{example}
    Consider $\Cl(\Q(\sqrt{-23}))$, so $C_K=\sqrt{23}<5$.
    Thus we need ideals with norm a most 4, so it suffices to consider $(2),(3)$.
    From a homework assignment, we know that
    \begin{align*}
        (2)&=\underbrace{\left(2,\frac{1+\sqrt{-23}}{2}\right)}_{P}\underbrace{\left(2,\frac{1-\sqrt{-23}}{2}\right)}_{P'}\\
        (3)&=\underbrace{\left(3,\frac{1-\sqrt{-23}}{2}\right)}_{Q}\underbrace{\left(3,\frac{1+\sqrt{-23}}{2}\right)}_{Q'}
    \end{align*}
    is a factorization into primes, so that all the ideals of norm at most 4 are products of the above primes.
    We will write  $I\sim J$ if $I=J$ in $\Cl(K)$.
    Note that $PP'\sim(2)$ so that $P'=P^{-1}$; similarly, $Q'=Q^{-1}$.
    Furthermore, one can verify that
    \begin{equation*}
        PQ=\left(6,2\frac{1-\sqrt{-23}}{2},3\left(\frac{1-\sqrt{-23}}{2}\right),\left(\frac{1-\sqrt{-23}}{2}\right)^2\right)=(6)
    \end{equation*}
    so $P=Q^{-1}$ and $Q\sim P'$.
    An analoguous computation shows $P'Q'\sim(1)$ so $Q'\sim P$.
    We now have
    \begin{equation*}
        N\left(\frac{3+\sqrt{-23}}{2}\right)=8=N\left(\frac{3-\sqrt{-23}}{2}\right)
    \end{equation*}
    and these two ideals are distinct.
    Since $p$ is not principal b/c there is no principal ideal of norm 2.
    Similarly, $p'$ is not principal.
    Since we know there are at last two distinct principal ideals of norm 8, we must have $p,p'$ not principal.
    Thus $p^3,p'^3$ are not principal, so $p^3\sim 1$ and $p$ has order 3 in $\Cl(K)$.
\end{example}

\chapter{Topics in Number Theory}
\section{Quadratic Reciprocity}
Suppose we wish to solve the equation $x^2+bx+c$ in $\F_p$.
After completing the square, this reduces to the question of solving $x^2=a\pmod{p}$.
Is there a nice way to determine when $a$ is a square mod $p$?
\begin{definition}
    We define the \mbf{Legendre symbol} by
    \begin{equation*}
        \lgs{a}{p}=\begin{cases}1&\text{$a$ is a square in $\F_p$}\\-1&:\text{otherwise}\end{cases}
    \end{equation*}
\end{definition}
Let $H_p$ be the set of squares in $(\Z_p)^\times$.
On a homework assignment, we showed that $[(\Z_p)^\times:H_p]=2$; in particular, $\quot{(\Z_p)^\times}{H_p}\cong\Z_2$.
In particular, if $a,b$ are not squares, then $ab$ is a square; if $a$ is not square and $b$ is square, then $ab$ is not square.
This observation is the fact that
\begin{equation*}
    \lgs{ab}{p}=\lgs{a}{p}\lgs{b}{p}
\end{equation*}
Said another way, the map $\phi:(\Z_p)^\times\to\Z_2$ with $a\mapsto\lgs{a}{p}$ is a homomorphism with $\ker\phi=H_p$.

More generally, since $(\Z_p)^\times$ is cyclic, let $\alpha\in(\Z_p)^\times$ be a generator.
Then the map $\theta(\Z_p)^\times\to\Z_{p-1}$ given by $\alpha^k\mapsto k$ is a group isomorphism.
To summarize, the following diagram commutes
\begin{center}
    \begin{tikzcd}
        (\Z_p)^\times\arrow[r,"x\mapsto x^2"]\arrow[d,"\theta"]& H_p\arrow[d,"\theta|_{H_p}"]\\
        \Z_{p-1}\arrow[r,"x\mapsto 2x"]&2\Z_{p-1}
    \end{tikzcd}
\end{center}
Thus $2\Z_{p-1}=\ker(\psi)$ where $\psi:\Z_{p-1}\to\Z_2$ is the map $a\mapsto a\cdot(p-1)/2$; this map lifts to a map $\phi^*:H_p\to\{-1,1\}$.
In particular, taking $a=-1$, we have that
\begin{equation*}
    \lgs{-1}{p}=
    \begin{cases}
        1&p\nequiv 3\pmod{4}\\
        -1&p\equiv 3\pmod{4}
    \end{cases}
\end{equation*}
Let's record this as a proposition:
\begin{proposition}\label{p:lgs-1}
    Let $p$ be prime.
    \begin{enumerate}[r]
        \item $\displaystyle\lgs{-1}{p}=
                \begin{cases}
                    1&p\nequiv 3\pmod{4}\\
                    -1&p\equiv 3\pmod{4}
                \end{cases}$
        \item $\displaystyle \lgs{ab}{p}=\lgs{a}{p}\lgs{b}{p}$
    \end{enumerate}
\end{proposition}
Let's view $(\Z_p)^\times\cong\Gal(\Q(\zeta_p)/\Q)$.
Let $p^*=(-1)^{\frac{p-1}{2}}p$, $H_p$ denote the squares in $(\Z_p)^\times$, and $K_p=\Q(\sqrt{p^*})$.
Then $\Q(\zeta_p)^{H_p}= K_p$ and $H_p=\Gal(\Q(\zeta_p)/K_p)$ by the fundamental theorem of Galois theory \cref{t:ftgt}.
In particular,
\begin{equation}
    \lgs{q}{p}=1 \iff q\in H_p\iff \sigma_q\text{ fixes }K_p\iff \quot{\mathcal{O}_K}{P}=\F_q\label{eq:f}
\end{equation}

Given $a\in(\Z_p)^\times$, let $\sigma_a$ denote the Galois group element $\sigma_a:\zeta_p\mapsto\zeta_p^a$.
Let $Q$ denote any ideal of $\Z[\zeta_p]$ lying over $q$, so $\sigma_q$ acts on $\quot{\Z[\zeta_p]}{Q}$ by
\begin{align*}
    \sigma_q\left(\sum_{i=0}^{p-1} a_i\zeta_p^i\right)=\sum_{i=0}^{p-1}a_i\zeta_p^{qi}= \left(\sum_{i=0}^{p-1}a_i\zeta^i\right)^q
\end{align*}
since $\quot{\Z[\zeta_p]}{Q}$ has characteristic $q$.
Thus for all $\alpha\in\quot{\Z[\zeta_p]}{Q}$, $\sigma_q(\alpha)=\alpha^q$.
We say that $\sigma_q$ is the \textbf{Frobenius map} associated to $q$, and write $\sigma_q=\Frob_q\in\Gal(\Q(\zeta_p)/\Q)$.
The reasoning behind this name is that $\quot{\Z[\zeta_p]}{Q}/\quot{\Z}{(p)}=\F_p$, so $\quot{\Z[\zeta_p]}{Q}$ is a an extension of finite fields, and the map $\sigma_q$ induces the Frobenius map on this extension.

In particular, since $K_p/\Q$ is also Galois, $\sigma_q=\Frob_q$ in $\Gal(K_p/\Q)$ as well.
One can show that $\Frob_q$ is the unique map up to conjugacy since the Galois group acts transitively on the primes lying over $p$.

Now let $P\subseteq\mathcal{O}_{K_p}$; note that $\sigma_q=\id|_{\Gal(K_p/\Q)}$ if and only if $\quot{\mathcal{O}_K}{P}=\F_q$.
From a homework assignment, this happens if and only if $(q)\subseteq K_p$ is not prime.
Thus combining with \cref{eq:f}, we have that
\begin{equation*}
    \lgs{q}{p}=1 \iff (q)\text{ is not prime in }\Q(\sqrt{p^*}) \iff \lgs{p^*}{q}=1
\end{equation*}
Thus we have proven
\begin{theorem}[Quadratic Reciprocity]
    Let $p,q$ be distinct primes.
    Then
    \begin{equation*}
        \lgs{q}{p}=\lgs{p^*}{q}\text{ or equivalently } \lgs{p^*}{q}=(-1)^{\frac{p-1}{2}\cdot\frac{q-1}{2}}\lgs{p}{q}
    \end{equation*}
\end{theorem}
\begin{example}
    A good way to illustrate the computational power of quadratic reciprocity is through an example:
    \begin{align*}
        \lgs{17}{113} &= \lgs{113}{17}= \lgs{11}{17}= \lgs{17}{11}\\
                      &=\lgs{6}{11}= \lgs{2}{11}\lgs{3}{11}\\
                      &= -\lgs{11}{3}=-\lgs{-1}{3}=1
    \end{align*}
\end{example}
\begin{remark}
    Let $G=\Gal(\Q(\zeta_p)/\Q)\cong(\Z_p)^\times$.
    If $q$ is prime, we say $\sigma\in G$ is $\Frob_q$ if, given $Q$ lying over $q$, $\sigma(\alpha)=\alpha^q\pmod{Q}$.
    Which elements of $G$ are of the form $\Frob_q$ for some $q$?

    The perhaps surprising answer is that for every $a$, this happens infinitely often.
    In fact, this is a way of rephrasing Dirichlet's theorem for primes in arithmetic progressions.

    This fact generalizes to all Galois groups, and is called the Chebotarev density theorem.
    One consequence: if $K$ is a number field, then $\{p\in\Z:p\text{ splits completely in }\mathcal{O}_K\}$.
\end{remark}
\section{Fermat's Last Theorem}
\begin{theorem}[Fermat's Last]
    If $p\geq 3$ is prime and $p\nmid x,y,z$ for $x,y,z,\in\Z\setminus\{0\}$, then $x^p+y^p\neq z^p$.
\end{theorem}
\begin{definition}
    We say that $p$ is \textbf{regular} if $p\nmid h_{\Q(\zeta_p)}$.
\end{definition}
The goal of this section is to prove Fermat's last theorem for regular primes.
The key observation is that if $p$ is a regular prime, if $I\subseteq\mathcal{O}_{\Q(\zeta_p)}$ is ideal with $I^p$ is principal, then $I$ is principal as well.
\begin{theorem}[Hilbert Class Field]
    Let $K$ be a number field; then there exists a number field $L$ such that $L/K$ is normal and $\Gal(L/K)=\Cl(\mathcal{O}_K)$.
    Such an $L$ is called the \textbf{Hilbert class field}.
\end{theorem}
In particular, this has the property that for every ideal $I\subseteq\mathcal{O}_K$, $I\mathcal{O}_L$ is principal in $\mathcal{O}_L$.
\begin{definition}
    We say $p$ is a \mbf{regular prime} if $p\nmid h_{\Q(\zeta_p)}$.
\end{definition}
\begin{lemma}\label{l:km}
    Let $\zeta=\zeta_p$.
    Then in $\Z[\zeta]$,
    \begin{enumerate}[nl,r]
        \item the elements $1-\zeta,1-\zeta^2,\ldots,1-\zeta^{p-1}$ are associates.
        \item $1+\zeta$ is a unit
        \item There exists $u\in\Z[\zeta]^\times$ so that $p=u(1-\zeta)^{p-1}$ so that $(1-\zeta)$ is the only prime ideal dividing $(p)$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[r]
        \item Consider $\frac{1-\zeta^j}{1-\zeta}=1+\zeta+\cdots+\zeta^{j-1}\in\Z[\zeta]$.
            As well, $\frac{1-\zeta}{1-\zeta^j}=\frac{1-\zeta^{jk}}{1-\zeta^j}\in\Z[\zeta]$ where $jk\equiv 1\pmod{p}$.
            Thus $1-\zeta,\ldots,1-\zeta^p$ are associates.
        \item We have $1+\zeta=\frac{1-\zeta^2}{1-\zeta}$, so $1+\zeta$ is a unit.
        \item Recall that
            \begin{equation*}
                1+x+\cdots+x^{p-1}=\prod_{j=1}^{p-1}(x-\zeta^j)
            \end{equation*}
            so
            \begin{equation*}
                p=\prod_{j=1}^{p-1}(1-\zeta^j)=(1-\zeta)^{p-1}\prod_{j=1}^{p-1}\frac{1-\zeta^j}{1-\zeta}=u(1-\zeta)^{p-1}
            \end{equation*}
            where $u=\prod_{j=1}^{p-1}\frac{1-\zeta^j}{1-\zeta}\in\Z[\zeta]^\times$ from (i).
    \end{enumerate}
\end{proof}
\begin{lemma}\label{l:km2}
    If $u\in\Z[\zeta]^\times$, then $\frac{u}{\ol{u}}$ is a root of unity.
\end{lemma}
\begin{proof}
    Let $\sigma\in\Gal(\Q(\zeta)/\Q)$.
    Then $\sigma(\zeta)=\zeta^a$ for some $a$, so $\ol{\sigma(\zeta)}=\zeta^{-a}=\sigma(\ol{\zeta})$.
    Thus for any such $\sigma$,
    \begin{equation*}
        \left\lvert\sigma\left(\frac{u}{\ol{u}}\right)\right\rvert^2=\sigma\left(\frac{u}{\ol{u}}\right)\ol{\sigma\left(\frac{u}{\ol{u}}\right)}=1
    \end{equation*}
    so all the conjugates of $\frac{u}{\ol{u}}$ have complex norm 1.
    One can show that if $\alpha$ is an algebraic integer and all its conjugates have norm 1, then $\alpha$ is a root of unity.
\end{proof}
\begin{theorem}[Kummer]
    If $p\geq 3$ is a regular prime and $p\nmid x,y,z$ for $x,y,z,\in\Z\setminus\{0\}$, then $x^p+y^p\neq z^p$.
\end{theorem}
\begin{proof}
    Recall from a homework that the roots of unity in $\Z[\zeta_p]$ are $\pm\zeta^j$.
    In $\Z[\zeta]$, $z^p=x^p+y^p=\prod_{j=0}^{p-1}(x+\zeta^jy)$.

    Let's show that the ideals $(x+\zeta^jy)$ are relatively prime.
    To the contrary, suppose $\rho$ is a common prime factor of $(x+\zeta^j)$ and $(x+\zeta^{j'}y)$.
    In particular, $\rho$ is a prime factor of
    \begin{equation*}
        (x+\zeta^jy)-(x+\zeta^{j'}y)=\left(\zeta^jy(1-\zeta^{j'-j})\right)=(y(1-\zeta))
    \end{equation*}
    and $(y(1-\zeta))\div(yp)$ from (iii) in \cref{l:km}.
    Thus, $\rho\div(yp)$; but also, $\rho\div(z^p)$, a contradiction since $(z^p)$, $(yp)$ are coprime.

    Since the $(x+y\zeta^j)$ are coprime and $\prod_{j=0}^{p-1}(x+y\zeta^j)=(z^p)$ is a $p^\text{th}$ power, we must have each $(x+y\zeta^j)=I_j^p$.
    Since $p\nmid h_{\Q(\zeta)}$ and $I_j^p$ is trivial in $\Cl(\Q(\zeta))$, we have that $I_j$ is a principal.

    Fix $j=1$, and we have $(x+\zeta y)=(t)^p$ so that for some $t\in\Z[\zeta]$ and $u\in\Z[\zeta]^\times$, $x+\zeta y=ut^p$.
    Write $t=b_0+b_1\zeta+\cdots+b_{p-2}\zeta^{p-2}$; then modulo $(p)$, we have $t^p\equiv b_0+b_1+\cdots+b_{p-2}\pmod{p}$.
    But then $\ol{t}=b_0+\cdots+b_{p-2}\zeta^{-1}$, so $\ol{t}^p\equiv b_0+\cdots+b_{p-2}\pmod{p}$ and $t^p\equiv \ol{t}^p\pmod{p}$.
    From \cref{l:km2}, we have that $\frac{u}{\ol{u}}=\pm\zeta^j$ for some $j$.
    Let's treat the case $\pm\zeta^j=\zeta^j$, so that
    \begin{equation*}
        x+y\zeta=ut^p=\zeta^j\ol{u}t^p\equiv\zeta^j\ol{u}\ol{t}^p=\zeta^j(x+\ol{\zeta}y)
    \end{equation*}
    and
    \begin{equation}
        x+y\zeta-y\zeta^{j-1}-x\zeta^j\equiv 0\pmod{p}\label{e:km}
    \end{equation}
    But now,
    \begin{align*}
        \quot{\Z[\zeta]}{(p)} &= \quot{\Z[x]}{(p,x^{p-1}+\cdots+x+1)}\\
                              &= \quot{F_p[x]}{(x^{p-1}+\cdots+x+1)}=\quot{\F_p[x]}{(x-1)^{p-1}}
    \end{align*}
    so, modulo $p$, $1,\zeta,\zeta^2,\ldots,\zeta^{p-2}$ form a basis.
    If $j\notin\{0,1,2,p-1\}$, then ($*$) contradicts linear independence.
    (Incomplete?)
\end{proof}

\section{Lattices and Minkowski's Theorem}
\begin{definition}
    A \mbf{lattice} is an abelian subgroup $\Lambda$ of $\R^n$ such that $\Lambda\cong\Z^n$.
\end{definition}
\begin{example}
    If $[K:\Q]=n$, then $\mathcal{O}_K$ is a lattice in $K\cong\Q^n\subseteq\R^n$.
    $\mathcal{O}_K$ is a lattice since it has an integral basis.
\end{example}
\begin{example}
    Consider $\C\cong\R^2$, and let $\tau$ be in the upper half plane.
    Then $\Lambda=\Z\oplus\Z\tau$, and $\quot{\C}{\Lambda}=\mathcal{T}$ is the torus.
    In a sense that can be made precise, $\mathcal{T}$ is an elliptic curve, and every elliptic curve arises like this.
\end{example}
Choose a basis $\{\alpha_1,\ldots,\alpha_n\}$ for $\Lambda$; this basis is also an $\R-$basis for $\R^n$.
If $\{\alpha_1,\ldots,\alpha_n\}$ is a basis for $\Lambda$ and $\{\alpha_1',\ldots,\alpha_n'\}$ is a basis for $\Lambda$, then we have a change of basis matrix
\begin{equation*}
    \begin{pmatrix}\alpha_1'\\\vdots\\\alpha_n'\end{pmatrix}=P\begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix}
\end{equation*}
Since $P\in\GL_n(\Z)$, $\det P=\pm 1$.
Thus, we can define the \mbf{volume of $\Lambda$} to be
\begin{equation*}
    d(\Lambda)=|\det(\alpha_1,\ldots,\alpha_n)|
\end{equation*}
which is independent of the choice of matrix by the above observation.
\begin{theorem}[Blichfeldt]\label{t:blich}
    Suppose $\Lambda\subseteq\R^n$ is a lattice, $m\in\Z^+$ and $S\subseteq\R^n$ with Lebesgue measure $\mu(S)$.
    Suppose $\mu(S)\geq md(\Lambda)$ $S$ is compact if equality holds.
    Then there exist distinct $x_1,\ldots,x_{m+1}\in S$ such that $x_i-x_j\in\Lambda$.
\end{theorem}
\begin{proof}
    Let $\alpha_1,\ldots,\alpha_n$ be a basis for $\Lambda$.
    Let $P=\left\{\sum_{i=1}^n\theta_i\alpha_i\mid 0\leq\theta_i<1\right\}$, so that$\mu(P)=d(\Lambda)$.
    For each $\lambda\in\Lambda$, let $R(\lambda)=\{\nu\in P\mid\lambda+\nu\in S\}$.
    Then
    \begin{equation*}
        \sum_{\lambda\in\Lambda}\mu(R(\lambda))=\mu(S)\geq m\mu(P)
    \end{equation*}
    If $S$ is not compact, then there exists $\nu_0\in P$ which occurs in at least $m+1$ of the $R(\lambda)$'s.
    If instead $S$ is compact, for any $\epsilon_r>0$, get $\nu_r\in P(1+\epsilon_r)$ which occurs in at least $m+1$ of $R(\lambda)$'s.
    This sequence has a convergent subsequence with limit $\nu_0$ which has the same property.

    Let $\lambda_1,\ldots,\lambda_{m+1}$ distinct such that if $\nu\in R(\lambda_i)$, then $x_i=\lambda_i+v_0\in S$.
    Then $x_i-x_j=\lambda_i-\lambda_j\in\Lambda$.
\end{proof}
\begin{theorem}[Minkowski]\label{t:mink}
    Let $\Lambda\subseteq\R^n$ be a lattice, $m\in\Z^+$, $S\subseteq\R^n$ convex and symmetric about the origin.
    Suppose $\mu(S)\geq m2^nd(\Lambda)$ with $S$ compact if equality holds.
    Then there exist $m$ pairs $(\lambda_1,-\lambda_1),\ldots,(\lambda_m,-\lambda_m)$ with $\lambda_j\in\Lambda\setminus\{0\}$, $\lambda_j\in S$.
\end{theorem}
\begin{proof}
    Either $\mu(S/2)>md(\Lambda)$ or $\mu(S/2)=md(\Lambda)$ and $S/2$ is compact.
    Thus by \cref{t:blich}, there exist $x_1,\ldots,x_{m+1}\in S$ such that $x_i/2-x_j/2\in\Lambda$.
    Order these $x_i$ such that $x_1>x_2>\cdots>x_{m+1}$ where we say $x_i>x_j$ if the first non-zero coordinate of $x_i-x_j$ is positive.
    Take $\lambda_j=x_j/2-x_{m+1}/2$.
    By choice of ordering, the $\pm\lambda_j$ are distinct.
    Since $S$ is symmetric, $-x_{m+1}/2\in S$.
    Since $S$ is convex, $\lambda_j=x_j/2+(-x_{m+1})/2\in S$.
\end{proof}
\begin{remark}
    The bound is sharp: consider $S=\{(x_1,\ldots,x_n)\in\R^n:|x_1|<m,|x_j|<1\}$.
    Then $\mu(S)=m2^n=m2^nd(\Z^n)$ and $S$ contains exactly $m$ lattice points.
\end{remark}
\subsection{Embedding \texorpdfstring{$\mathcal{O}_K$}{OK} in $\R^n$}
Suppose $[K:\Q]=n$ so that $K=\Q(\theta)$.
Let $\sigma_1,\ldots,\sigma_n\hto\C$ be the embeddings, so $r_1$ is the number of real embeddings $\{\sigma_1,\ldots\sigma_{r_1}\}$ and $r_2$ pairs of complex embeddings $\{\sigma_{r_1+1},\ol{\sigma}_{r_1+1},\ldots,\sigma_{r_1+r_2},\ol{\sigma}_{r_1+r_2}\}$.
With these embeddings, we can define $\sigma:K\hto\R^n$ by
\begin{equation*}
    \alpha\mapsto\bigl(\sigma_1(\alpha),\ldots,\sigma_{r_1}(\alpha),\Re\sigma_{r_1+1}(\alpha),\Im\sigma_{r_1+1}(\alpha),\ldots,\Re\sigma_{r_1+r_2}(\alpha),\Im\sigma_{r_1+r_2}(\alpha)\bigr)
\end{equation*}
Equivalently, we say $\sigma:K\hto\R^{r_1}\times\C^{r_2}$ given by
\begin{equation*}
    \alpha\mapsto\bigl(\sigma_1(\alpha),\ldots,\sigma_{r_1}(\alpha),\sigma_{r_1+1}(\alpha),\ldots,\sigma_{r_1+r_2}(\alpha)\bigr)
\end{equation*}
and these are equivalent by identifying $\R^{2r_2}\cong\C^{r_2}$ as vector spaces.
We call this embedding the \mbf{Minkowski embedding}.
\begin{lemma}\label{l:lat-sz}
    Let $A\neq 0$ be an ideal of $\mathcal{O}_K$.
    Then $\sigma(A)$ is a lattice $\Lambda\subseteq\R^n$ and $d(\Lambda)=2^{-r_2}\sqrt{|\disc(K)|}N(A)$.
\end{lemma}
\begin{proof}
    Let $\alpha_1,\ldots,\alpha_n$ be an integral basis for $A$.
    Let $D_0$ be the determinant of the matrix whose $i^{\text{th}}$ row is
    \begin{equation*}
        D_0=
        \begin{pmatrix}
            \sigma_1(\alpha_1)&\ldots&\sigma_{r_1}(\alpha_1)&\Re\sigma_{r_1+1}(\alpha_1)&\cdots&\Im\sigma_{r_1+r_2}(\alpha_1)\\
            \vdots&&\vdots&\vdots&&\vdots&\\
            \sigma_1(\alpha_n)&\ldots&\sigma_{r_1}(\alpha_n)&\Re\sigma_{r_1+1}(\alpha_n)&\cdots&\Im\sigma_{r_1+r_2}(\alpha_n)
        \end{pmatrix}
    \end{equation*}
    From \cref{t:id-norm}, we know $\det(\sigma_j(\alpha_i))=\sqrt{|\disc(K)|}\cdot N(A)$.
    Using the fact that $\Re\sigma=\frac{\sigma+\ol{\sigma}}{2}$ and $\Im\sigma=\frac{\sigma-\ol{\sigma}}{2i}$ combined with elementary row operations, we have that $D_0=\left(\frac{1}{-2i}\right)^{r_2}\det(\sigma_j(\alpha_i))$.
    In particular, since $D_0\neq 0$, $\Lambda$ is a lattice and $d(\Lambda)=D_0$.
\end{proof}
\begin{theorem}
    If $A$ is a non-zero ideal in $\mathcal{O}_K$, then there exists $0\neq\alpha\in A$ such that $|N(\alpha)|\leq\left(\frac{2}{\pi}\right)^{r_2}\sqrt{|\disc(K)|}$.
\end{theorem}
\begin{proof}
    Given $t\in\R^+$, let
    \begin{equation*}
        S_t=\left\{(x_1,\ldots,x_n)\in\R^n:|x_i|\leq t,i=1,\ldots,r_1;\, x_{r_1+2j+1}^2+x_{r_1+2j+2}^2\leq t^2, j=0,\ldots,r_2-1\right\}
    \end{equation*}
    $S_t$ is clearly convex and symmetric, and $\mu(S_t)=2^{r_1}\pi^{r_2}t^n$.
    Define
    \begin{equation*}
        t=\left(\left(\frac{2}{\pi}\right)^{r_2}\sqrt{|\disc(K)|}N(A)\right)^{1/n}
    \end{equation*}
    so that
    \begin{equation*}
        2^{r_1}\pi^{r_2}t^n=2^n\frac{1}{r^{r_2}}\sqrt{|\disc(K)|}N(A)
    \end{equation*}
    We now apply \cref{t:mink} with $m=1$ and \cref{l:lat-sz} to get $0\neq\alpha\in A$ such that $\sigma(\alpha)\in S_t$.
    Then
    \begin{equation*}
        |N(\alpha)|=\left\lvert\prod_{i=1}^{r_1}\sigma(\alpha_i)\right\rvert\cdot\left\lvert\prod_{i=1}^{r_2}\sigma_{i+r_2}(\alpha)\ol{\sigma_{i+r_2}(\alpha)}\right\rvert
        \leq t^{r_1+2r_2}=t^n
    \end{equation*}
    since $\sigma(\alpha)\in S_t$.
    Thus, $|N(\alpha)|\leq t^n=\left(\frac{2}{\pi}\right)^{r_2}\sqrt{|\disc(K)|}\cdot N(A)$.
\end{proof}
The following corollary is then immediate.
\begin{corollary}
    $C_K\leq\left(\frac{2}{\pi}\right)^{r_2}\sqrt{|\disc(K)|}$.
\end{corollary}
\subsection{Four Squares Theorem}
\begin{theorem}
    Let $p$ be an odd prime.
    Then the following are equivalent:
    \begin{enumerate}[nl,r]
        \item $\lgs{-1}{p}=1$
        \item $p\equiv 1\pmod{4}$
        \item there exists $x,y\in\Z$ such that $p=x^2+y^2$.
    \end{enumerate}
\end{theorem}
Here's a proof of this theorem using the algebraic tools we have developed so far.
\begin{proof}
    \impe{i}{ii}
    This is \cref{p:lgs-1}.

    \imp{ii}{iii}
    Since $\lgs{-1}{p}=1$, $(p)$ splits in $\Z[i]$ so that $(p)=PQ$ in $\Z[i]$, where $P,Q$ are primes.
    Then $p^2=N(p)=N(P)N(Q)$ and $N(P)=p$.
    Since $\Z[i]$ is a PID, $P=(a+bi)$ so that $p=N(P)=a^2+b^2$.

    \imp{iii}{ii}
    The squares modulo 4 are 0 and 1, and since $p$ is odd, we see that $p\equiv 1\pmod{4}$.
\end{proof}
We can also see the hard implication \iimp{ii}{iii} using Minkowski's Theorem:
\begin{proof}
    \imp{ii}{iii}
    Get $l\in\Z$ such that $l^2\equiv -1\pmod{p}$.
    Let $\Lambda\subseteq\R^2$ be the lattice with $\Z-$basis $(1,l)$ and $(0,p)$, so that $d(\Lambda)=p$.
    Let $S$ be a disc with radius $r$; then $\mu(S)=\pi r^2> 2^2p$.
    Set $r=2\sqrt{p/\pi}$.

    By Minkowski \cref{t:mink}, $S$ contains a non-zero lattice point $m(1,l)+n(0,p)=(m,ml+np)\in S$; in particular, $0<m^2+(ml+np)^2\leq r^2<2p$.
    Then,
    \begin{equation*}
        m^2+(ml+np)^2\equiv m^2+(ml)^2\equiv m^2(1+l^2)\equiv 0\pmod{p}
    \end{equation*}
    so $m^2+(ml+np)^2=p$.
\end{proof}
\begin{remark}
    If $a_i,b_i\in\Z$, then $(a_1^2+b_1^2)(a_2^2+b_2^2)=c_1^2+c_2^2$.
    To see this, $a:=a_1^2+a_2^2=N(a_1+ia_2)$ and $b:=b_1^2+b_2^2=N(b_1+ib_2)$.
    Then $ab=N(z^2)=c_1^2+c_2^2$ where $z=(a_1+ia_2)(b_1+ib_2)$.
    In particular, if $n=\prod p_i$ where $p_i\equiv 1\pmod{4}$, then $n=x^2+y^2$.
    In fact, you can prove $n=x^2+y^2$ if and only if the prime factors $p\equiv 3\pmod{4}$ occur to even exponents.
\end{remark}
\begin{proposition}[Euler's Four Squares Identity]\label{p:efsi}
    We have
    \begin{equation*}
        \left(\sum_{i=1}^4 a_i^2\right)\cdot\left(\sum_{i=1}^4 b_i^2\right)=\sum_{i=1}^4 c_i^2
    \end{equation*}
    where
    \begin{align*}
        c_1 &= a_1b_1-a_2b_2-a_3b_3-a_4b_4\\
        c_2 &= a_1b_2+a_2b_1+a_3b_4-a_4b_3\\
        c_3 &= a_1b_3-a_2b_4+a_3b_1+a_4b_2\\
        c_4 &= a_1b_4+a_2b_3-a_3b_2+a_4b_1
    \end{align*}
\end{proposition}
\begin{proof}
    You can compute this directly or recall that the norm on quaternions is multiplicative and proceed as in the preceding remark.
\end{proof}
\begin{theorem}[Four Squares]
    If $n\in\Z^+$, then there exists $x,y,z,w\in\Z$ such that $n=x^2+y^2+z^2+w^2$.
\end{theorem}
In light of the four squares identity \cref{p:efsi}, it suffices to show that primes are sums of four squares.
\begin{claim}
    If $p$ is prime, then there exists $x,y\in\Z$ such that $x^2+y^2\equiv -1\pmod{p}$.
\end{claim}
\begin{nmproof}
    If $p\equiv 1\pmod{4}$, then $\lgs{-1}{p}=1$ and we may take $y=0$.
    Otherwise, we suppose that $\lgs{-1}{p}=-1$.
    Equivalently, we want to solve $y^2+1\equiv -x^2\pmod{p}$.

    Note that
    \begin{equation*}
        |\{y^2+1\mid y\in\F_p\}|=\frac{p+1}{2}
    \end{equation*}
    ($(p-1)/2$ squares, plus $0$))
    and $y^2+1\neq 0$ since $\lgs{-1}{p}=-1$.
    Thus $y^2+1$ takes $(p+1)/2$ non-zero values; since there are only $(p-1)/2$ non-zero squares, so $y^2+1$ must be non-square for some $y=y_0$.
    Then $-(y_0^2+1)$ is a square modulo $p$; that is, there exists $x$ such that $x^2\equiv-(y_0^2+1)\pmod{p}$, as required.
\end{nmproof}
We can now prove the theorem.
\begin{proof}
    Given $p$ prime, choose $a,b\in\Z$ such that $a^2+b^2\equiv -1\pmod{p}$.
    Consider the lattice $\Lambda\subseteq\R^4$ with basis
    \begin{equation*}
        \{(1,0,a,b),(0,1,b,-a),(0,0,p,0),(0,0,0,p)\}
    \end{equation*}
    such that $d(\Lambda)=p^2$.
    Let $S$ be a ball of radius $r$, and $\mu(S)=\pi^2r^4/2$.
    Let $r^2=4p/\pi\sqrt{2}$, so $\mu(S)=p^2$.
    By Minkowski \cref{t:mink}, $S$ contains a non-zero lattice point $(x,y,z,w)$ with $0<x^2+y^2+z^2+w^2\leq r^2<2p$.
    Note that $(x,y,z,w)=\alpha v_1+\beta v_2+\gamma v_3+\delta v_4$.
    Then $x=\alpha$, $y=\beta$, $z=a\alpha+b\beta+p\gamma$, $w=b\alpha-a\beta+p\delta$.
    Modulo $p$, we see that
    \begin{align*}
        x^2+y^2+z^2+w^2 &\equiv x^2+y^2+(ax+by)^2+(bx-ay)^2\\
                        &\equiv x^2+y^2+a^2x^2+b^2y^2+b^2x^2+a^2y^2\\
                        &\equiv (1+a^2+b^2)x^2+(1+a^2+b^2)y^2\equiv 0
    \end{align*}
    since $a^2+b^2\equiv -1\pmod{p}$.
    Thus the result follows.
\end{proof}
\subsection{Dirichlet Unit Theorem}
Our final application of Minkowski's theorem is a generalization of the classification of units in a quadratic number field \cref{t:dir-unit-q} to any number field.
\begin{theorem}[Dirichlet Unit]\label{t:dir-unit}
    If $K$ is a number field with $r_1$ real embeddings and $2r_2$ complex embeddings, then $\mathcal{O}_K^\times\cong U_K\times\Z^{r_1+r_2-1}$, where $U_K$ is the set of roots of unity in $K$.
\end{theorem}
Let $\theta:K\to V:=\R^{r_1}\times\C^{r_2}$ be given by
\begin{equation*}
    \alpha\mapsto\bigl(\sigma_1(\alpha),\ldots,\sigma_{r_1}(\alpha),\sigma_{r_1+1}(\alpha),\ldots,\sigma_{r_1+r_2}(\alpha)\bigr)
\end{equation*}
where $\sigma_1,\ldots,\sigma_r$ are the real emebddings and $\sigma_{r_1+1},\ldots,\ol{\sigma}_{r_1+r_2}$ are the complex embeddings.
Let $N:V\to\R$ be given by
\begin{equation*}
    N\bigl(x_1,\ldots,x_{r_1},z_{r_1+1},\ldots,z_{r_1+r_2}\bigr)=\prod_{i=1}^{r_1}x_i\cdot\prod_{i=r_1+1}^{r_1+r_2}|z_i|^2
\end{equation*}
$N$ is chosen so that $N(\theta(\alpha))=N^K_{\Q}(\alpha)$.
Furthermore, $V$ is a ring with coordinate-wise operations; in particular, it has units $V^\times=(\R^\times)^{r_1}\times(\C^\times)^{r_2}$.
Set
\begin{equation*}
    G:=\{v\in V^\times:|N(v)|=1\}
\end{equation*}
so that $G$ is a subgroup of $V^\times$.
$G$ is also closed as a topological space since it is the inverse image of $1$ under the continuous map $v\mapsto|N(v)|$.
Define
\begin{equation*}
    U:=\theta(\mathcal{O}_K^\times)=\theta(\mathcal{O}_K)\cap G
\end{equation*}
In particular, $\theta(\mathcal{O}_K)\subseteq V$ is a lattice (identifying $\C\cong\R^2$), and $U\subseteq G$ is a discrete group.
In order to understand $\mathcal{O}_K^\times$, we want to understand the group $U$.
A natural way to do this is to transform the multiplicative structure on $U$ to an additive structure via the ``log map''
\begin{equation*}
    L:V^\times\to\R^{r_1+r_2}\text{ given b}(x_i;z_j)\mapsto(\log|x_i|;2\log|z_j|)
\end{equation*}
This is a surjective continuous group homomorphism; as a straightforward exercise, one can show that $L(G)\cong\R^{r_1+r_2-1}$.
We have the following diagram summarizing these constructions:
\begin{center}
    \begin{tikzcd}
        \quot{G}{U}\arrow[r,two heads,"L\circ\pi"] & \quot{L(G)}{L(U)}\\
        G\arrow[r,two heads,"L"]\arrow[u,two heads,"\pi"]& L(G)\arrow[u,two heads]\arrow[r,"\cong"]& \R^{r_1+r_2-1}\\
        U\arrow[u,symbol=\subseteq]\arrow[r,two heads] &\arrow[u,symbol=\subseteq]L(U)
    \end{tikzcd}
\end{center}
In order to understand $U\subseteq G$, by the first isomorphism theorem, it suffices to understand $\ker L|_U$ \cref{c:k3} and $L(U)$ \cref{c:k2}.
In fact, we claim that $L(U)\cong \R^{r_1+r_2-1}$.
We will prove that $L(U)\subseteq L(G)$ is a lattice.
Assuming this, it suffices to show that $\quot{L(G)}{L(U)}$ is compact; and since $L$ is surjective, it is in fact enough to show that $\quot{G}{U}$ is compact \cref{c:k1}.
\begin{claim}\label{c:k1}
    $\quot{G}{U}$ is compact in the quotient topology of $\quot{V^\times}{U}$.
\end{claim}
\begin{nmproof}
    Let $v\in V^\times$ be arbitrary; then, multiplication by $v$ is a linear map with matrix representation $M$; in particular, $\det(M)=|N(v)|$.
    If $R\subseteq V$ is any region, then $\mu(vR)=\lambda(R)\cdot|N(v)|$; if $v\in G$, then $\lambda(R)=\lambda(vR)$.

    Let $C\subseteq G$ be any compact, symmetric, convex region with $\mu(C)\geq 2^n$.
    For all $g\in G$, $\mu(g^{-1}C)=\lambda(C)\geq 2^n\lambda(\theta(\mathcal{O}_K))$.
    As well, one can verify that $g^{-1}C$ is also symmetric, compact, and convex.
    Thus by \cref{t:mink}, there exists $0\neq\alpha\in\mathcal{O}_K$ such that $\theta(\alpha)\in g^{-1}C$.
    In particular,
    \begin{equation*}
        \abs{N_{K/\Q}(\alpha)}=\abs{N(\theta(\alpha))}\in\abs{N(g^{-1}C)}
    \end{equation*}

    Since $C$ is compact, $|N(C)|\subseteq\R$ is also compact and thus contains finitely many integers.
    If $\alpha_1,\ldots,\alpha_m\in\mathcal{O}_K$ represent all possible $|N(\alpha_i)|\in|N(C)|$, then $|N(\alpha)|=|N(\alpha_i)|$ for some $i$, so $\alpha\in\alpha_i\mathcal{O}_K^\times$.
    But then for any $g\in G$, there exists $i$ such that $g^{-1}C\cap\theta(\alpha_i\mathcal{O}_K^\times)\neq\emptyset$, so
    \begin{equation*}
        gU\cap\theta(\alpha^{-1})C\neq\emptyset
    \end{equation*}
    Thus $\quot{G}{U}$ has representatives covered by $G\cap\bigcup_{i=1}^m\theta(\alpha_i)^{-1}C$ which is a finite union of compact sets.
    Since $\quot{G}{U}$ is closed, we are done.
\end{nmproof}
\begin{claim}\label{c:k2}
    $L(U)\subseteq L(G)$ is a lattice, and $L(U)\cong\R^{r_1+r_2-1}$.
\end{claim}
\begin{nmproof}
    \textit{Want to show that $L(U)$ is a full lattice in $\R^{r_1+r_2-1}$; this happens if and only if the quotient is compact.}
    Recall that $L(G)\cong\R^{r_1+r_2-1}$ let $B=\{(y_i):|y_i|\leq b\}$ be an arbitrary hypercube.
    Let's show that $L(U)\cap B$ is finite.
    If $L(\theta(\alpha))\in B$, then $|\sigma(\alpha)|\leq e^b$ for some $\sigma$ real, and $|\sigma(\alpha)|\leq e^{b/2}$ for some $\sigma$ complex.
    Then
    \begin{equation*}
        \prod_\sigma(t-\sigma(\alpha))\in\Z[t]
    \end{equation*}
    has bounded coefficients.
    There are only finitely many such polynomials, so there are only finitely many $\alpha$ and $L(U)\subseteq L(G)$ is a discrete subgruop.

    Thus $L(U)\cong\Z^r$ for some $r\leq r_1+r_2-1$.
    Since $\quot{G}{U}\to \quot{L(G)}{L(U)}$ is a surjection, $\quot{L(G)}{L(U)}\cong (S^1)^r\times\R^{r_1+r_2-1-r}$ is compact, so $r=r_1+r_2-1$.
\end{nmproof}
\begin{claim}\label{c:k3}
    $\ker L|_U\cong U_K$.
\end{claim}
\begin{proof}
    Clearly $\ker(L)=\{\pm 1\}^{r_1}\times (S^1)^{r_2}$ is a compact set and $\theta(U_K)\subseteq U\cap\ker(L)$.
    Since $U\subseteq V^\times$ is discrete, $U\cap\ker(L)\subseteq\ker L$ is compact and, in particular, a finite group.
    Thus by Lagrange's theorem, each $x\in U\cap \ker(L)$ has finite order, so in fact $U\cap \ker(L)\subseteq\theta(U_K)$, and equality holds.
\end{proof}

% Given $\epsilon\in\mathcal{O}_K^\times$, $L(\theta(\epsilon))\in L(U)$, so there exists $a_i\in\Z$ such that $L(\theta(\epsilon))=\sum a_iL(\theta(\epsilon_i))=L(\theta(\prod\epsilon_i^{a_i}))$.
% Thus $L(\theta(\epsilon^{-1}\prod\epsilon_i^{a_i}))=0$, so $\epsilon^{-1}\prod\epsilon_i^{a_i}\in\ker L|_U$, so $\epsilon=\zeta\prod\epsilon_i^{a_i}$, and $\zeta\in U_K$.
% Lastly, if $\prod\epsilon_i^{a_i}=1$, then $0=\sum a_iL(\theta(\epsilon_i))$ is a $\Z-$basis, so $a_i=0$.

\begin{example}
    To illustrate the definitions explicitly, consider the following case.
    Take $K=\Q(\sqrt{2})$ so that $\theta:K\to V=\R^2$ is given by $a+b\sqrt{2}\mapsto(a+b\sqrt{2},a-b\sqrt{2})$.
    Then $N:\R^2\to\R$ is given by $(x,y)\mapsto xy$, so $G=\{(x,y):xy=\pm 1\}$ is the set of hyperbolas.
    Note that $G$ is closed but not compact.
    In this case, $U=\theta(\pm(1+\sqrt{2})^{\Z})$, and $U\subseteq G$ is discrete.
    \begin{center}
        \begin{tikzpicture}
            \begin{axis}[
                % title={The regions $G$ and $\quot{G}{U}$},
                % title style={at={(0.5,0)},anchor=north,yshift=-0.1},
                legend cell align=left,
                legend pos=north east,
                legend style={draw=none},
                samples=100,
                axis x line=center,
                axis y line=center,
                xtick={-40,-30,...,40},
                ytick={-40,-30,...,40},
                xlabel={},
                ylabel={},
                xlabel style={below right},
                ylabel style={left},
                xmin=-3.3,
                xmax=3.3,
                ymin=-3.3,
                ymax=3.3,
                scale=1.5
                ]
                \addplot[smooth, name path=f, domain=0.1:1,black, thick] {1/x};% f(x)
                \addplot[smooth, name path=g, domain=1:2.414213562,black, line width=3pt] {1/x};% f(x)
                \addplot[smooth, name path=f, domain=2.414213562:5,black, thick] {1/x};% f(x)
                \addplot[smooth, name path=t1, domain=0.1:5,black, thick] {-1/x};% f(x)
                \addplot[smooth, name path=t2, domain=-5:-0.1,black, thick] {1/x};% f(x)
                \addplot[smooth, name path=t3, domain=-5:-0.1,black, thick] {-1/x};% f(x)
                \node[circle,fill=black,inner sep=1pt,label=above right:{$\theta(1)$}] (a1) at (1,1){};
                \node[circle,fill=black,inner sep=1pt,label=below left:{$\theta(-1)$}] (a2) at (-1,-1){};
                \node[circle,fill=black,inner sep=1pt,label=above:{$\theta(1+\sqrt{2})$}] (b) at (2.414213562,.414213562){};
                \legend{$G$, $\quot{G}{U}$}
            \end{axis}
        \end{tikzpicture}
    \end{center}
    Here, we can see that $\quot{G}{U}$ is compact.
\end{example}
\begin{example}
    If $K=\Q(\sqrt{d})$, then $r_1=2$, $r_2=0$, $\mu_k=\{\pm 1\}\cong\Z/2$ and $\mathcal{O}_K^\times\cong\Z_2\times\Z$ as in \cref{t:dir-unit-q}.
    If $K=\Q(\sqrt{2},\sqrt{3})$, then $r_2=0$, $r_1=4$, $\mathcal{O}_K^\times=\{\pm 1\}\times\Z^3$.
\end{example}
% \subsection{Additional Topics}
% Let's look at all $K=\Q(\sqrt{D}$.
% Recall that $\disc(K)\approx D$ (up to a linear factor); order all of those $K$ by $\disc K$.
% Given $B>0$, there are only finitely many $K$ with $|\disc(K)|\leq B$; call this number $N_B$.
% Let's compute the growth rate of $N_B$.
% We have $N_B\approx B\cdot(\text{Probability of being square free})$.
% If $p$ fixed is prime, then the probability of being divisible by $p^2$ is $1/p^2$.
% Being divisible by $q$ is independent of being divisible by $p$.
% Thus the probability of being squarefree is should equal $\prod_{p\text{ prime}}(1-1/p^2)$.
% What is this product?
% \begin{align*}
    % \prod_p\frac{1}{1-\frac{1}{p^2}} &= \prod_p\left(1+\frac{1}{p^2}+\frac{1}{p^4}+\cdots\right)\\
                                     % &= 1+\frac{1}{2^2}+\frac{1}{3^2}+\frac{1}{4^2}+\cdots\\
                                     % &= \zeta(2)=\frac{\pi^2}{6}
% \end{align*}
% Thus the probability of being squarefree is $6/\pi^2$.
% Thus $N_B\approx 6/\pi^2 B\approx cB$.

% Special case of Malle conjecture.
% Consider $K/\Q$ of degree $n$ with Galois closure Galois group $S_n$.
% Order by $|\disc(K)|$.
% Can ask how many such $K$ are at most $B$?
% The conjecture is that it grows like $cB$ for some constant $c$.

% Davenport-Heilbrom proved this in '71 when $n=3$.
% $n=4,5$ were proven by Bhargava's thesis

% Similar but different kind of questions.
% Let $X$ be the solution set to a set of polynomial equations in $\Q[x]$.
% For example, $y^2=x^3+17x$.
% Let's concentrate on the rational solutions; we denote this by $X(\Q)$.

% Let $X=\{(x,y):x^2+y^2=1\}$.
% We'll take $X(\Q)$ and order the elements by ``height''.
% Given $(x,y)\in X(\Q)$, clear denominators to get $(a,b)\in\Z^2$ coprime.
% We then say $H(x,y)=\max\{|a|,|b|\}$.
% Just like in other settings, if $B>0$ is fixed, then $N_B:=|\{(x,y)\in X(\Q):h(x,y)<B\}|$ is finite.
% For the circle, $N_B\approx 12/\pi^2 B^2$.

% The Batyrev-Mann Conjecture rougly says $N_B\approx cB^a(\log B)^b$ where $a,b$ are specific geometric constants.

\end{document}


