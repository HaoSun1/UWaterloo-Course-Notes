% Template created by texnew (author: Alex Rutar); info can be found at 'https://github.com/alexrutar/texnew'.
% doctype ---------------------------------------------------------------------
\documentclass[12pt, a4paper]{memoir}
\usepackage[ascii]{inputenc}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=4cm]{geometry}
\usepackage[protrusion=true,expansion=true]{microtype}

% packages --------------------------------------------------------------------
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{emptypage}
\usepackage{graphicx}
\usepackage{enumitem}
\SetEnumitemKey{nl}{nolistsep}
\SetEnumitemKey{r}{label=(\roman*)}

\usepackage[hidelinks]{hyperref}

\usepackage{tikz, pgfplots}
\pgfplotsset{compat=1.15}
\usetikzlibrary{intersections}
\usetikzlibrary{cd}
\usetikzlibrary{arrows,arrows.meta}
\tikzcdset{arrow style=tikz,diagrams={>=stealth}}

% default macros --------------------------------------------------------------
\DeclareMathOperator{\N}{{\mathbb{N}}}
\DeclareMathOperator{\Q}{{\mathbb{Q}}}
\DeclareMathOperator{\Z}{{\mathbb{Z}}}
\DeclareMathOperator{\R}{{\mathbb{R}}}
\DeclareMathOperator{\C}{{\mathbb{C}}}
\DeclareMathOperator{\F}{{\mathbb{F}}}
\newcommand{\mbf}[1]{{\bfseries\boldmath #1}}
 
% Divides, Not Divides
\renewcommand{\div}{\bigm|}
\newcommand{\ndiv}{%
      \mathrel{\mkern.5mu % small adjustment
              % superimpose \nmid to \big|
              \ooalign{\hidewidth$\big|$\hidewidth\cr$\nmid$\cr}%
                }%
            }
\newcommand{\cpl}[1]{\overline{#1}} % complement

% Large cdot
\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

% Disjoint Union %
\makeatletter
\providecommand*{\cupdot}{%
  \mathbin{%
    \mathpalette\@cupdot{}%
  }%
}
\newcommand*{\@cupdot}[2]{%
  \ooalign{%
    $\m@th#1\cup$\cr
    \sbox0{$#1\cup$}%
    \dimen@=\ht0 %
    \sbox0{$\m@th#1\cdot$}%
    \advance\dimen@ by -\ht0 %
    \dimen@=.5\dimen@
    \hidewidth\raise\dimen@\box0\hidewidth
  }%
}

\providecommand*{\bigcupdot}{%
  \mathop{%
    \vphantom{\bigcup}%
    \mathpalette\@bigcupdot{}%
  }%
}
\newcommand*{\@bigcupdot}[2]{%
  \ooalign{%
    $\m@th#1\bigcup$\cr
    \sbox0{$#1\bigcup$}%
    \dimen@=\ht0 %
    \advance\dimen@ by -\dp0 %
    \sbox0{\scalebox{2}{$\m@th#1\cdot$}}%
    \advance\dimen@ by -\ht0 %
    \dimen@=.5\dimen@
    \hidewidth\raise\dimen@\box0\hidewidth
  }%
}
\makeatother
 
\newcommand{\brac}[1]{\ensuremath{\left\langle #1 \right\rangle}} % inner product, etc.
\newcommand{\norm}[1]{\ensuremath{\left\lVert#1\right\rVert}} % norm, #2
\newcommand{\fto}[1]{\ensuremath{\xrightarrow{\scriptscriptstyle{#1}}}}


% theorem macros --------------------------------------------------------------
\usepackage[thref, thmmarks,amsmath]{ntheorem}

% Numbered Statements
\theoremindent0.5cm
\theorembodyfont{\itshape}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}

% Un-numbered Statements
\theoremindent0.0cm
\theorempreskip{0.1cm}
\theorempostskip{0.1cm}
\theorembodyfont{\upshape}
\theoremheaderfont{\bfseries\itshape}
\theoremstyle{nonumberplain}
\newtheorem{definition}{Definition.}
\theoremheaderfont{\itshape}
\newtheorem{example}{Example.}
\newtheorem{remark}{Remark.}

% Proof / solution environments
\theoremseparator{}
\theoremheaderfont{\scshape}
\theoremsymbol{$//$}
\newtheorem{solution}{Sol'n}
\theoremsymbol{$\blacksquare$}
\theoremindent0.5cm
\theorempostskip{0.5cm}
\newtheorem{proof}{Proof}

% algebra macros --------------------------------------------------------------
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ann}{ann}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Nil}{Nil}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Gl}{Gl}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\spn}{span}
\newcommand{\lgs}[2]{\ensuremath{\left(\frac{#1}{#2}\right)}}

% analysis macros -------------------------------------------------------------
\DeclareMathOperator{\M}{\mathcal{M}}
\DeclareMathOperator{\B}{\mathcal{B}}
\DeclareMathOperator{\ps}{\mathcal{P}}
\DeclareMathOperator{\pr}{\mathbb{P}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\supp}{supp}
\renewcommand{\Re}{\ensuremath{\operatorname{Re}}}
\renewcommand{\Im}{\ensuremath{\operatorname{Im}}}
\renewcommand{\d}[1]{\ensuremath{\operatorname{d}\!{#1}}} % dx macro for integrals

% file-specific macros --------------------------------------------------------
\hfuzz=100pt % supress overfull warnings
\DeclareMathOperator{\ND}{ND}
\DeclareMathOperator{\BV}{BV}
\DeclareMathOperator{\sgn}{sgn}

% formatting ------------------------------------------------------------------
\usepackage{kpfonts}
\usepackage{dsfont}

% Define Document Variables
\newcommand{\subject}{Measure Theory}
\newcommand{\topic}{PMATH 451}
\newcommand{\semester}{Winter 2019}

% Format Table of Contents
\renewcommand{\thechapter}{\Roman{chapter}}
\counterwithout{section}{chapter}
\counterwithin*{chapter}{part}
\renewcommand*{\cftchaptername}{Chapter } % Place 'Chapter' before roman
\setlength\cftchapternumwidth{4em} % Add space before chapter name
\cftpagenumbersoff{chapter} % Turn off page numbers for chapter

% Format Section / Subsection headers
\newcommand*{\shortcenter}[1]{%
    \sethangfrom{\noindent ##1}%
    \Large\boldmath\scshape\bfseries
    \centering
\parbox{5in}{\centering #1}\par}
\setsecheadstyle{\shortcenter}
\setsubsecheadstyle{\large\scshape\boldmath\bfseries\raggedright}

% Format Chapter Headers
\chapterstyle{verville}

% Format Page Headers / Footers
\setsecnumdepth{section}
\copypagestyle{myruled}{ruled} % Draw formatting from existing 'ruled' style
\makeoddhead{myruled}{}{}{\scshape\subject}
\makeevenfoot{myruled}{}{\thepage}{}
\makeoddfoot{myruled}{}{\thepage}{}
\pagestyle{myruled}

% Format Titlepage
\title{\subject}
\author{Alex Rutar\thanks{\itshape arutar@uwaterloo.ca}\\ University of Waterloo}
\date{\semester\thanks{Last updated: \today}}

\begin{document}
\pagenumbering{gobble}
\hypersetup{pageanchor=false}
\maketitle
\newpage
\frontmatter
\hypersetup{pageanchor=true}
\tableofcontents*
\mainmatter

% document start --------------------------------------------------------------
\chapter{Measures}
\section{Measure Spaces}
\begin{itemize}
    \item Lebesgue - improvement of Riemann integral in $\R^d$, translation-invariant measure on $\R^d$, $L^p$-spaces, rigorous treatments of convergence of functions
    \item Kolmogorov - theoretical foundations of probability
\end{itemize}
Philosophy
\begin{itemize}
    \item rigorous notion of measure
    \item a theory of integration of appropriate functions
    \item the core of the theory provides a robust sequence of tools to approximate/calculate these rigorously
    \item Functional analysis ($L^p$ spaces, duality, Lebesgue differentiation)
\end{itemize}
\begin{definition}
    Let $X\neq\emptyset$ be a set.
    $\mathcal{M}\subset\mathcal{P}(X)$ is called a \textbf{$\sigma-$algebra} on $X$ if
    \begin{enumerate}[nolistsep]
        \item $X\in \mathcal{M}$
        \item $A\in\mathcal{M}\Rightarrow A^c\in\mathcal{M}$
        \item If $A_n\in\mathcal{M}$ for all $n\in\N$, then $\bigcup\limits_{n\in\N}A_n\in\mathcal{M}$
    \end{enumerate}
    The pair $(X,\mathcal{M})$ is called a \textbf{measurable space}.
    The elements of $\mathcal{M}$ are called \textbf{measurable sets}.
\end{definition}
\begin{definition}
    Let $(X,\mathcal{M})$ be a measurable space, $(Y,\tau)$ be a topological space.
    Then $f:X\to Y$ is called \textbf{measurable} if $f^{-1}(V)\in\mathcal{M}$ for all $V\in\tau$.
\end{definition}
We have the following properties of $\sigma-$algebras.
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item $\emptyset\in\mathcal{M}$
        \item $A_1,A_2,\ldots,A_n\in\mathcal{M}\Rightarrow A_1\cup A_2\cup\cdots \cup A_n\in\mathcal{M}$
        \item $A_n\in\mathcal{M}$ for all $n\in\N$ then $\bigcap_{n=1}^\infty A_n\in\mathcal{M}$
        \item $A,B\in\mathcal{M}\Rightarrow A\setminus B\in\mathcal{M}$
        \item $f$ is measurable, $H\subset Y$ is closed, then $f^{-1}(H)\in\mathcal{M}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[nolistsep]
        \item $X\in\mathcal{M}\Rightarrow X^c\in\mathcal{M}$.
        \item We can extend this to a countable union by introduction $A_{n+i}=\emptyset$ for $i\in\N$.
        \item By DeMorgan's identities, $(\bigcap A_n)^c=\bigcup A_n^c\in\mathcal{M}$.
        \item $A\setminus B=A\cap B^c\in\mathcal{M}$.
        \item $H^c$ is open implies $f^{-1}(H^c)\in\mathcal{M}$.
            Then $f^{-1}(H)=(f^{-1}(H^c))^c\in\mathcal{M}$.
    \end{enumerate}
\end{proof}
One can define the extended real line as follows: set the space $X=\R\cup\{-\infty,+\infty\}$.
Then the topology is given by
\[G\in\tau\Leftrightarrow
    \begin{cases}
        \forall x\in G\cap\R & \exists r>0 \text{ s.t. } (x-r,x+r)\subset G\\
        -\infty\in G & \exists b\in\R \text{ s.t. }(-\infty,b)\subset G\\
        +\infty\in G & \exists a\in\R \text{ s.t. }(a,\infty)\subset G
    \end{cases}
\]
The same can be done with a single symbol as well.
In either case, the extended real line is a compact set.
We also extend the general operations so that $a+\infty=\infty$ for any $a\in(0,\infty]$, and $\infty=\sup[0,\infty]=\sup[0,\infty)$, and similarly for $-\infty$.

We define for $(a_i)\subset[0,\infty]$
\[\sum\limits_{i=1}^\infty a_i=\sup_{n\in\N}\sum\limits_{i=1}^n a_i\]
If $(a_i),(b_i)\subset[0,\infty]$, then
\[\sum\limits_{i=1}^\infty(a_i+b_i)=\sum\limits_{i=1}^\infty a_i+\sum\limits_{i=1}^\infty b_i\]
Furthermore, if ${(a_{ij})_{i=1}^\infty}_{j=1}^\infty\subset[0,\infty]$, then
\[\sum\limits_{i=1}^\infty\sum\limits_{j=1}^\infty a_{ij}=\sum\limits_{j=1}^\infty\sum\limits_{i=1}^\infty a_{ij}\]
This is the image of positive measures:
\begin{definition}
    Let $(X,\mathcal{M})$ be a measurable space.
    A function $\mu:\mathcal{M}\to[0,+\infty]$ is called a \textbf{(positive) measure} if it is countably additive and not constant $+\infty$.
    In other words,
    \begin{enumerate}[nolistsep]
        \item $\mu(\emptyset)=0$
        \item $\mu\left(\bigcup\limits_{n=1}^\infty A_n\right)=\sum\limits_{n=1}^\infty \mu(A_n)$ if $A_i\cap A_j=\emptyset$
    \end{enumerate}
    The pair $(X,\mathcal{M},\mu)$ is called a \textbf{measure space}.
\end{definition}
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item If $A_i\cap A_j=\emptyset$ then $\mu\left(\sum_{i=1}^n A_i\right)=\sum_{i=1}^n\mu(A_i)$.
        \item $A\subset B$ implies $\mu(A)\leq\mu(B)$
            Then $\mu(B\setminus A)=\mu(B)-\mu(A)$.
        \item If $A_1,A_2,\ldots\in\mathcal{M}$, then $\mu\left(\bigcup_{i=1}^\infty A_i\right)\leq\sum_{i=1}^\infty \mu(A_i)$.
            This is referred to as $\sigma-$subadditivity.
        \item $A_1\subset A_2\subset A_3\cdots$ then $\lim_{n\to\infty}\mu(A_n)=\mu\left(\bigcup_{n=1}^\infty A_n\right)$
        \item $A_1\supset A_2\supset A_3\cdots$ and $\mu(A_i)<\infty$ then $\lim_{n\to\infty}\mu(A_n)=\mu\left(\bigcap_{n=1}^\infty A_n\right)$
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Obvious.
        \item Follows since $B=A\cup(B\setminus A)$ is a disjoint union.
        \item Let $E_1=A_1$, $E_{n+1}=A_{n+1}\setminus\bigcup_{i=1}^n A_i$.
            Then $E_i\cap E_j=\emptyset$ and if $i\neq j$ and for all $i\in\N$, $E_i\in\mathcal{M}$ and $\bigcup_{i=1}^\infty E_i=\bigcup_{i=1}^\infty A_i$.
            Thus
            \begin{align*}
                \mu\left(\bigcup\limits_{i=1}^\infty A_i\right)&=\mu\left(\bigcup\limits_{i=1}^\infty E_i\right)\\
                                                               &= \sum\limits_{i=1}^\infty \mu(E_i)\\
                                                               &\leq \sum\limits_{i=1}^\infty\mu(A_i)
            \end{align*}
        \item Define $B_1:=A_1$ and $B_i=A_i\setminus A_{i-1}$ for $i\geq 2$.
            Then $B_i\cap B_j=\emptyset$ and $\mu(A_n)=\mu\left(\bigcup_{i=1}^n B_i\right)=\sum_{i=1}^\infty\mu(B_i)$.
            Similary, $\mu\left(\bigcup_{n=1}^\infty A_n\right)=\mu\left(\bigcup_{n=1}^\infty B_n\right)=\sum_{n=1}^\infty\mu(B_n)$.
            Therefore, $\lim_{n\to\infty}\sum_{i=1}^n \mu(B_i)=\sum_{n=1}^\infty \mu(B_n)$.
        \item Let $A_i=E_1$, $A_{n+1}=E_{n+1}\setminus\bigcup_{i=1}^n E_i$.
            Then, here $A_i\cap A_j=\emptyset$, $\bigcup_{i=1}^n A_i=E_n$ and $\bigcup_{i=1}^\infty A_i=\bigcup_{i=1}^\infty E_i$.
            Then
            \begin{align*}
                \mu\left(\bigcup\limits_{i=1}^\infty\right) &= \mu\left(\bigcup\limits_{i=1}^\infty A_i\right)\\
                                                            &= \sum\limits_{i=1}^\infty \mu(A_i)\\
                                                            &= \lim_{n\to\infty}\sum\limits_{i=1}^n \mu(A_i)\\
                                                            &= \lim_{n\to\infty} \mu\left(\bigcup\limits_{i=1}^n A_i\right)\\
                                                            &= \lim_{n\to\infty}\mu(E_n)
            \end{align*}
        \item Let $C_n=A_1\setminus A_n$, $C_1=\emptyset$.
            Then $C_1\subset C_2\subset\cdots$ and $\mu(C_n)+\mu(A_n)=\mu(A_1)$.
            Let $A=\bigcap\limits_{n=1}^\infty A_n$ so $A_1\setminus A=\bigcup\limits_{n=1}^\infty C_n$ and $(\bigcup C_n)\cup A=A_1$ is a disjoint union.
            But then $\mu(\bigcup A_n)+\mu(A)=\mu(A_1)$ so that
            \begin{equation*}\mu(A_1)-\mu(A)=\mu(\bigcup C_n)=\lim_{n\to\infty}\mu(C_n)=\mu(A_n)-\lim \mu(A_n)\end{equation*}
            Since $\mu(A_1)$ is finite, we have $\mu(A)=\lim\mu(A_n)$.
    \end{enumerate}
\end{proof}
\subsection{Types of Measures}
\begin{definition}
    A measure space $(X,\mathcal{M},\mu)$ is called:
    \begin{enumerate}[nolistsep]
        \item \textbf{finite} if $\mu(X)<\infty$
        \item a \textbf{probability space} if $\mu(X)=1$.
            If $0<\mu(X)<\infty$, then $\frac{1}{\mu(X)}\mu$ is a probabiliy measure.
        \item \textbf{$\sigma-$finite} if there is a countable collection $\{X_i\}_{i=1}^\infty\subseteq\mathcal{M}$, $\bigcup_{i=1}^\infty X_i=X$, and $\mu(X_i)<\infty$.
        \item \textbf{decomposable} if there is a set $\Pi\subseteq\mathcal{M}$ such that
            \begin{enumerate}[nolistsep]
                \item $\Pi$ partitions $X$
                \item If $E\subseteq X$, then $E\in\mathcal{M}$ if and only if $E\cap P\in\mathcal{M}$ for each $P\in\Pi$
                \item $\mu(P)<\infty$ for all $P\in\Pi$
                \item If $E\in\mathcal{M}$ with $\mu(E)<\infty$, then
                    \begin{equation*}
                        \mu(E)=\sup_{\substack{\mathcal{F}\subseteq\Pi}{\mathcal{F} \text{ finite}}}\sum\limits_{P\in\mathcal{F}}\mu(E\cap P):=\sum\limits_{P\in\Pi}\mu(E\cap P)
                    \end{equation*}
            \end{enumerate}
        \item \textbf{semifinite} if for any $E\in\mathcal{M}$ with $\mu(E)>0$, there is $F\in\mathcal{M}$, $F\subseteq E$ such that $0<\mu(F)<\infty$ (each set is ``finitely approximatable from below'')
        \item \textbf{complete} if whenever $N\subseteq X$ such that $N\subseteq E$, $E\in\mathcal{M}$ and $\mu(E)=0$, then $N\in\mathcal{M}$.
    \end{enumerate}
\end{definition}
A common technique that $\sigma-$finiteness allows is to define $E_n=\bigcup_{i=1}^n X_i$, so $E_1\subseteq E_2\subseteq\cdots$, $X=\bigcup_{i=1}^\infty E_i$ and each $\mu(E_i)<\infty$.
Alternatively, let $A_1=X_1$, $A_{n+1}=X_{n+1}\setminus\bigcup_{i=1}^n X_i$, so each $A_i\in\mathcal{M}$, $A_i\cap A_j=\emptyset$ if $i\neq j$, each $\mu(A_i)<\infty$, and $X_i=\bigcup_{i=1}^\infty A_i$ disjointly.
\begin{enumerate}
    \item probability $\Rightarrow$ finite $\Rightarrow$ $\sigma-$finite $\Rightarrow$ decomposable, semifinite
    \item Completeness has some technical usefulness.
        However, every measure space $(X,\mathcal{M},\mu)$ extends to a complete measure space, so this property is rather unexciting.
        Most ``natural'' constructions of measures give us complete measures.
\end{enumerate}
\subsection{Examples of Measures}
\begin{enumerate}
    \item The zero measure.
        Given a measurable space $(X,\mathcal{M})$, let $\mu(E)=0$ for $E\in\mathcal{M}$.
    \item Counting measure.
        Let $X$ be any non-empty set.
        Then $\mathcal{P}(X)$ is a $\sigma-$algebra on $X$.
        We let $\gamma:\mathcal{P}(X)\to[0,\infty]$ by
        \begin{equation*}
            \gamma(E)=
            \begin{cases}
                |E| &: |E|<\infty\\
                \infty &: \text{otherwise}
            \end{cases}
        \end{equation*}
        Then $(X,\mathcal{P}(X),\gamma)$ is a measure space (easy exercise).
        This space is
        \begin{itemize}[nolistsep]
            \item finite if and only if $X$ is finite
            \item $\sigma-$finite if and only if $X$ is countable
            \item always decomposable $(\Pi=\{\{x\}:x\in X\})$.
            \item always semifinite
            \item always complete
        \end{itemize}
        Since $X\neq\emptyset$, if $X$ is finite, let $\nu=\frac{1}{|X|}\gamma$ is the uniform probability.
    \item Point mass/Dirac.
        Let $a\in X$ and define $\delta_a:\mathcal{P}(X)\to\{0,1\}\subset[0,\infty]$ by
        \begin{equation*}
            \delta_a(E)=
            \begin{cases}
                1 &: a\in E\\
                0 &: a\notin E
            \end{cases}
        \end{equation*}
        Again, this is clearly a measure.
        It is complete, since null sets are those which do not contain $a$.
        It is also a probability measure.
    \item Let $X$ be a countable set, and let $\mathcal{M}$ be the subsets of $X$ that are countable or have countable complement.
        Define $\mu:\mathcal{M}\to[0,\infty]$ by $\mu(E)=0$ if $E$ is countable, and infinity otherwise.
        The measure is not semifinte, nor decomposable, and naturally not $\sigma-$finite.
        However, it is complete.
    \item Let $X=\{x_0\}$, the singleton sets.
        Then $\mathcal{P}(X)=\{\emptyset,\{x_0\}\}$, and define $\mu(\emptyset)=0$ and $\mu(\{x_0\})=\infty$.
        It is not decomposable, nor decomposable.
\end{enumerate}
\section{Outer Measures and Caratheodory's Theorem}
\begin{definition}
    Let $X$ be a non-empty set.
    An \textbf{outer measure} on $X$ is a function $\mu^*:\mathcal{P}(X)\to[0,\infty]$ such that
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $\mu^*(\emptyset)=0$
        \item $A\subseteq B$ implies $\mu^*(A)\leq\mu^*(B)$
        \item $A_1,A_2,\ldots\in \mathcal{P}(X)$, then
            \begin{equation*}\mu^*\left(\bigcup\limits_{i=1}^\infty A_i\right)\leq\sum\limits_{i=1}^\infty \mu^*(A_i)\end{equation*}
    \end{enumerate}
\end{definition}
\begin{remark}
    \begin{enumerate}[nolistsep,label=(\alph*)]
        \item Any measure on $\mathcal{P}(X)$ is an outer measure
        \item Advantage: outer measures are easy to construct and have largest domain
        \item Disadvantage: may not have $\sigma-$additivity
    \end{enumerate}
\end{remark}
\begin{proposition}
    Let $\mathcal{E}\subseteq\mathcal{P}(X)$ be any family such that $\{\emptyset,X\}\subseteq\mathcal{E}$, and there is a function $\rho:\mathcal{E}\to[0,\infty]$ such that $\rho(\emptyset)=0$.
    Then the formula, for $A\in\mathcal{P}(X)$,
    \begin{equation*}
        \mu^*(A)=\inf\left\{\sum\limits_{i=1}^\infty \rho(E_i):E_1,E_2,\ldots\in\mathcal{E}, A\subseteq\bigcup\limits_{i=1}^\infty E_i\right\}
    \end{equation*}
    defines an outer measure on $X$.
\end{proposition}
Note: Unless $(\mathcal{E},\rho)$ is ``nice'', we may not be able to recver $\rho$ from $\mu^*$.
For $E\in\mathcal{E}$, $\mu^*(E)\leq\rho(E)$ (but we may not get equality).
\begin{proof}
    First, $0\leq\mu^*(\emptyset)\leq\rho(\emptyset)=0$.
    Second, if $A\subseteq B\subseteq X$, then any countable $\mathcal{E}-$cover of $B$ is evidently an $\mathcal{E}-$cover of $A$.
    Finally, suppose $A_1,A_2,\ldots\subseteq X$ and let $\epsilon>0$.
    By definition of $\mu^*$ to each $A_i$, get $E_{i1},E_{i2},\ldots$ in $\mathcal{E}$ such that $A_i\subseteq\bigcup_{j=1}^\infty E_{ij}$ and $\sum_{j=1}^\infty \rho(A_i)+\frac{\epsilon}{2^i}$.
    Then $\bigcup_{i=1}^\infty A_i\subseteq\bigcup_{i=1}^\infty\bigcup_{j=1}^\infty E_{ij}$ so that
    \begin{align*}
        \mu^*\left(\bigcup\limits_{i=1}^\infty A_i\right) &\subseteq\sum\limits_{i=1}^\infty\sum\limits_{j=1}^\infty E_{ij}\\
                                                          &\leq \sum\limits_{i=1}^\infty\left(\mu^*(A_i)+\frac{\epsilon}{2^i}\right)\\
                                                          &= \sum\limits_{i=1}^\infty \mu^*(A_i)+\epsilon
    \end{align*}
    Since $\epsilon$ is arbitrary, the inequality holds.
\end{proof}
\begin{definition}[Caratheodory]
    Given an outer measure $\mu^*$ on $X$, we say that a set $A\subseteq X$ is \textbf{$\mu^*-$measurable} provided that for any $E\in\mathcal{P}(X)$, $\mu^*(E)=\mu^*(E\cap A)+\mu^*(E\setminus A)$.
\end{definition}
\begin{remark}
    If $\mu^*$ is an outer measure, $\mu^*(E)\leq\mu^*(E\cap A)+\mu^*(E\setminus A)$ always happens.
    In practice, we only need check ``$\geq$''.
\end{remark}
\begin{definition}
    Given a non-empty set $X$, an \textbf{algebra} on $X$ is a family $\mathcal{A}\subseteq\mathcal{P}(X)$ such that
    % \begin{enumerate}[nolistsep,\label=(\roman*)]
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $X\in\mathcal{A}$
        \item $A\in\mathcal{A}\Rightarrow X\setminus A\in\mathcal{A}$
        \item $A,B\in\mathcal{A}\Rightarrow A\cup B\in\mathcal{A}$
    \end{enumerate}
\end{definition}
By induction, any finite union of sets is in $A$.
As for $\sigma-$algebras, $\emptyset\in\mathcal{A}$ and $\mathcal{A}$ is closed under finite intersections.
\begin{theorem}
    Given an outer measure $\mu^*:\mathcal{P}(X)\to[0,\infty]$, we have that
    \begin{enumerate}[nolistsep,label={(\roman*)}]
        \item $\mathcal{M}=\{A\in\mathcal{P}(X):\forall E\in\mathcal{E}(X),\mu^*(E)\geq\mu^*(E\cap A)+\mu^*(E\setminus A)\}$ is a $\sigma-$algebra.
        \item $\mu=\mu^*|_{\mathcal{M}}:\mathcal{M}\to[0,\infty]$ is a complete measure.
    \end{enumerate}
\end{theorem}
\begin{proof}
    (I) Let us verify first that $\mathcal{M}$ is an algebra.
    First, if $E\in\mathcal{P}(X)$, then $\mu^*(E\cap X)+\mu^*(E\setminus X)=\mu^*(E)+\mu^*(\emptyset)\leq \mu^*(E)$.
    Now, let $A,B\in\mathcal{M}$.
    We have for $E\in\mathcal{P}(X)$ that
    \begin{align*}
        \mu^*(E\cap(X\setminus A))+\mu^*(E\setminus(X\setminus A)) &= \mu^*(E\setminus A)+\mu^*(E\cap A)\leq\mu^*(E)
    \end{align*}
    so that $X\setminus A\in\mathcal{M}$.
    Furthermore,
    \begin{align*}
        \mu^*(E) &\geq \mu^*(E\cap A)+\mu^*(E\setminus A)\\
                 &\geq \mu^*((E\cap A)\cap B)+\mu^*((E\cap A)\setminus B)+\mu^*((E\setminus A)\cap B)+\mu^*((E\setminus A)\setminus B)\\
                 &= \mu^*(E\cap(A\cap B))+\mu^*(E\cap(A\setminus B))+\mu^*(E\cap(B\setminus A))+\mu^*(E\setminus(A\cup B))\\
                 &\geq \mu^*(E\cap(A\cup B))+\mu^*(E\setminus(A\cup B))
    \end{align*}
    by $\sigma-$additivity and that $A\cup B=(A\cap B)\cup(A\setminus B)\cup(B\setminus A)$.
    Thus $A\cup B\in\mathcal{M}$.

    (II) For (i), it remains to show closure under countable unions.
    Let $A_1,A_2,\ldots\in\mathcal{M}$ and $A=\bigcup_{i=1}^\infty A_i$.
    Let $B_1=A_1$, $B_{n+1}=A_{n+1}\setminus\bigcup_{i=1}^\infty A_i$, so $B_i\cap B_j=\emptyset$.
    Each $B_i\in\mathcal{M}$, and $\bigcup_{i=1}^n B_i=\bigcup_{i=1}^n A_i$.
    We have
    \begin{align*}
        \mu^*(E\cap\bigcup_{i=1}^n B_i) &\geq\mu^*\left((E\cap\bigcup_{i=1}^n)\cap B_n\right)+\mu^*\left((E\cap\bigcup_{i=1}^n B_i)\setminus B_n\right)\\
                                        &= \mu^*(E\cap B_n)+\mu^*\left(E\cap\bigcup_{i=1}^{n-1}B_i\right)\\
                                        &= \mu^*(E\cap B_n)+\mu^*(E\cap B_{n-1})+\mu^*\left(E\cap\bigcup_{i=1}^{n-2}B_i\right)\\
                                        &= \sum\limits_{i=1}^n \mu^*(E\cap B_i)
    \end{align*}
    Thus we have that
    \begin{align*}
        \mu^*(E) &\geq\mu^*\left(E\cap\bigcup_{i=1}^n A_i\right)+\mu^*\left(E\setminus\bigcup_{i=1}^n A_i\right)\\
                 &\geq\mu^*\left(E\cap\bigcup_{i=1}^n B_i\right)+\mu^*(E\setminus A)\\
                 &\geq\sum\limits_{i=1}^n\mu^*(E\cap B_i)+\mu^*(E\setminus A)
    \end{align*}
    so, taking the limit,
    \begin{align*}
        \mu^*(E) &\geq\sum\limits_{i=1}^\infty\mu^*(E\cap B_i)+\mu^*(E\setminus A)\\
                 &\geq\mu^*\left(\bigcup_{i=1}^\infty(E\cap B_i)\right)+\mu^*(E\setminus A)\tag{$\dagger$}\\
                 &=\mu^*(E\cap A)+\mu^*(E\setminus A)
    \end{align*}
    so that $A\in\mathcal{M}$.
    Thus (i) is established.

    For (ii), assume $A_1,A_2,\ldots\in\mathcal{M}$, above, that $A_i\cap A_j=\emptyset$ for $i\neq j$.
    Then $B_i=A_i$ for each $i$.
    Set $E=A$.
    From ($\dagger$), we see that
    \begin{align*}
        \mu^*(A) &\geq \sum\limits_{i=1}^\infty \mu^*(A\cap A_i)+\mu(A\setminus A)\\
                 &= \sum\limits_{i=1}^\infty \mu^*(A_i)\\
                 &\geq \mu^*(\bigcup_{i=1}^\infty A_i)=\mu^*(A)
    \end{align*}

    (III) Let us see that if $N\in\mathcal{M}$ with $\mu(N)=0$, then $E\in\mathcal{M}$ for each $E\subseteq N$.
    That is, $\mu$ is complete.
    We have for an $F\in\mathcal{P}(X)$ and $E$ as above, then
    \begin{align*}
        \mu^*(F\cap E)+\mu^*(F\setminus E) &\leq \mu^*(N)+\mu^*(F)\\
                                           &= \mu(N)+\mu^*(F)\\
                                           &= \mu^*(F)
    \end{align*}
\end{proof}
\section{Pre-Measures}
\begin{definition}
    Let $\mathcal{A}$ be an algebra on $X$.
    A \textbf{premeasure} is a function $\mu_0:\mathcal{A}\to[0,\infty]$ such that
    \begin{enumerate}[nolistsep,label={(\roman*)}]
        \item $\mu_0(\emptyset)=0$
        \item If $A_1,A_2,\ldots\in\mathcal{A}$ with $A_i\cap A_j=\emptyset$, and $\bigcup_{i=1}^\infty A_i\in \mathcal{A}$, then $\mu_0(\bigcup_{i=1}^\infty A_i)=\sum_{i=1}^\infty \mu_0(A_i)$.
    \end{enumerate}
    A \textbf{premeasure space} is a triple $(X,\mathcal{A},\mu_0)$.
\end{definition}
Since $\mathcal{A}$ is an algebra, $\mu_0$ respects finite unions.
As with measures, premeasures are monotone: $A\subseteq B$ in $\mathcal{A}$ implies $\mu_0(A)\leq\mu_0(B)$.
\begin{theorem}
    Let $(X,\mathcal{A},\mu_0)$ be a premeasure space.
    Let $\mu^*:\mathcal{P}(X)\to[0,\infty]$ be given by
    \begin{equation*}
        \mu^*(E)=\inf\left\{\sum\limits_{i=1}^\infty \mu_0(A_i):A_1,A_2,\ldots\in\mathcal{A},E\subseteq\bigcup_{i=1}^\infty A_i\right\}
    \end{equation*}
    so $\mu^*$ is an outer measure.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $\mu^*|_{\mathcal{A}}=\mu_0$
        \item The set $\mathcal{M}$ of $\mu^*-$measurable sets contains $\mathcal{A}$.
            Hence, $\mu=\mu^*|_{\mathcal{M}}$ satisfies $\mu|_{\mathcal{A}}=\mu_0$.
        \item If $\nu:\mathcal{M}\to[0,\infty]$ is a measure with $\nu_{\mathcal{A}}=\mu_0$, then $\nu(E)\leq\mu(E)$ for all $E\in\mathcal{M}$, with $\nu(E)=\mu(E)$ if $\mu(E)<\infty$.
            In particular, if $(X,\mathcal{M},\mu)$ is $\sigma-$finite, then $\mu$ is the unique extension of $\mu_0$ to a measure on $\mathcal{M}$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    That $\mu^*$ is an outer measure follows from a prior proposition.
    \begin{enumerate}[label=(\roman*)]
        \item Let $A\in\mathcal{A}$.
            Since $A\subseteq A$, $\mu^*(A)\leq\mu_0(A)$ by definition of $\mu^*$.
            Conversely, let $A_1,A_2,\ldots,\in\mathcal{A}$ be such that $A\subseteq\bigcup_{i=1}^\infty A_i$.
            Let $B_1=A_1$, $B_{n+1}=A_{n+1}\setminus\bigcup_{i=1}^n A_i$, so $B_i\in\mathcal{A}$, $B_i\cap B_j=\emptyset$ for $i\neq j$.
            Thus
            \begin{equation*}
                A=A\cap\bigcup_{i=1}^\infty A_i=A\cap\bigcup_{i=1}^\infty B_i=\bigcup_{i=1}^\infty(A\cap B_i)
            \end{equation*}
            where $(A\cap B_i)\cap(A\cap B_i)$ for $i\neq j$.
            Hence, by restricted $\sigma-$additivity,
            \begin{align*}
                \mu_0(A) &= \mu_0\left(\bigcup_{i=1}^\infty(A\cap B_i)\right)=\sum\limits_{i=1}^\infty(A\cap B_i)\\
                         &\leq\sum\limits_{i=1}^\infty\mu_0(A_i)
            \end{align*}
            By definition of $\mu^*$, we see that $\mu_0(A)\leq\mu^*(A)$.
        \item Now, let $A\in\mathcal{A}$, let $E\in\mathcal{P}(X)$.
            By definition of $\mu^*(E)$, given $\epsilon>0$, we can get $A_1,A_2,\ldots\in\mathcal{A}$ such that $E\subseteq\bigcup_{i=1}^n A_i$ and
            \begin{equation*}
                \sum\limits_{i=1}^\infty \mu_0(A_i)\leq\mu^*(E)+\epsilon
            \end{equation*}
            Then, for each $i$, $\mu_0(A_i)=\mu_0(A_i\cap A)+\mu_0(A_i\setminus A)$ by finite additivity, and $E\cap A\subseteq\bigcup_{i=1}^\infty(A_i\cap A)$, $E\setminus A\subseteq\bigcup_{i=1}^\infty(A_i\setminus A)$.
            Thus
            \begin{align*}
                \mu^*(E)+\epsilon &\geq\sum\limits_{i=1}^\infty\mu_0(A_i)\\
                                  &= \sum\limits_{i=1}^\infty \mu_0(A_i\cap A)+\sum\limits_{i=1}^\infty \mu_0(A_i\setminus A)\\
                                  &\geq \mu^*(E\cap A)+\mu^*(E\setminus A)
            \end{align*}
            and since $\epsilon$ was arbitrary, we see that the desired inequality must hold.
        \item We will use coninuity from below several times.
            If $E\in\mathcal{M}$ and $A_1,A_2,\ldots\in\mathcal{A}$ are such that $E\subseteq\bigcup_{i=1}^\infty A_i$, then
            \begin{equation*}
                \nu(E)\leq\nu\left(\bigcup_{i=1}^\infty A_i\right)\leq\sum\limits_{i=1}^\infty \nu(A_i)=\sum\limits_{i=1}^\infty \mu_0(A_i)
            \end{equation*}
            and it follows from definition of $\mu=\mu^*|_{\mathcal{M}}$ and $\nu(E)\leq\mu(E)$.

            Recall, from A1, that $\mathcal{A}_\sigma=\{\bigcup_{i=1}^\infty A_i:A_1,A_2,\ldots\in\mathcal{A}\}$.
            Then we have that $\mu|_{\mathcal{A}_\sigma}=\mu|_{\mathcal{A}_\sigma}$.
            If $A=\bigcup_{i=1}^\infty A_i$, $A_i\in\mathcal{A}$, then
            \begin{align*}
                \nu(A) &= \lim_{n\to\infty} \nu\left(\bigcup_{i=1}^n A_i\right)\\
                       &= \lim_{n\to\infty} \mu_0\left(\bigcup_{i=1}^n A_i\right)\\
                       &= \lim_{n\to\infty}\mu\left(\bigcup_{i=1}^n A_i\right)=\mu(A)
            \end{align*}
            Now, let $E\in\mathcal{M}$ with $\mu(E)<\infty$.
            Given $\epsilon>0$, let $A_1,A_2,\ldots\in\mathcal{A}$ with $E\subseteq\bigcup_{i=1}^\infty A_i$ and such that
            \begin{equation*}
                \mu(E)+\epsilon=\mu^*(E)+\epsilon>\sum\limits_{i=1}^\infty\mu_0(A_i)
            \end{equation*}
            Hence, $\mu(E)\leq\mu(A)\leq\sum_{i=1}^\infty \mu(A_i)=\sum_{i=1}^\infty \mu_0(A_i)<\mu(E)+\epsilon$.
            Thus $\mu(A\setminus E)=\mu(A)-\mu(E)<\epsilon$.
            Hence, as $A\in\mathcal{A}_\sigma$, $\mu(A)=\nu(A)$ and we have
            \begin{align*}
                \mu(E)\leq\mu(A) &= \nu(A)=\nu(A\cap E)+\nu(A\setminus E)\\
                                 &\leq \nu(A\cap E)+\mu(A\setminus E)\\
                                 &= \nu(E)+\epsilon
            \end{align*}
            Since $\epsilon>0$ is arbitrary, $\mu(E)\leq\nu(E)$, so equality must hold.

            Now, if $(X,\mathcal{M},\mu)$ is $\sigma-$finite, we can write $X=\bigcup_{i=1}^\infty X_i$ where $X_i\in\mathcal{M}$, $\mu(X_i)<\infty$, and $X_1\subseteq X_2\subseteq\cdots$.
            If $E\in\mathcal{M}$, then $E=\bigcup_{i=1}^\infty(X_i\cap E)$, so
            \begin{align*}
                \mu(E) &= \lim_{n\to\infty}\mu(X_n\cap E)\\
                       &= \lim_{n\to\infty}\nu(X_n\cap E)=\nu(E)
            \end{align*}
    \end{enumerate}
\end{proof}
\begin{remark}
    The uniqueness also holds if we have that $(X,\mathcal{M},\mu)$ is semifinite.
    Indeed, by A1, if $E\in\mathcal{M}$,
    \begin{equation*}\mu(E)=\sup\{\mu(F):F\in\mathcal{M},F\subseteq E,\mu(F)<\infty\}=\sup\{\nu(F):F\in\mathcal{M},F\subseteq E,\mu(F)<\infty\}\leq\nu(E)\leq\mu(E)\end{equation*}
\end{remark}
\begin{corollary}
    Given a measure space $(X,\mathcal{M},\mu)$, there is a complete measure space $(X,\overline{\mathcal{M}},\overline{\mu})$ such that $\overline{\mu}|_{\mathcal{M}}=\mu$.
    Furthermore, if $(X,\mathcal{M},\mu)$ is a $\sigma-$finite then any $E\in\mathcal{M}$ admits a representation of the form $E=M\cup N$, where $M\in\mathcal{M}$, $N\subseteq N'$ where $N'\in\mathcal{M}$ with $\mu(N')=0$.
\end{corollary}
\begin{proof}
    We regard $(X,\mathcal{M},\mu)$ is a pre-measure space.
    Then the last theorem provides an outer measure $\mu^*$ so that $\mu^*|_{\mathcal{M}}=\mu$ and if
    \begin{equation*}
        \mathcal{M}=\{A\in\mathcal{P}(X):\mu^*(E)\geq\mu^*(E\cap A)+\mu^*(E\setminus A)\forall E\in\mathcal{P}(X)\}
    \end{equation*}
    then $\mathcal{M}\subseteq\overline{\mathcal{M}}$.
    Let $\overline{\mu}=\mu^*|_{\overline{\mathcal{M}}}$.
    We appeal to A1, Q4 to see the structure of $E\in\overline{\mathcal{M}}$.
    We have $X\setminus E\in\mathcal{M}$ and we have $X\setminus E=A\setminus M$, where $A\in\mathcal{M}_{\sigma\delta}$ and $\mu^*(N)=0$.
    For each $n$, we can find $A_{n1},A_{n2},\ldots\in\mathcal{A}$ such that $N\subseteq\bigcup_{i=1}^\infty A_{ni}:=A_n$ and $\sum_{i=1}^\infty \mu(A_{ni})<1/n=\mu^*(N)+1/n$.
    Thus $N\subseteq A_n$, $A_n\in\mathcal{M}$.
    Thus $N\subseteq\bigcap_{n=1}^\infty A_n=N'$ and $N'\in\mathcal{M}$ and $\mu(N')\leq\mu(A_n)<1/n$ for each $n$.
    Now,
    \begin{align*}
        E&=X\setminus(X\setminus E)\\
         &=X\setminus(A\setminus N)\\
         &=(X\setminus A)\cup N
    \end{align*}
\end{proof}
The past few theorems give an important abstract construction: given $(X,\mathcal{A},\mu_0)$ premeasure, get an outer measure $\mu^*$, and by Caratheodory, extract a measure space $(X,\mathcal{M},\mu)$, $\mathcal{M}\supseteq\mathcal{A}$, $\mu|_{\mathcal{A}}=\mu_0$.
\section{Building \texorpdfstring{$\sigma-$}{s-}algebras}
\begin{lemma}
    Let $X$ be a non-empty set.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $\{M_i\}_{i\in I}$ is a family of $\sigma-$algebras on $X$, then $\bigcap_{i\in I}\mathcal{M}_i\subseteq\mathcal{P}(X)$.
        \item Given $\emptyset\neq\mathcal{E}\subseteq\mathcal{P}(X)$, the family $\sigma\langle\mathcal{E}\rangle=\cap\{\mathcal{M}:\mathcal{M}\text{ is a $\sigma-$algebra on }X,\mathcal{E}\subseteq\mathcal{M}\}$.
            This is the \textbf{$\sigma-$algebra generated by $\mathcal{E}$}.
        \item If $\emptyset\neq\mathcal{F}\subseteq\sigma\langle\mathcal{E}\rangle$ in $\mathcal{P}(X)$, then $\sigma\langle\mathcal{F}\rangle=\sigma\langle\mathcal{E}\rangle$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item It is easy to check the $\sigma-$algebra axioms.
        \item Application of (i)
        \item We see that $\sigma\langle\mathcal{E}\rangle$ is a $\sigma-$algebra containing $\mathcal{F}$.
            Part (ii) tells us that $\sigma\langle\mathcal{F}\rangle$ is the smallest $\sigma-$algebra containing $\mathcal{F}$.
    \end{enumerate}
\end{proof}
As with (ii), we may define $\langle\mathcal{E}\rangle=\bigcap\{\mathcal{A}:\mathcal{A}\text{ is an algebra on }X,\mathcal{E}\subseteq\mathcal{A}\}$.
\begin{definition}
    Let $(X,\tau)$ be a topological space.
    The \textbf{Borel $\sigma-$algebra} $\mathcal{B}(X,\tau)=\mathcal{B}(X)=\sigma\langle\tau\rangle$.
\end{definition}
\begin{remark}
    If $\mathcal{F}=\{F\subseteq X:F\text{ is closed}\}$, then $\mathcal{F}\subseteq\sigma\langle\tau\rangle$.
    Thus $\sigma\langle\mathcal{F}\rangle\subseteq\sigma\langle\mathcal{G}\rangle$.
    Similarly, the opposite inclusion holds, so these sets are equal.
\end{remark}
\begin{proposition}
    Let $\mathcal{B}(\R)$ denote the Borel $\sigma-$algebra on $\R$.
    Consider the following families of subsets of $\R$:
    \begin{enumerate}[nolistsep]
        \item $\mathcal{O}=\{(a,b):-\infty\leq a\leq b\leq\infty\}$, $(a,a)=\emptyset$.
        \item $\mathcal{O}_\infty=\{(a,\infty):-\infty\leq a\in\R\}$.
        \item $\mathcal{H}=\{(a,b]:-\infty\leq a\leq b\leq\infty\text{ in }\R\}$, $(a,\infty]=(a,\infty)$, $(a,a]=\emptyset$.
        \item $\mathcal{C}_\infty\{[a,\infty):-\infty<a\in\R\}$.
    \end{enumerate}
    Then $\mathcal{B}(\R)=\sigma\langle\mathcal{O}\rangle=\sigma\langle\mathcal{O}_\infty\rangle=\sigma\langle\mathcal{H}\rangle=\sigma\langle\mathcal{C}_\infty\rangle$.
\end{proposition}
\begin{proof}
    This follows since $\tau$ has a countable base.
\end{proof}
\begin{definition}
    An \textbf{elemtary family} of sets on $X$ is any $\mathcal{E}\subseteq\mathcal{P}(X)$ such that
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $X\in\mathcal{E}$
        \item If $E,F\in\mathcal{E}$, $E\cap F=\bigcup_{i=1}^n E_i$ with $E_i\in\mathcal{E}$
        \item If $E\in\mathcal{E}$, $X\setminus F=\bigcup_{j=1}^m E_j$, $E_1,\ldots,E_j\in\mathcal{E}$.
    \end{enumerate}
\end{definition}
A simple induction arguement shows that any finite intersection of elements of $\mathcal{E}$ is a finite union of elements in $\mathcal{E}$.
\begin{example}
    In $\R$, $\mathcal{H}=\{(a,b]:-\infty\leq a\leq b\leq\infty\}$ is an elementary family. %)
\end{example}
\begin{lemma}
    If $\mathcal{E}\subseteq\mathcal{P}(X)$ is an elementary family, then $\mathcal{E}=\{\bigcup_{i=1}^n E_i,E_i\in\mathcal{E},n\in\N\}$.
\end{lemma}
\begin{proof}
    It suffices to see that the RHS is an algebra.
    It is clearly closed under finite unions.
    Let $E_1,\ldots,E_n\in\mathcal{E}$, and write each $X\setminus E_i=\bigcup_{j=1}^m E_{ij}$.
    Now we consider
    \begin{align*}
        X\setminus\left(\bigcup_{i=1}^n E_i\right)&=\bigcap_{i=1}^n(X\setminus E_i)=\bigcap_{i=1}^n\bigcup_{j=1}^m E_{ij}\\
                                                  &=\bigcup_{1\leq j_i\leq n,1\leq i\leq n}E_{ij_1}\cap\cdots\cap E_{nj_n}
    \end{align*}
    where each finite intersection is a finite union of elements of $\mathcal{E}$ by the last remark.
\end{proof}
\begin{corollary}
    In $\R$, $\langle\mathcal{H}\rangle=\{\bigcup_{i=1}^n (a_i,b_i]:-\infty\leq a_i\leq b_i\leq\infty\}$. %)
\end{corollary}
Let $\mathcal{A}=\langle \mathcal{H}\rangle\subseteq\mathcal{P}(\R)$.
We will build many premeasures on $\mathcal{A}$.
\section{Measures on \texorpdfstring{$\R$}{R}}
\begin{definition}
    We consider the non-decreasing, right-continuous functions
    \begin{equation*}
        \ND_r(\R)=\{F:\R\to\R|x<y\Rightarrow F(x)\leq F(y); \lim_{x\to a^+}F(x)=F(x)\}
    \end{equation*}
\end{definition}
\begin{lemma}
    Let $F\in\ND_r(\R)$ and $\mathcal{A}=\langle\mathcal{H}\rangle\subset\mathcal{P}(\R)$, the algebra generated by half-open half-closed intervals.
    Then $\mu_{0,F}:\mathcal{A}\to[0,\infty]$,
    \begin{equation*}
        \mu_{0,F}\left(\bigcupdot_{i=1}^n(a_i,b_i)\right)=\sum\limits_{i=1}^n (F(b_i)-F(a_i))
    \end{equation*}
    Here, $b-(-\infty)=\infty$ for $-\infty<b\leq\infty$.
\end{lemma}
\begin{proof}
    For simplicity, write $\mu_0=\mu_{0,F}$.
    It is evident that $\mu_0$ is well-defined and that $\mu_0(\emptyset)=0$.
    It remains to show that $\mu_0$ has restricted $\sigma-$additivity.

    (I) Suppose $(a,b]=\bigcupdot_{j=1}^\infty(c_j,d_j]$, $-\infty<a<b<\infty$.
    We wish to see that $\mu_0((a,b])=\sum_{j=1}^\infty \mu_0((c_j,d_j])$.
    First, given $n\in\N$, there is a bijection $\sigma:[n]\to[n]$ such that $c_{\sigma(1)}\leq d_{\sigma(1)}\leq\cdots\leq c_{\sigma(n)}\leq d_{\sigma(n)}$.
    Then, as $F$ is non-decreasing, we have
    \begin{align*}
        \sum\limits_{j=1}^n \mu_0((c_j,d_j]) &= \sum\limits_{j=1}^n (F(d_j)-F(c_j))\\
                                             &= \sum\limits_{j=1}^n (F(d_{\sigma(j)})-F(c_{\sigma(j)}))\\
                                             &= F(d_{\sigma(n)})\underbrace{-F(c_{\sigma(n)})+F(d_{\sigma(n-1)})}_{\leq 0}+\cdots-F(c_{\sigma(1)})\\
                                             &\leq F(d_{\sigma(n)}-F(c_{\sigma(n)})\\
                                             &\leq \mu_0((a,b])
    \end{align*}
    To see the converse inequality, let $\epsilon>0$ and, since $F$ is right-continuous, we may find
    \begin{itemize}[nolistsep]
        \item $\delta_0>0$ such that $a+\delta_0<b$ and $F(a+\delta_0)<F(a)+\epsilon/2$.
        \item for each $j$, find $\delta_j>0$ such that $F(d_j+\delta_j)<F(d_j)+\epsilon/2^{j+1}$
    \end{itemize}
    Then $\{(c_j,d_j+\delta_j)\}_{j=1}^\infty$ is a cover of $[a+\delta_0,b]$ and hence, by compactness, we have that $[a+\delta_0,b]\subseteq_{j=1}^n(c_j,d_j+\delta_j)$ for some $n$.
    Let $\sigma:[n]\to[n]$ be as in $(f)$.
    Notice that
    \begin{itemize}
        \item $c_{\sigma(1)}<a_{\delta_0}$ implies $F(c_{\sigma(1)})\leq F(a+\delta_0)<F(a)+\epsilon/2$.
        \item For $j=1,\ldots,n-1$, $c_{\sigma(j+1)}<d_{\sigma(j)}+\delta_{\sigma(j)}$ implies $F(c_{\sigma(j+1)})\leq F(d_{\sigma(j)}+\delta_{\sigma(j)})<F(d_{\sigma(j)})+\epsilon/2^{\sigma(j)+1}$
        \item $b<d_{\sigma(n)}+\delta_{\sigma(n)}$ implies $F(b)<F(d_{\sigma(n)})+\epsilon/2^{\sigma(n)+1}$.
    \end{itemize}
    Thus
    \begin{align*}
        \sum\limits_{j=1}^\infty \mu_0((c_j,d_j]) &\geq \sum\limits_{j=1}^n \mu_0((c_j,d_j])\\
                                                  &= \sum\limits_{j=1}^n(F(d_j)-F(c_j))\\
                                                  &= F(d_{\sigma(n)})+\sum\limits_{j=1}^{n-1}(F(d_{\sigma(j)})-F(c_{\sigma(j+1)}))-F(c_{\sigma(1)})\\
                                                  &> \left(F(b)-\frac{\epsilon}{2^{\sigma(n)+1}}\right)+\sum\limits_{j=1}^{n-1}\left(-\frac{\epsilon}{2^{\sigma(j)+1}}\right)-\left(F(a)+\frac{\epsilon}{2}\right)\\
                                                  &> F(b)-F(a)-\epsilon=\mu_0((a,b])-\epsilon
    \end{align*}
    and since $\epsilon>0$ is arbitrary, our desired inequality holds.

    (I') Do similar for $(-\infty,b]$, $(a,\infty]$ (Exercise).

    (II) If $A,A_1,A_2,\ldots\in\mathcal{A}$, $A=\bigcupdot_{j=1}^n(a_i,b_i]$ and for each $i,j$, $(a_i,b_j]\cap A_j=\bigcupdot_{k=1}^{m_{ij}}(c_{ijk},d_{ijk}]$.
    From (I),(I'), we have that
    \begin{equation*}
        (a_i,b_i]=\bigcupdot_{j=1}^\infty\bigcup_{k=1}^{m_{ij}}(c_{ijk},d_{ijk}] %)
    \end{equation*}
    so that
    \begin{equation*}
        \mu_0((a_i,b_i])=\sum\limits_{j=1}^\infty\sum\limits_{k=1}^{m_{ij}}\mu_0((c_{ijk},d_{ijk}]) %))
    \end{equation*}
    so we have
    \begin{align*}
        \mu_0(A) &= \sum\limits_{i=1}^n \mu_0((a_i,b_i])\\
                 &= \sum\limits_{i=1}^n\sum\limits_{j=1}^\infty\sum\limits_{k=1}^{m_{ij}}\mu_0((c_{ijk},d_{ijk}])\\
                 &=\sum\limits_{j=1}^\infty\sum\limits_{i=1}^n\sum\limits_{k=1}^{m_{ij}}\mu_0((c_{ijk},d_{ijk}])\\
                 &= \sum\limits_{j=1}^\infty \mu_0(A_j)
    \end{align*}
    since each $A_j=\bigcupdot_{i=1}^n\bigcupdot_{k=1}^{m_{ij}}(c_{ijk},d_{ijk}]$.
\end{proof}
\begin{definition}
    A measure $\mu:\mathcal{B}(\R)\to[0,\infty]$ is called \textbf{locally finite} if $\mu_0([-a,a])<\infty$ for $a>0$ in $\R$.
\end{definition}
This is equivalent to having $\mu(K)<\infty$ for each compact $K\subset\R$.
As well, locally finite measures are $\sigma-$finite.
\begin{theorem}
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item For each $F$ in $\ND_r(\R)$, there is a unique locally finite measure $\mu_F:\mathcal{B}(\R)\to[0,\infty]$ such that $\mu_F((a,b])=F(b)-F(a)$ for any finite $a,b$.
        \item Every locally finite measure appears as in (i)
        \item If $F,G\in\ND_r(\R)$, then $\mu_F=\mu_G$ if and only if $F-G$ is constant.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item The last lemma provides a premeasure $(\R,\langle\mathcal{H}\rangle,\mu_{0,F})$, where $\mu_{0,F}((a,b])=F(b)-F(a)$ for $-\infty\leq a\leq b\leq\infty$. %)
            This gives rise to a measure $\mu_F^*:\mathcal{P}(\R)\to[0,\infty]$, and its $\sigma-$algebra $\mathcal{F}$ of $\mu_F^*-$measurable sets.
            Notice that a prior proposition provides that $\mathcal{B}(\R)=\sigma\langle\mathcal{H}\rangle$, so since $\mathcal{H}\subseteq \langle H\rangle\subseteq\mathcal{M}_F$, we have that $\mathcal{B}(\R)=\sigma\langle\mathcal{H}\rangle\subseteq\mathcal{M}_F$.
            Then, we let $\mu_F=\mu^*_F|_{\B(\R)}:\B(\R)\to[0,\infty]$.
            Notice, for $a>0$ in $\R$, that
            \begin{equation*}
                \mu_F([-a,a])\leq \mu_F((-a-1,a])=F(a)-F(-a-1)<\infty
            \end{equation*}
            so $\mu_F$ is locally finite, and hence $\sigma-$finite.
            Thus $\mu_F$ is the unique extension of $\mu_{0,F}$ to $\B(\R)$ (or even to $\M_F$).
        \item Let $\mu:\B(\R)\to[0,\infty]$ be a locally inite measure.
            Then for $x\in\R$, we let
            \begin{equation*}
                F(x)=\begin{cases}\mu((0,x])&:x\geq 0\\-\mu((x,0])&:x<0\end{cases}
            \end{equation*}
            We will see that $F\in\ND_r(\R)$.
            If $x<y$ in $\R$:
            \begin{itemize}[nolistsep]
                \item If $x\geq 0$, then $(0,x]\subseteq(0,y]$ so $F(x)=\mu((0,x])\leq\mu((0,y])=F(y)$
                \item If $y<0$, then $(y,0]\subseteq(x,0]$ so $\mu((y,0])\leq\mu((x,0])$, so $F(x)=-mu((x,0])\leq -\mu((y,0]F(y)$.
                \item If $x<0\leq y$, then $F(x)=-\mu((x,0])\leq 0\leq \mu((0,y])=F(y)$.
            \end{itemize}
            To see right continuity, it suffices to see for $x\in\R$, we have $F(x)=\lim_{n\to\infty} F(x_n)$, where $(x_n)\to x$ monotonically from the right.
            Thus, given $x$, $(x_n)_{n=1}^\infty$, we have
            \begin{equation*}
                F(x_n)-F(x)=\mu((x,x_n])\underset{n\to\infty}\longrightarrow\mu(\emptyset)=0 %)
            \end{equation*}
            by continuity from above for measures.

            Notice that for $a<b$ in $\R$, $\mu_F((a,b])=\mu((a,b])$, which by uniqueness in part (i) shows that $\mu=\mu_F$.
        \item $\mu_F=\mu_G$ if and only if for $x\in\R$,
            \begin{equation*}
                \begin{cases}
                    F(x)-F(0)=\mu_F((0,x])=\mu_G((0,x])=F(x)-G(0)&: x\geq 0\\
                    F(0)-F(x)=\mu_F((x,0])=\mu_G((x,0])=G(0)-G(x)&: x<0
                \end{cases}
            \end{equation*}
            if and only if $F(x)-G(x)=F(0)-G(0)$ is constant.
    \end{enumerate}
\end{proof}
Let $F\in\ND_r(\R)$, $a<b$ in $\R$,
\begin{enumerate}[nolistsep]
    \item $(a,b)=\bigcup_{n=1}^\infty(a,b-1/n]$ so
        \begin{align*}
            \mu_F((a,b)) &= \lim_{n\to\infty}\mu_F((a,b-1/n])\\ %)
                         &= \lim_{n\to\infty}[F(b-1/n)-F(a)]\\
                         &= F(b^-)-F(a)
        \end{align*}
    \item As above,
        \begin{align*}
            \mu_F([a,b]) &= \lim_{n\to\infty}\mu_F((a-1/n,b])\\ %)
                         &= F(b)-F(a^-)
        \end{align*}
        In particular, $\mu_F(\{a\})=\mu_F([a,a])=F(a)-F(a^-)$, so $\mu_F(\{a\})=0$ if and only if $F$ is continuous at $a$.
\end{enumerate}
\subsection{Point Mass/Dirac Measure}
Fix $a\in\R$.
Let $H_a\in\ND_r(\R)$ where
\begin{equation*}
    H_a(x)=1_{[a,\infty)}(x)=\begin{cases}1&:x\in[a,\infty)\\0&:\text{otherwise}\end{cases}
\end{equation*}
Let $\delta_a:\B(\R)\to[0,\infty]$, where
\begin{equation*}
    \delta_a(A)=\begin{cases}1&:a\in A\\0&:a\notin A\end{cases}
\end{equation*}
Notice that if $c<d$ in $\R$, then
\begin{equation*}
    \delta_a((c,d])=\begin{cases}1 &:c<a\leq d\\0&:\text{otherwise}\end{cases}=H_a(d)-H_a(c) %)
\end{equation*}
\subsection{Lebesgue Measure}
Let $I(x)=x$, $I\in\ND_r(\R)$.
We let $\lambda=\mu_I$ and $\mathcal{L}=\M_I\supseteq\B(\R)$ denote the Lebesgue measure and Lebesgue $\sigma-$algebra.
\begin{theorem}
    \begin{enumerate}[nolistsep]
        \item $(\R,\mathcal{L},\lambda)$ is translation invariant: for $x\in\R$, $E\in\mathcal{L}$, we have $E+x\in\mathcal{L}$ and $\lambda(E+x)=\lambda(E)$.
        \item If $\mu:\B(\R)\to[0,\infty]$ is a locally finite measure, which is translation-invariant.
            Then $\mu=c\lambda$ for some $c\geq 0$ in $\R$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    (I) If $-\infty\leq a\leq b\leq\infty$, then $\lambda((a,b]+x)=\mu_I((a+x,b+x])=b-a=\lambda((a,b])$.
    Hence if $A\in\langle H\rangle$, $\mu_I(A+x)=\mu_I(A)$ for $x\in\R$.
    If $E\in\mathcal{P}(\R)$, $E\subseteq\bigcup_{i=1}^\infty A_i$, $A_i\in\langle\mathcal{H}\rangle$ if and only $E+x\subseteq\bigcup_{i=1}^\infty(A_i+x)$.
    Thus, by definition of $\mu_I^*$, we see that $\mu_I^*(X+e)=\mu_I^*(E)$.
    Now, if $A\in\mathcal{L}$, $E\in\mathcal{P}(\R)$, then
    \begin{align*}
        \mu_I^*(E\cap (A+x))+\mu_I^*(E\setminus(A+x)) &= \mu_I^*([(E-x)\cap A]+x)+\mu_I^*([(E-x)\setminus A]+x)\\
                                                      &= \mu_I^*((E-x)\cap A)+\mu_I^*((E-x)\setminus A)\\
                                                      &\leq \mu_I^*(E-x)=\mu_I^*(E)
    \end{align*}
    so $A+x\in\mathcal{L}$.
    
    (II) We let $\mu=\mu_F$ where $F\in\ND_r(\R)$.
    In fact, we may let $F(0)=0$, so
    \begin{equation*}
        F(x)=\begin{cases} \mu((0,x]) &:x\geq 0\\-\mu((x,0])&:x<0\end{cases}
    \end{equation*}
    Then for $y\geq 0$, we have
    \begin{equation*}
        F(y)=\mu((0,y])=\mu((x,x+y])=F(x+y)-F(x)
    \end{equation*}
    so $F(x)+F(y)=F(x+y)$.
    Thus if $x\geq 0$, $F(nx)=nF(x)$ for $n\in\N$.
    Thus $F(x/n)=F(x)/n$, $0=F(0)=F(-x)+F(x)$, $x\geq 0$, so $F(-x)=-F(x)$.
    Thus $F:\R\to\R$ is additive and $F(qx)=qF(x)$ for $x\in\R$, $q\in\Q$.
    Now, given $x\in\R$, let $(q_n)$ be a rational sequence so $q_n\geq x$, $\lim q_n=x$, and we have
    \begin{equation*}
        F(x)=\lim F(q_n)=\lim q_nF(1)=F(1)x
    \end{equation*}
    Let $c=F(1)=\mu((0,1])\geq 0$.
    By uniqueness, $\mu=\mu_{cI}=c\lambda$.
\end{proof}
\section{Cantor's Sets and Functions}
Fix $0<\alpha\leq 1$.
Let $I_{01}=[0,1]$ and $J_{01}$ be the open middle of length $\alpha/3$.
Notice that $I_{01}\setminus J_{01}=I_{11}\dot{\cup}I_{12}$, each a closed interval, with $\lambda(I_{1k})<1/2$, $k=1,2$.
Having constructed closed intervals $I_{m1},\ldots,I_{m2^m}$, each of length at most $1/2^m$, we let for each $k=1,\ldots,2^m$, $J_{mk}$ denote the open middle of length $\alpha/3^{m+1}$.
Then each $I_{mk}\setminus J_{mk}=I_{m+1,2k-1}\dot{\cup}I_{m+1,2k}$.

Let $C_{\alpha,n}=\bigcup_{k=1}^{2^n}I_{nk}$, so $C_{\alpha,n}$ is compact.
Notice that $C_{\alpha,1}\supseteq C_{\alpha,2}\supseteq\cdots$, then $C_\alpha:=\bigcap_{n=1}^\infty C_{\alpha,n}$ is empty and compact.
If $\alpha=1$, then $C=C_1$ is called the (middle thirds) \textbf{Cantor set}.
\begin{remark}
    \begin{enumerate}
        \item $C_\alpha$ is nowhere dense.
            Indeed, if $x\in C_\alpha$, $\epsilon>0$, let $n$ be so $1/2^n<2\epsilon$ and we see that $(x-\epsilon,x+\epsilon)\subsetneq I_{nk}$ for any $k=1,\ldots,2^n$.
            Thus $(x-\epsilon,x+\epsilon)\cap(\R\setminus C_\alpha)\neq\emptyset$.
        \item We can compute
            \begin{align*}
                \lambda(C_\alpha)&=\lambda([0,1])-\lambda([0,1]\setminus C_\alpha)\\
                                 &= 1-\lambda\left(\bigcup_{n=1}^\infty\bigcup_{k=1}^{2^n}J_{nk}\right)\\
                                 &= 1-\sum\limits_{n=1}^\infty\sum\limits_{k=1}^{2^n}\lambda(J_{nk})\\
                                 &= 1-\sum\limits_{n=1}^\infty \alpha\frac{\alpha}{3}\left(\frac{2}{3}\right)^n\\
                                 &= 1-\alpha
            \end{align*}
            In particular, $\lambda(C)=0$.
    \end{enumerate}
\end{remark}
Write each $I_{nk}=[a_{nk},b_{nk}]$.
Define $\phi_{\alpha,n}:\R\to\R$ by
\begin{equation*}
    \phi_{\alpha,n}=\begin{cases}
        0 &: x\in(-\infty,0)\\
        \frac{2k-1}{2^{m+1}} &: x\in J_{mk}\\
        \frac{1}{2^n(b_{mk}-a_{mk})}(x-a_{mk})+c_{mk} &: x\in I_{mk}\\
        1 &: x\in(1,\infty)
    \end{cases}
\end{equation*}
Each $\phi_{\alpha,n}$ is continuous and non-decreasing on $\R$, and $\norm{\phi_{\alpha,n}-\phi_{\alpha,n+1}}=\frac{1}{2^n}$.
Thus $(\phi_{\alpha,n})_{n=1}^\infty$ is uniformly Cauchy, so $\phi_\alpha:=\lim_{n\to\infty}\phi_{\alpha,n}$ exists and is continuous.
Furthermore, (1) tells us for $x<y$, $\phi_{\alpha}(x)\leq\phi_{\alpha}(y)$, so $\phi_{\alpha}\in\ND_r(\R)$ and is, in fact, continuous.
We let $\mu_{\phi_\alpha}$ denote the corresponding locally inite measure on $(\R,\B(\R))$.
If $\alpha=1$, $\mu_\phi=\mu_{\phi_1}$ is called the Cantor singular measure.

Note that $\mu_{\phi_\alpha}(C_\alpha)=1=\mu_{\phi_\alpha}(\R)$, so $\mu_{\phi_\alpha}(\R\setminus C_\alpha)=0$.
We say that $\mu_{\phi_\alpha}$ is \textbf{concentrated} on $C_\alpha$.
$\mathcal{M}_{\phi_\alpha}\supseteq\mathcal{P}(\R\setminus C_\alpha)$ as null sets for $\mathcal{M}_{\phi_\alpha}$.
\chapter{Integration Theory}
\section{Measurable Functions}
Let $X,Y$ be sets, $T:X\to Y$.
We define the \textbf{pullback} of a set $E\in\mathcal{P}(Y)$ by $T^{-1}(E)=\{x\in X:T(x)\subseteq E\}$.
If $\mathcal{E}\subseteq\mathcal{P}(Y)$, we write $T^{-1}(\mathcal{E})=\{T^{-1}(E):E\in\mathcal{E}\}$.
Note that
\begin{enumerate}
    \item $T^{-1}(Y\setminus E)=X\setminus T^{-1}(E)$
    \item $E_1,E_2,\ldots\subseteq Y$, $T^{-1}\left(\bigcup_{i=1}^\infty E_i\right)=\bigcup_{i=1}^\infty T^{-1}(E_i)$.
\end{enumerate}
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item If $\mathcal{N}$ is a $\sigma-$algebra on $Y$, then $T^{-1}(\mathcal{N})$ is a $\sigma-$algebra on $X$ (the pullback $\sigma-$algebra)
        \item If $\mathcal{M}$ is a $\sigma-$algebra on $X$, then $\{E\in\mathcal{P}(Y):T^{-1}(E)\in\mathcal{M}\}$ is a $\sigma-$algebra on $Y$
    \end{enumerate}
\end{proposition}
\begin{definition}
    Let $(X,\M)$, $(Y,\mathcal{N})$ be measurable spaces, and $T:X\to Y$.
    We say that $T$ is $\M-\mathcal{N}-$\textbf{measurable} provided that $T^{-1}(\mathcal{N})\subseteq\M$.
\end{definition}
\begin{proposition}
    Suppose $(X,\mathcal{M})$, $(Y,\mathcal{N})$, $T:X\to Y$ measurable, and $\mathcal{N}=\sigma\langle\mathcal{E}\rangle$.
    Then $T$ is $\mathcal{M}-\mathcal{N}-$measurable if and only if $T^{-1}(E)\in\mathcal{M}$ for $E\in\mathcal{E}$.
\end{proposition}
\begin{proof}
    The forward direction is obvious.
    Conversely, as in the previous proposition, $\mathcal{N}'=\{A\in\mathcal{P}(Y):T^{-1}(A)\in\M\}$ is a $\sigma-$algebra.
    We have that $\mathcal{E}\subseteq\mathcal{N}'$, so $\mathcal{N}=\sigma\langle\mathcal{E}\rangle\subseteq\mathcal{N}'$.
\end{proof}
\begin{corollary}
    Let $(X,\mathcal{M})$ be a measurable space, $f:X\to\R$.
    Then the following are equivalent:
    \begin{enumerate}
        \item $f$ is $\mathcal{M}-\mathcal{B}(\R)-$measurable
        \item $f^{-1}(G)\in\mathcal{M}$ for open $G\subseteq\R$.
        \item $f^{-1}((a,\infty))\in\mathcal{M}$ for $a$ in $\R$
        \item $f^{-1}([a,\infty))\in\mathcal{M}$ for $a$ in $\R$
        \item $f^{-1}((\infty,a))\in\mathcal{M}$ for $a$ in $\R$
        \item $f^{-1}((\infty,a])\in\mathcal{M}$ for $a$ in $\R$ %))
    \end{enumerate}
\end{corollary}
\begin{definition}
    A function $f:X\to\R$ satisfying the conditions above will be called $\mathcal{M}-$\textbf{measurable}.
\end{definition}
Certainly continuous functions are measurable.

For notation, let $f_n:\R\to\R$, $n\in\mathcal{N}$.
We let
\begin{equation}
    (\sup_{n\in\N} f_n)(x)=\sup_{n\in\N} f_n(x)\in\overline{\R}
\end{equation}
for $x\in \R$.
Let $a\in\R$, $(a,\infty]=\{x\in\overline{\R}:a<x\}$, and let $\mathcal{B}(\overline{\R})=\sigma\langle\mathcal{G}\cup\{\{-\infty\},\{\infty\}\}\rangle$.
Given a measurable space $(X,\mathcal{M})$, $f:X\to\overline{R}$, we say $f$ is $\mathcal{M}-$measurable if it is $\mathcal{M}-\mathcal{B}(\overline{\R})-$measurable.
Notice that if $f_n:X\to\R$, $n\in\N$, then $\sup_{n\in\N}f_n,\inf_{n\in\N}f_n:X\to\overline{R}$.
\begin{proposition}
    Let $(X,\mathcal{M})$ be a measurable space, $f_n:X\to\overline{\R}$, $n\in\N$ each be measurable.
    Then the following are measurable:
    \begin{enumerate}
        \item $\sup_{n\in\N}f_n$
        \item $\inf_{n\in\N}f_n$
        \item $\limsup_{n\to\infty}f_n$
        \item $\liminf_{n\to\infty}f_n$.
    \end{enumerate}
    Furthermore, if $\lim_{n\to\infty}f_n$ exists, it too is measurable.
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Fix $a\in\R$.
            Then
            \begin{align*}
                \left(\sup_{n\in\N}f_n\right)^{-1}((a,\infty]) &= \{x\in X:\sup_{n\in\N}\}f_n(x)>a\}\\ %)
                                                               &=\bigcup_{n=1}^\infty\{x\in X:f_n(x)>a\}\in\mathcal{M}
            \end{align*}
        \item For $a\in\R$, we have
            \begin{equation*}
                \left(\inf_{n\in\N}f_n^{-1}([-\infty,a))\right)=\bigcup_{n=1}^\infty\{x\in X:f_n(x)<a\}\in\mathcal{M} %]
            \end{equation*}
        \item
            \begin{equation*}
                \limsup_{n\to\infty}f_n(x)=\inf_{n\in\N}\underbrace{\sup_{k\geq n}f_k(x)}_{\text{measurable}}
            \end{equation*}
        \item Same as above
    \end{enumerate}
\end{proof}
\begin{definition}
    If $(X,\mathcal{M})$ and $(Y,\mathcal{N})$ are measurable spaces, we let the \textbf{product $\sigma-$algebra} of $\mathcal{M}$ and $\mathcal{N}$ be given by
    \begin{equation*}
        \mathcal{M}\otimes\mathcal{N}=\sigma\langle\{E\times F:E\in\mathcal{M},F\in\mathcal{N}\}\subseteq\mathcal{P}(X)
    \end{equation*}
\end{definition}
\begin{lemma}
    Let $\pi_X$, $\pi_Y$ denote the coordinate projections.
    Then
    \begin{enumerate}
        \item $\M\otimes\mathcal{N}=\sigma\langle\pi_X^{-1}(\mathcal{M})\cup\pi_Y^{-1}(\mathcal{N})\rangle$
        \item If $\mathcal{M}=\sigma\langle\mathcal{E},\mathcal{N}=\sigma\langle\mathcal{F}$, then $\M\otimes\mathcal{N}=\sigma\langle\{X\times F:E\in\mathcal{E},F\in\mathcal{F}\}\rangle$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}
        \item $E\times F=(E\times F)\cap(X\times F)=\pi^{-1}_X(E)\cap\pi^{-1}_Y(F)$.
            We see that $\{E\times F:E\in\mathcal{M},F\in\mathcal{N}\}\subseteq\sigma\langle\pi_X^{-1}(\mathcal{M})\cup\pi_Y^{-1}(\mathcal{N})\rangle$
            and $\pi_X^{-1}(\mathcal{M})\cup\pi_Y^{-1}(\mathcal{N})\subseteq\sigma\langle\{E\times F:E\in\mathcal{M},F\in\mathcal{N}\}\rangle$.
        \item
            \begin{align*}
                \M\otimes\mathcal{N} &= \sigma\langle\pi_X^{-1}(\mathcal{M})\cup\pi_Y^{-1}(\mathcal{N})\rangle\\
                                     &= \sigma\langle\pi_X^{-1}(\mathcal{E})\cup\pi_Y^{-1}(\mathcal{F})\rangle
            \end{align*}
            since $\sigma\langle\pi_X^{-1}(E)\rangle=\pi_X^{-1}(\mathcal{M})$.
    \end{enumerate}
\end{proof}
Let $(X,d)$ be a metric space, $\mathcal{G}(X)$ denote the open sets in $X$, and $\B$ the Borel $\sigma-$algebra.
If $\rho$ is an equivalent metric to $d$, then these metric generate the same open sets (and thus the same $\sigma-$algebra).
\begin{proposition}
    Let $(X,d_X),(Y,d_Y)$ be separable metric spaces, and let $\rho$ be any metric on $X\times Y$ such that $\rho\sim\rho_{\infty}$ (where $\rho_\infty((x,y),(x',y'))=\max\{d_X(x,x'),d_Y(y,y')\}$.
    Then $\mathcal{B}(X\times Y,\rho)=\mathcal{B}(X,d_X)\otimes\B(Y,d_Y)$.
\end{proposition}
\begin{proof}
    For $r>0$, $(x,y)\in X\times Y$, we have radius $r$ open balls.
    Since $X,Y$ are separable, write $G$ as a countable union of products of open balls in $X$ and $Y$.
    Thus $\mathcal{G}(X\times Y)\subseteq\B(X)\otimes\B(Y)$, so $\B(X\times Y)=\B(X)\times\B(Y)$.
    Conversely,
    \begin{align*}
        \B(X)\times\B(Y)&=\sigma\langle\{G\times H:G\subseteq X\text{ open},H\subseteq Y\text{ open}\}\rangle\\
                        &\subseteq\sigma\langle\mathcal{G}(X\times Y)\rangle\subseteq\B(X\times Y)
    \end{align*}
\end{proof}
Even without the separability assumption, $f$ always holds.
However, the converse inclusion is in doubt. (take $(\R,d)$ where $d$ is the discrete metric).

Also note, by induction, $\B(\R^d)=\B(\R)\otimes\cdots\otimes\B(\R)$.
\begin{proposition}
    If $(X,\mathcal{M})$, $(Y,\mathcal{N})$ and $(Z,\mathcal{O})$ are measurable spaces, $S:X\to Y$ and $T:Y\to Z$ are measurable, then $T\circ S:X\to Z$ is measurable.
\end{proposition}
\begin{proof}
    If $E\in\mathcal{O}$, then $(T\circ S)^{-1}(E)=S^{-1}(T^{-1}(E))\in\mathcal{M}$.
\end{proof}
\begin{proposition}
    If $(X,\mathcal{M})$ is a measurable space, and $T:X\to\R^d$, then $T$ is $\mathcal{M}-\mathcal{B}(\R)-$measurable if and only if each $\pi_k\circ T:X\to\R$ is $\mathcal{M}-$measurable.
\end{proposition}
\begin{proof}
    If $B\in\mathcal{B}(\R)$, then $(\pi_k\circ T)^{-1}(B)=T^{-1}(\pi_k^{-1}(B))$.
    Let's refer to this by ($*$).

    ($\Rightarrow$) We have that $\pi_k:\R^d\to\R$ is continuous, so $\pi_k^{-1}(G)$ is open for open $G$ in $\R$, and hence $\pi^{-1}(B)\in\mathcal{B}(\R^d)$ for $B$ above.
    Hence $T^{-1}(\pi_k^{-1}(B))\in\mathcal{M}$ by ($*$)

    ($\Leftarrow$) We have $(\pi_k\circ T)^{-1}(B)\in\mathcal{M}$ for $B$ above.
    We have that $\mathcal{B}(\R^d)=\sigma\langle\pi_1^{-1}(\B(\R))\cup\cdots\cup\pi_n^{-1}(\B(\R))\rangle$.
    Then by ($*$), we se that $T$ is $\mathcal{M}-\B(\R^d)-$measurable.
\end{proof}
\begin{corollary}
    $\C\cong\R^2$ and if $(X,\mathcal{M})$ is a measurable space, $T:X\to\C$, then $T$ is $\mathcal{M}-\B(\C)-$measurable if and only if $\Re(T)$, $\Im(T):X\to\R$ is $\mathcal{M}-$measurable.
\end{corollary}
\begin{definition}
    We call an $\mathcal{M}-\B(\C)-$measurable function an $\mathcal{M}-$measurable function.
\end{definition}
\begin{corollary}
    Arithmetic property of measurable functions.
    Let $(X,\mathcal{M})$ be a measurable space; $f,g:X\to\C$ each be measurable.
    Then $f+g,fg:X\to\C$ are each $\mathcal{M}-$measurable.
\end{corollary}
\begin{proof}
    Consider $\alpha:\C^2\to\C$, $m:\C^2\to\C$ given by $\alpha(z,w)=z+2$, $m(z,w)=zw$ are continuous functions and thus $\B(\C^2)-\B(\C)-$measurable.
    We define $F:X\to\C^2$ by $F(x)=(f(x),g(x))$.
    By a modification of the last proposition, $\C^2$ playing the role of $\R^d$, we see that $F$ is $\M-\B(\C)-$measurable.
    Then $f+g=\alpha\circ F$, $fg=m\circ F$.
\end{proof}
\section{Integration}
\begin{definition}
    If $(X,\mathcal{M})$ is a measurable space, let $\mathcal{S}^+(X,\mathcal{M})=\{\phi:X\to[0,\infty):|\phi(x)|<\infty,\phi\text{ is measurable}]\}$.
\end{definition}
\begin{lemma}
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \item If $E\in\mathcal{P}(X)$, then $1_E\in\mathcal{S}^+(X,\M)$ if and only if $E\in\mathcal{M}$. %]
        \item If $\phi:X\to[0,\infty)$ then $\phi\in\mathcal{S}^+(X,\M)$ if and only if there are $0\leq a_1<a_2<\cdots<a_n$, $E_1,\ldots,E_n\in\mathcal{M}$ pairwise disjoint, so that $\phi=\sum_{i=1}^n a_i 1_{E_i}$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \item Clearly $1_E(X)\subseteq[0,\infty)$. %]
            If $B\in\B(\R)$, then
            \begin{equation*}
                1_E^{-1}(B)=\begin{cases}
                    \emptyset&:\{0,1\}\cap B=\emptyset\\
                    E&:\{0,1\}\cap B=\{1\}\\
                    X\setminus E&:\{0,1\}\cap B=\{0\}\\
                    X&:\{0,1\}\subseteq B
                \end{cases}
            \end{equation*}
        \item ($\Leftarrow$).
            Use (i) and arithmetic of measurable functions.

            ($\Rightarrow$) Let $\{a_1,\ldots,a_n\}=\phi(X)$.
            Then let $E_i=\phi^{-1}(\{a_i\})$.
    \end{enumerate}
\end{proof}
\begin{definition}
    If $(X,\mathcal{M},\mu)$ ie a measure space, define $I_\mu:\mathcal{S}^+(X,\M)\to[0,\infty]$ by $I_\mu(\phi)=\sum_{i=1}^n a_i\mu(E_i)$ where $\phi$ is in standard form.
    Here, we say $a\cdot\infty=\infty$ if $a\neq 0$, and $0\cdot\infty=0$.
\end{definition}
\begin{proposition}
    Let $\phi,\psi\in\mathcal{S}^+(X,\M)$.
    Then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $\phi\leq\psi$ (pointwise), then $I_\mu(\phi)\leq U_\mu(\psi)$.
        \item If $c\in[0,\infty)$, then $I_\mu(\phi+c\psi)=I_\mu(\phi)+cI_\mu(\psi)$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Write $\phi=\sum_{i=1}^n a_i1_{E_i}$, $\psi=\sum_{i=1}^n b_i1_{F_i}$ in standard forms.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item
            \begin{align*}
                I_\mu(\phi) &= \sum\limits_{i=1}^na_i\mu(E_i)\\
                            &=\sum\limits_{i=1}^n a_i\sum\limits_{j=1}^m \mu(E_i\cap _i)\\
                            &=\sum\limits_{j=1}^m\sum\limits_{i=1}^na_i\mu(E_i\cap F_i)\\
                            &\leq \sum\limits_{j=1}^m\sum\limits_{i=1}^n b_i\mu(E_i\cap F_i)\\
                            &= \sum\limits_{j=1}^m b_j\mu(F_j)=I_\mu(\psi)
            \end{align*}
        \item Notice that $1_E1_F=1_{E\cap F}$.
            We have
            \begin{align*}
                \phi+c\psi&=\sum\limits_{j=1}^m 1_{F_j}\sum\limits_{i=1}^n a_i1_{E_i}+\sum\limits_{i=1}^n 1_{E_i}\sum\limits_{j=1}^m cb_j1_{F_j}\\
                          &=\sum\limits_{i=1}^n\sum\limits_{j=1}^m(a_i+cb_j)1_{E_i\cap F_j}
            \end{align*}
            Let $\{c_1,\ldots,c_p\}=\{a_i+cb_j:i=1,\ldots,n;j=1,\ldots,m\}$ (distinct enumeration) and for $k=1,\ldots,\mu$, and $G_k=\bigcup E_i\cap F_j$ (union over appropriate indices) so $\phi+c\psi=\sum_{k=1}^p c_k 1_{G_k}$.
            Then
            \begin{align*}
                I_\mu(\phi+c\psi)&=\sum\limits_{k=1}^p c_k\mu(G_k)\\
                                 &=\sum\limits_{i=1}^n\sum\limits_{j=1}^m (a_i+cb_j)\mu(E_i\cap F_j)\\
                                 &= \sum\limits_{i=1}^n a_i\mu(E_i)+c\sum\limits_{j=1}^m b_j\mu(F_j)\\
                                 &= I_\mu(\phi)+cI_\mu(\psi)
            \end{align*}
    \end{enumerate}
\end{proof}
\begin{corollary}
    \begin{enumerate}
        \item If $f,g\in\overline{M}^+(X,\M)$, $c\geq 0$, then $f+cg\in\overline{M}^+(X,\M)$ and $\int_X(f+cg)\d{\mu}=\int_X f\d{\mu}+c\int_Xg\d{\mu}$.
        \item If $(f_k)_{k=1}^\infty\subset\overline{M}^+(X,\M)$, then $\sum_{k=1}^\infty f_k\in\overline{M}^+(X,\M)$ and $\int_X\left(\sum_{k=1}^\infty f_k\right)\d{\mu}=\sum_{k=1}^\infty\int_X f_k\d{\mu}$.
        \item If $f\in\overline{M}^+(X,\M)$, then $\mu_f:\M\to[0,\infty]$, $\mu_f(E)=\int_X(1_Ef)\d{\mu}$ defines a measure.
    \end{enumerate}
\end{corollary}
\begin{proof}
    \begin{enumerate}
        \item Let $(\phi_n)_{n=1}^\infty\subset S_f^+$, so $\phi_1\leq\phi_2\leq\cdots$, $\lim_{n\to\infty}\phi_n$ and $(\psi_n)_{n=1}^\infty\subset S_g^+$.
            Then $(\phi_n+c\psi_n)_{n=1}^\infty\subset S^+_{f+cg}$ with $\phi_1+c\psi_1\leq\phi_2+c\psi_2\leq\cdots$ and $\lim(\phi_n+c\psi_n)=f+cg$.
            Thus $f+cg\in\overline{M}^+(X,\M)$.
            Furthermore, MCT provides
            \begin{align*}
                \int_X (f+cg)\d{\mu} &= \lim_{n\to\infty}\int_X(\phi_n+c\psi_n)\d{\mu}\\
                                     &= \lim_{n\to\infty}\left(\int_X\phi_n\d{\mu}+c\int_X\psi_n\d{\mu}\right)\\
                                     &= \lim_{n\to\infty}\int_X\phi_n\d{\mu}+c\lim_{n\to\infty}\int_X\psi_n\d{\mu}\\
                                     &= \int_X\d{\mu}+c\int_Xg\d{\mu}
            \end{align*}
        \item Let $g_n=\sum_{k=1}^n f_k$.
            Then $g_1\leq g_2\leq\cdots$ with $\sum_{k=1}^\infty f_k=\lim_{n\to\infty}g_n$.
            We apply (1), and by MCT, we have
            \begin{align*}
                \int_X\sum\limits_{k=1}^\infty f_k\d{\mu} &=\int_X\lim_{n\to\infty} g_n\d{\mu}\\
                                                          &=\lim_{n\to\infty}\int_X g_n\d{\mu}\\
                                                          &=\lim_{n\to\infty}\sum\limits_{k=1}^n\int_Xf_k\d{\mu}\\
                                                          &=\sum\limits_{k=1}^\infty\int_X f_k\d{\mu}
            \end{align*}
        \item Notice that $1_\emptyset=0$, so $\mu_f(\emptyset)=0$.
            If $E_1,E_2,\ldots\in\M$ are disjoint, then apply (ii) to get $f_k=1_{E_k}$, noting that $\sum_{k=1}^\infty 1_{E_k}=1_{\bigcup_{k=1}^\infty E_k}$ to see $\sigma-$additivity.
    \end{enumerate}
\end{proof}
\subsection{Integration of Complex Valued Functions}
Let $(X,\M,\mu)$ be a measure space.
We let
\begin{align*}
    M(X,\M)&=\{f:X\to\C:f\text{ is $\M-$measurable}\}\\
    M^{\R}(X,\M)&=\{f:X\to\R:f\text{ is $\M-$measurable}\}\\
    M^+(X,\M)&=\{f:X\to[0,\infty):f\text{ is $\M-$measurable}\}
\end{align*}
\begin{remark}
    \begin{enumerate}
        \item If $f\in M^{\R}(X,\M)$, then $f^+:=\max\{f,0\}$, $f^-:=\max\{-f,0\}$ are both in $M^+$.
            Thus, we have $f=f^+-f^-$ and $|f|=f^++f^-$.
        \item If $f\in M(X,\M)$, then $|\cdot|:\C\to[0,\infty)$ is continuous and thus Borel measurable. %]
    \end{enumerate}
\end{remark}
\begin{definition}
    We let $L(X,\M,\mu)=L(\mu):=\{f\in M(X,\M):\int_X|f|\d{\mu}<\infty\}$ denote the \textbf{$\mu-$Lebesgue integrable} functions.
    Notice that $\Re f^+,\Re f^-,\Im f^+,\Im f^-\leq |f|\leq\Re f^++\cdots+\Im f^-$, so we have $f\in L(\mu)\Leftrightarrow \Re f^+,\cdots,\Im f^-\in L(\mu)$.
    We may therefore define for $f\in L(\mu)$ the \textbf{Lebesgue integral} with respect to $\mu$
    \begin{equation*}
        \int_X f\d{\mu}=\int_X\Re f^+\d{\mu}-\int_X\Re f^-\d{\mu}+i\left(\int_X\Im f^+\d{\mu}-\int_X\Im f^-\d{\mu}\right)
    \end{equation*}
\end{definition}
\begin{proposition}
    If $f,g\in L(X,\M,\mu)$ and $c\in\C$, then $f+g,cf\in L(\mu)$ with $\int_X(f+g)\d{\mu}=\int_X f\d{\mu}+\int_X g\d{\mu}$, $\int_X(cf)\d{\mu}=c\int_X f\d{\mu}$.
\end{proposition}
\begin{proof}
    Assume $f,g\in L^{\R}(\mu)$ and $c\in\R$.
    Then
    \begin{equation*}
        (f+g)^+-(f+g)^-=f+g=f^+-f^-+g^+-g^-\Rightarrow(f+g)^++f^-+g^-=f^++g^++(f+g)^-
    \end{equation*}
    We then integrate, applying the last corollary, and rearrange.
    Similarly, $c=cf^+-cf^-$ if $c\geq 0$, and $|c|f^--|c|f^+$ if $c<0$.
    Then, for example, if $c<0$, we have $\int_X|c|f^\pm\d{\mu}=|c|\int_Xf^{\pm}\d{\mu}<\infty$ and $\int_X|c|f^-\d{\mu}-\int_X|c|f^+\d{\mu}=|c|\int_X f^-\d{\mu}-|c|\int_X f^+\d{\mu}=c\int_Xf\d{\mu}$.

    Finally, use $\C-$arithmetic on $\Re$, $\Im$ parts.
\end{proof}
\begin{definition}
    If $f,g\in M(X,\M)$, we say that $f=g$ \textbf{$\mu-$almost everywhere} if $\mu(\{x\in X:f(x)\neq g(x)\})=0$.
\end{definition}
Notice that
\begin{equation*}
    \{x\in X:f(x)\neq g(x)\}=
    \begin{cases}
        (f-g)^{-1}(\C\setminus\{0\})\\
        (f-g)^{-1}((0,\infty))\cup[f^{-1}(\{\infty\})\cap g^{-1}([0,\infty))]\cup[f^{-1}([0,\infty))\cap g^{-1}\cap g^{-1}(\{\infty\})
    \end{cases}
\end{equation*}
If $f=g$ $\mu-$a.e., and $g=$ $\mu-$a.e., then $f=h$ $\mu-$a.e.
If $(f_n)_{n=1}^\infty\subset M(X,\M)$, we write $\lim_{n\to\infty}f_n=f$ $\mu$-a.e. if $\mu(\{x\in X:\lim_{n\to\infty}:\lim_{n\to\infty}f_n(x)\neq f(x)\})=0$.
Notice that
\begin{align*}
    E &= \{x\in X:\lim_{n\to\infty}f_n(x)\text{ does not exist}\}\\
      &= \{x\in X:\liminf_{n\to\infty}\Re f_n\neq\limsup_{n\to\infty}\Re f_n\}\cup\{x\in X:\liminf_{n\to\infty}\Im f_n\neq\limsup_{n\to\infty im f_n}\}
\end{align*}
Likewise, $\{x\in X:\lim_{n\to\infty}f(x)$ exists, but is not $f(x)\}\in\M$.
\begin{lemma}
    Let $f\in\overline{M}^+(X,\M)$.
    Then
    \begin{enumerate}[nolistsep]
        \item $\int_X f\d{\mu}<\infty\Rightarrow\mu(f^{-1}(\{\infty\}))=0$, i.e. $f<\infty$ $\mu-$a.e.
        \item $\int_X f\d{\mu}\Leftrightarrow\mu(f^{-1}((0,\infty])=0$, i.e. $f=0$ $\mu-$a.e. %)
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[nolistsep]
        \item For each $N\in\N$, $n1_{f^{-1}(\{\infty\})}\in S^+_f$, so $0\leq n\mu(f^{-1}(\{\infty\}))\leq\int_X f\d{\mu}<\infty$, so that $\mu(f^{-1}(\{\infty\}))=0$.
        \item $\frac{1}{n}1_{f^{-1}([1/n,\infty])}\in S^+_f$ so
            \begin{equation*}
                0\leq\frac{1}{n}\mu(f^{-1}([1/n,\infty]))=\int_X\frac{1}{n}1_{f^{-1}([1/n,\infty])}\leq\int_X f\d{\mu}=0
            \end{equation*}
            so $\mu(f^{-1}([1/n,\infty]))=0$.
            Now,
            \begin{equation*}
                f^{-1}((0,\infty]))=\bigcup_{n=1}^\infty f^{-1}([1/n,\infty])
            \end{equation*}
            so the result holds by $\sigma-$subadditivity.

            Conversely, let $\phi=\sum_{i=1}^n a_i1_{E_i}\in S^+_f$ in standard form, and $a_i>0$, then $E_i=f^{-1}(\{a_i\})\subseteq ^{-1}((0,\infty])$, so $\mu(E_i)=0$.
            Thus $\int_X\phi\d{\mu}=0$ so $\int_Xf\d{\mu}=0$.
    \end{enumerate}
\end{proof}
\begin{corollary}
    \begin{enumerate}
        \item If $f\in\overline{M}^+(X,\M)$, then $\int_Xf\d{\mu}<\infty$ if and only if there is $f_0\in M^+(X,\M)$ so that $f=f_0$ $\mu-$a.e.
        \item If $f,g\in L(X,\M,\mu)$, then $f=g$ $\mu-$a.e. if and only if $\int_X|f-g|\d{\mu}=0$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    Clear from above.
\end{proof}
\begin{theorem}
    Let $(f_n)\subseteq L(X,\M,\mu)$, and $f\in M(X,\M)$ such that
    \begin{itemize}[nolistsep]
        \item $\lim_{n\to\infty} f_n=f$ $\mu-$a.e.
        \item There is $g\in L^+(\mu)$ such that $|f_n|\leq g$ $\mu$-a.e.
            Then $f\in L(\mu)$ and $\lim_{n\to\infty}\int_X f_n\d{\mu}=\int_X f\d{\mu}$.
            If, further, $(X,\M,\mu)$ is complete, we may take $f:X\to\C$.
    \end{itemize}
\end{theorem}
\begin{proof}
    Let $N=\bigcup_{n=1}^\infty(|f_n|-g)^{-1}((0,\infty))\cup\{x\in X:\lim f_n(x)\neq f(x)\}$, so $\mu(N)=0$.
    Replace $f_n$ by $1_Nf_n$ and $f$ by $1_Nf$, and assume all limits and inequalities are pointwise.
    Notice if $(X,\M,\mu)$ is complete, then we do not need the assumption that $f$ is measurable to see that $N\in\M$.
    We thus have that $f\in M(X,\M)$ with $|f|=\lim|f_n|\leq |g|$, so $\int_X f\d{\mu}<\infty$.

    (I) Assume that each $f_n$, hence $f$, is $\R-$valued.
    Then $(g+f_n)_{n=1}^\infty$, $(g-f_n)_{n=1}^\infty\subset M^+(X,\M)$.
    Hence, we may use Fatou's Lemma:
    \begin{align*}
        \int_X g\d{\mu}\pm\int_X f\d{\mu} &= \int_X(g\pm f)\d{\mu}=\int_X\liminf_{n\to\infty}(g\pm f_n)\d{\mu}\\
                                          &\leq\liminf_{n\to\infty}\int_X(g\pm f_n)\d{\mu}=\liminf_{n\to\infty}\left(\int_X g\d{\mu}\pm\int_X f_n\d{\mu}\right)\\
                                          &=
        \begin{cases}
            \int_X g\d{\mu}+\liminf_{n\to\infty}\int_X f_n\d{\mu} &\pm=+\\
            \int_X g\d{\mu}-\limsup_{n\to\infty}\int_X f_n\d{\mu} &\pm=-
        \end{cases}
    \end{align*}
    Then
    \begin{itemize}[nolistsep]
        \item $\pm=+$ provides $\int_Xg\d{\mu}+\int_X f\d{\mu}\leq\int_XG\d{\mu}+\liminf_{n\to\infty}\int_Xf_n\d{\mu}$.
            Thus $\int_Xf\d{\mu}\leq\liminf_{n\to\infty}\int_X f_n\d{\mu}$
        \item $\pm=-$ implies $\int_X f\d{\mu}\geq\limsup_{n\to\infty}\int_X f_n$.
    \end{itemize}
    Thus $\limsup_{n\to\infty}\int_Xf_n\d{\mu}\leq\int_Xf\d{\mu}\leq\liminf_{n\to\infty}\int_Xf_n\d{\mu}$, so $\lim_{n\to\infty}\int_Xf_n\d{\mu}$ exists and equals $\int_Xf\d{\mu}$.

    (II) Here we use (I) to see that $\lim_{n\to\infty}\Re f_n=\Re f$, so $\lim_{n\to\infty}\int_X\Re f_n\d{\mu}=\int_X\Re f\d{\mu}$, and likewis with imaginary parts.
    Thus
    \begin{align*}
        \lim_{n\to\infty}\int_Xf_n\d{\mu} &= \lim_{n\to\infty}\int_X\Re f_n\d{\mu}+i\lim_{n\to\infty}\int_X\Im f_n\d{\mu}\\
                                         &= \int_X\Re f\d{\mu}+i\int_X\Im f\d{\mu}=\int_X f\d{\mu}
    \end{align*}
\end{proof}
Note that MCT and Fatou's lemma also work with assumptions of $\mu$-a.e. convergence.
Let $S(X,\M)=\{\phi:X\to\C:\phi\text{is $\M$-measurable},|\phi(X)|<\infty\}$.
\begin{corollary}
    \begin{enumerate}[nolistsep]
        \item If $(f_n)\subseteq L(\mu)$, $f\in M(X,\M)$ with $f=\lim f_n$ $\mu$-a.e. and there is $g\in L^+(\mu)$ with $|f_n|\leq g$ $\mu-$a.e., then $\lim_{n\to\infty}\int_X|f-f_n|\d{\mu}=0$.
        \item Given $f\in L(\mu)$, there exists a sequence $(\phi_n)\subseteq S(X,\M)$ such that $|\phi_n|\leq|f|$ and $\lim_{n\to\infty}\phi_n=f$.
            Furthermore, we have that $\int_Xf\d{\mu}=\lim_{n\to\infty}\int_X\phi_n\d{\mu}$.
        \item If $f\in L(\mu)$, then $|\int_Xf\d{\mu}|\leq\int_X|f|\d{\mu}$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    \begin{enumerate}
        \item We have $\lim_{n\to\infty}|f-f_n|=0$ $\mu-$a.e., and $|f-f_n|\leq|f|+|f_n|\leq 2g\in L^+(\mu)$.
            Apply $L.D.C.T.$.
        \item An earlier lemma gives us sequences $(\phi_n^\pm)_{n=1}^\infty$, $(\psi_n^\pm)_{n=1}^\infty$ so that $0\leq\phi_1^+\leq\phi_2^+\leq\cdots$ with $\lim\phi_n^+=\Re f^+$, $0\leq\psi_1^-\leq\psi_2^-\leq\cdots$ with $\lim \psi_n^-=\Im f^-$.
            Let $\phi_n=\phi_n^+-\phi_n^-+i[\psi_n^+-\psi_n^-]$.
            Then
            \begin{align*}
                |\phi_n|&=[|\phi_n^+-\phi_n^-|^2+|\psi_n^+-\psi_n^-|^2]^{1/2}\\
                        &\leq[(\phi_n^++\phi_n^-)^2+(\psi_n^++\psi_n^-)^2]^{1/2}
                        &\leq\left[(\Re f^++\Re f^-)^2+(\Im f^++\Im f^-)\right]^{1/2}\\
                        &= |f|
            \end{align*}
            and, also, $\lim\phi_n=f$.
            We have that since $|\phi_n|\leq|f|$, we use LDCT to get a limit of integrals.
        \item If $\phi\in S^-(X,M)\cap L(\mu)$, write $\phi=\sum_{i=1}^nc_i1_{E_i}$.
            Then
            \begin{equation*}
                |\int_X\phi\d{\mu}|=|\sum_{i=1}^nc_i\mu(E_i)|\leq\sum_{i=1}^n|c_i|\mu(E_i)=\int_X|\phi|\d{\mu}
            \end{equation*}
            Now, if $f\in L(\mu)$, we obtain sequences $(\phi_n)_{n=1}^\infty\subset S(X,\M)$.
            Thus we have
            \begin{equation*}
                |\int_Xf\d{\mu}|=\lim|\int_X\phi_n\d{\mu}|\leq\lim\int_X|\phi_n|\d{\mu}=\int_X|f|\d{\mu}
            \end{equation*}
            as $|\phi_n|\leq|f|$, $\lim |\phi_n|=|f|$.
    \end{enumerate}
\end{proof}
\begin{lemma}
    Let $(X,\mathcal{A},\mu_0)$ be a premeasure space, and $(X,\M,\mu)$ denote the canonical induced measure space.
    Given $f\in L(\mu)$, $\epsilon>0$, there is
    \begin{equation*}
        \phi=\sum\limits_{i=1}^n a_i1_{B_i},a_1,\ldots,a_n\in\C,B_1,\ldots,B_n\in\mathcal{A}
    \end{equation*}
    such that $\int_X|\phi-f|\d{\mu}<\epsilon$.
\end{lemma}
\begin{proof}
    (I) Let $E\in\M$, with $\mu(E)<\infty$.
    Then given $\epsilon>0$, there is $B\in\mathcal{A}$ so that $\mu(B\triangle E)<\epsilon$.
    To see this, let $A_1,A_2,\ldots\in\mathcal{A}$ so that $E\subseteq\bigcup_{i=1}^\infty A_i$ with $\sum_{i=1}^\infty \mu_0(A_i)<\mu^*(E)+\epsilon=\mu(E)+\epsilon$.
    Let $n$ be so that $\sum_{i=n+1}^\infty \mu_0(A_i)<\epsilon/2$, and let $B=\bigcup_{i=1}^n A_i\in\mathcal{A}$.
    Then $B\triangle E\subseteq\left(\bigcup_{i=1}^\infty A_i\setminus E\right)\cup\left(\bigcup_{i=n+1}^\infty A_i\right)$ and the result follows by $\sigma-$subaddivitity.

    (II) If $\psi\in S(X,\M)\cap L(\mu)$.
    Then given $\epsilon>0$, there is $\phi$ as above so $\int|\psi-\phi|<\epsilon$.
    To see this, write $\psi=\sum_{i=1}^n a_i1_{E_i}$.
    By (I), we find for each $i$, $B_i$ in $\mathcal{A}$ such that $\mu(B_i\triangle E_i)<\epsilon/a$, where $a=1+\sum_{i=1}^n|a_i|$.
    Then
    \begin{equation*}
        \int|\phi-\psi|\leq\sum_{i=1}^n|a_i|\int|1_{B_i}-1_{E_i}|=\sum_{i=1}^n \mu(B_i\triangle E_i)<\epsilon
    \end{equation*}

    (III) If $f\in L(\mu)$, a corollary to LDCT provides $\psi$ in $S(X,\M)\cap L(\mu)$ such that $\int|f-\psi|<\epsilon.2$.
    We let $\phi$ as in (II), so $\int|\psi-\phi|<\epsilon/2$.
\end{proof}
\begin{proposition}
    Let $(X,\M,\mu)$ be a measure space, $f:X\times(a,b)\to\C$ satisfy that
    \begin{itemize}[nolistsep]
        \item $f(\cdot,s)\in L(\mu)$ for each $s\in(a,b)$
        \item $\frac{\partial}{\partial s}f(x,s)=\lim_{h\to 0}\frac{f(x,s+h)-f(x,s)}{h}$ exists for each $(x,s)$ in $X\times(a,b)$
        \item there is $g\in L^+(\mu)$ so that $\left\lvert\frac{\partial}{\partial s}f(\cdot,s)\right\rvert\leq g$ $\mu-$a.e for each $s\in(a,b)$.
    \end{itemize}
    Then $F(x)=\int_X f(x,s)\d{\mu(x)}$, and $F$ is differentiable on $(a,b)$ with $F'(s)=\int_X\frac{\partial}{\partial s}f(x,s)\d{\mu(x)}$.
\end{proposition}
\begin{proof}
    We fix $s\in(a,b)$ and an arbitrary sequence $(h_n)_{n=1}^\infty\subset\R\setminus\{0\}$ such that $s+h_n\in(a,b)$ for each $n$, and $\lim h_n=0$.
    Notive that for each $x\in X$, $f(x,\cdot):(a,b)\to\C$ is continuous on intervals $[s,s+h_n]$, $[s+h_n,s]$ (if $h_n<0$) for $n\in\N$.
    Thus, by MVT, we find $c_n,d_n\in(s,s+h_n)$ such that
    \begin{align*}
        |f(x,s+h_n)-f(x,s)| &= \left\lvert\Re\frac{\partial}{\partial s}f(x,c_n)+i\im\frac{\partial}{\partial s}f(x,d+n)\right\rvert|h_n|\\
                            &\leq 2|g(x)||h_n|
    \end{align*}
    Thus, by LDCT,
    \begin{align*}
        F'(s)=\lim_{n\to\infty}\frac{F(s+h_n)-F(s)}{h_n}&=\lim_{n\to\infty}\int\left(\frac{f(x,s+h_n)-f(x,s)}{h_n}\d{\mu(x)}\right)\\
                                                        &= \int\frac{\partial}{\partial s}f(x,s)\d{\mu(x)}
    \end{align*}
\end{proof}
\section{Modes of Convergence}
Let $(X,\M,\mu)$ be a measure space, $(f_n),f\in M(X,\M)$.
We say that $\lim f_n=f$
\begin{itemize}[nolistsep]
    \item \textbf{uniformly} if $\lim_{n\to\infty}\sup_{x\in X}|f_n(x)-f(x)|=0$
    \item \textbf{pointwise} if $\lim_{n\to\infty}|f_n(x)-f(x)|=0$ for each $x\in X$
    \item \textbf{pointwise $\mu$-a.e.} if $\lim_{n\to\infty}|f_n(x)-f(x)|=0$ for each $x\in X\setminus N$, where $\mu(N)=0$.
    \item \textbf{ in $L^1(\mu)$} if $\lim_{n\to\infty}\int_X|f_n-f|\d{\mu}=0$.
    \item \textbf{in $\mu$-measure} if for any $\epsilon>0$ we have $\lim_{n\to\infty}\mu\left(\{x\in X:|f_n(x)-f(x)|\geq\epsilon\}\right)=0$.
\end{itemize}
\begin{example}
    Consider sequences $f_n=\frac{1}{n}1_{[0,n]}$, $g_n=1_{[n,n+1]}$, $h_n=n1_{[0,1/n]}$, $k_n=1_[j/2^k,(j+1)/2^k]$ where $n=2^k+j$ for $j=0,\ldots,2^k-1$.
    Then
    \begin{center}
        \begin{tabular}{c|ccccc}
            &uniform&pointwise&pointwise $\lambda-$a.e. & in $L^1(\lambda)$&in $\lambda-$measure\\
            $f_n$&\checkmark&\checkmark&\checkmark&$\times$&\checkmark\\
            $g_n$&$\times$&\checkmark&\checkmark&$\times$&$\times$\\
            $h_n$&$\times$&$\times$&\checkmark&$\times$&\checkmark\\
            $k_n$&$\times$&$\times$&$\times$&\checkmark&\checkmark
        \end{tabular}
    \end{center}
\end{example}
\begin{proposition}
    If $\lim_{n\to\infty}f_n=f$ in $L^1(\mu)$, then $\lim_{n\to\infty}f_n=f$ in $\mu$-measure.
\end{proposition}
\begin{proof}
    Let $\epsilon>0$, and set $E_n=\{x\in X:|f_n(x)-f(x)|\geq\epsilon\}$.
    Then $\int_X |f_n-f|d{\mu}\geq\int_{E_n}|f_n-f|\d{\mu}\geq\int_{E_n}\epsilon=\epsilon\mu(E_n)$.
    Thus $\mu(E_n)\leq\frac{1}{\epsilon}\int_X|f_n-f|\d{\mu}\to 0$ as $n$ goes to infinity.
\end{proof}
\begin{theorem}
    Let $(f_n)_{n=1}^\infty$, $f\in M(X,\M)$.
    Then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $\lim_{n\to\infty}f_n=f$ in $\mu-$measure, then $(f_n)_{n=1}^\infty$ is \textbf{Cauchy in $\mu$-measure}; i.e., given $\epsilon,\delta>0$, there is $n_0\in\N$ (dependent on $\epsilon,\delta$) such that whenever $n,m\geq n_0$, $\mu(\{x\in X:|f_n(x)-f_m(x)|\geq\epsilon\})<\delta$.
        \item If $(f_n)_{n=1}^\infty$ is Cauchy in $\mu-$measure, then there is a subsequence $(f_{n_j})_{j=1}^\infty$ such that $\lim_{j\to\infty}f_{n_j}=f_0$ for some $f_0\in M(X,\M)$ $\mu-$a.e.
            Furthermore, $\lim_{j\to\infty}f_{n_j}=f_0$ in measure.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $m,n\in\N$, then
            \begin{align*}
                \{x\in X:|f_n(x)-f_m(x)|\geq\epsilon\}&\subseteq\{x\in X:|f_n(x)-f(x)|+|f(x)-f_m(x)|\geq\epsilon\}\\
                                                      &\subseteq\{x\in X:|f_n(x)-f(x)|\geq\epsilon/2\}\cup\{x\in X:|f(x)-f_m(x)|\geq\epsilon/2\}
            \end{align*}
            and apply definitions.
        \item Let $n_1<n_2<\cdots$ be such that $E_j=\{x\in X:|f_n(x)-f_m(x)|\geq 1/2^j,n,m\geq n_j\}$ satisfies $\mu(E_j)<1/2^j$ (i.e. $\epsilon,\delta=1/2^j$).
            Let $F_k=\bigcup_{j=k}^\infty E_j$, so by $\sigma-$subadditivity, $\mu(F_k)\leq 1/2^{k-1}$.
            If $x\notin F_k$, then for $i>j\geq k$, we have
            \begin{align*}
                |f_{n_j}(x)-f_{n_i}(x)| &\leq\sum\limits_{p=j}^{i-1}|f_{n_p}(x)-f_{n_{p+1}}(x)|\\
                                        &< \sum\limits_{p=j}^{i-1}\frac{1}{2^p}\\
                                        &= \frac{1}{2^{j-1}}\leq\frac{1}{2^{k-1}}
            \end{align*}
            Thus $(f_{n_j})_{j=1}^\infty$ is pointwise Cauchy on $X\setminus F_k$.
            Let $F=\bigcap_{k=1}^\infty F_k$, so
            \begin{equation*}
                0\leq \mu(F)\leq\mu(F_k)\leq\frac{1}{2^{k-1}}
            \end{equation*}
            and since this holds for any $k$, $\mu(F)=0$.
            Thus for $x\in X\setminus F=\bigcup_{k=1}^\infty(X\setminus F_k)$, we have that $(f_{n_j})_{j=1}^\infty$ is pointwise Cauchy.
            Thus there is $\tilde f\in M(X\setminus F,\M|_{X\setminus F})$, so $\lim_{j\to\infty}f_{n_j}=\tilde f$ on $X\setminus F$.
            Then $f:X\to\C$ defined $f(x)=\tilde f(x)$ on $X\setminus F$ and $f(x)=0$ otherwise.
            It is easy to see that $f_0\in \M(X,\M)$.

            Given $\epsilon>0$, let $k$ be so $1/2^{k-1}<\epsilon$.
            Then for $x\in X\setminus F_k$, $|f_0(x)-f_{n_k}(x)|=\lim_{j\to\infty}|f_{n_j}(x)-f_{n_k}(x)|\leq\frac{1}{2^{k-1}}<\epsilon$.
            Thus $\{x\in X:|f_0(x)-f_{n_k}(x)|\geq\epsilon\}\subseteq F_k$, so $\mu(E)\leq\mu(F_k)\leq1/2^{k-1}<\epsilon$.
    \end{enumerate}
\end{proof}
\begin{corollary}
    If $\lim_{n\to\infty}f_n=f$ in $L^1(\mu)$, then there is a subsequence $(f_{n_j})_{j=1}^\infty$ such that $\lim_{j\to\infty}f_{n_j}=f$ $\mu-$a.e.
\end{corollary}
\begin{proof}
    By the last proposition, we have $\lim f_n=f$ in $\mu-$measure, and hence by the Theorem (i), $(f_n)_{n=1}^\infty$ is Cauchy in $\mu-$measure.
    By (ii), there is a subsequence so that $\lim f_{n_j}=f_0$ $\mu-$a.e.
    As before,
    \begin{equation*}
        E=\{x\in X:|f_0(x)-f(x)|\geq\epsilon\}\subseteq\{x\in X:|f_n(x)-f(x)|\geq\epsilon/2\}\cup\{x\in X:|f(x)-f_m(x)|\geq\epsilon/2\}
    \end{equation*}
    and since $\lim f_n=f$ in measure and $\lim f_{n_j}=f_0$ in measure, we see that $\mu(E)$ is bounded by arbitrarily small values.
\end{proof}
\begin{corollary}
    If $a<b$ in $\R$ $f:[a,b]\to\R$ is Riemann integrable, then $f\in L([a,b],\B([a,b]),\lambda)$ and the Riemann and Lebesgue integral agree.
\end{corollary}
\begin{proof}
    Let
    \begin{equation*}
        J_{n,i}=\left[a+\frac{i-1}{n}(b-a),a+\frac{i}{n}(b-a)\right)
    \end{equation*}
    for $i=1,\ldots,n$, $I_{n,i}=\overline{J_{n,i}}$, $l_{n,i}=\int_{x\in I_{n,i}}f(x)$, $u_{n,i}=\sup_{x\in I_{n,i}}f(x)$, $\phi_n=\sum_{i=1}^n l_{n,i}1_{J_{n,i}}$, $\psi_n=\sum_{j=1}^n u_{n,i}1_{J_{n,i}}$ and
    \begin{align*}
        L_n(f)=\int_{[a,b]}\phi_n\d{\lambda},U_n(f)=\int_{[a,b]}\psi_n\d{\lambda}
    \end{align*}
    Riemann integrability tells us that $\lim_{n\to\infty}(U_n(f)-L_n(f))=0$.
    Note that $\phi_n\leq f\leq\psi_n$, and $\int_{[a,b]}|\psi_n-\phi_n|\d{\lambda}=U_n(f)-L_n(f)\to 0$ as $n\to\infty$.
    Thus $\lim_{n\to\infty}|\psi_n-\phi_n|=0$ in $L^1(\mu)$.
    Thus, there is a subsequence so $\lim_{j\to\infty}|\psi_{n_j}-\phi_{n_j}|=0$ $\lambda-$a.e.
    Since $\phi_n\leq\phi_{n+1}\leq f\leq\psi_{n+1}\leq\psi_n$, we conclude that $f=\lim\phi_{n_j}$ $\lambda-$a.e. with integrable majorant $g=|\phi_1|+|\psi_1|$, so $\int_{[a,b]}f\d{\lambda}=\lim_{j\to\infty}L_{n_j}(f)=\int_a^b f$.
\end{proof}
More generally, Riemann integrable functions are continuous $\lambda-$a.e.
If $a<b$ in $\overline{R}$, $f\geq 0$ improperly Riemann integrable, then it is Lebesgue integrable on $(a,b)$.

\begin{definition}
    If $(f_n)_{n=1}^\infty,f$ are in $M(X,\M)$, then $\lim f_n=f$ \textbf{$\mu-$almost uniformly} if, given any $\epsilon>0$, there is $E\in M$ with $\mu(E)<\epsilon$ so that $\lim_{n\to\infty}\sup_{x\in X\setminus E}|f_n(x)-f(x)|=0$.
\end{definition}
\begin{theorem}[Egoroff]
    Suppose $(X,\M,\mu)$ is a finite measure space.
    If $(f_n)_{n=1}^\infty,f$ are in $M(X,\M)$ such that $\lim f_n=f$ $\mu-$a.e., then $\lim f_n=f$ $\mu-$almost uniformly.
\end{theorem}
Note that finiteness is essential.
\begin{proof}
    Let $N=\{x\in X:\lim f_n(x)\text{ does not exist, or is not equal to $f(x)$}\}$, so $\mu(N)=0$.
    For $k,n\in\N$, let $E_{n,k}=\bigcup_{m=n}^\infty\{x\in X:|f_m(x)-f(x)|\geq 1/k\}$, so $E_{n,k}\in\M$, $E_{n,k}\supseteq E_{n+1,k}$ and $\bigcap_{n=1}^\infty E_{n,k}\subseteq N$.
    Thus by continuity from above (we assume $\mu(X)<\infty$), we see that $\lim_{n\to\infty}\mu(E_{n,k})=0$.

    Given $\epsilon>0$, let $n_k$ so that $\mu(E_{n_k,k})<\epsilon/2^k$.
    Let $E=\bigcup_{k=1}^\infty E_{n_k,k}$ so $\mu(E)<\epsilon$ and for $x\in X\setminus E=\bigcap_{k=1}^\infty(E\setminus E_{n_k,k})\subseteq E_{n_k,k}$, for any $k$, we have $|f_n(x)-f(x)|<1/k$ for $n\geq n_k$.
    Thus $\limsup_{n\to\infty}\sup_{x\in X\setminus E}|f_n(x)-f(x)|\leq 1/k$, which gives $\lim_{n\to\infty}\sup_{x\in X\setminus E}|f_n(x)-f(x)|=0$.
\end{proof}
\chapter{Product Measures}
Let $(X,\N,\mu)$, $(Y,\mathcal{N},\nu)$ be two measure spaces.
\begin{proposition}
    Let $\mathcal{E}=\{E\times F:E\in\M,F\in\mathcal{N}\}\subseteq\mathcal{P}(X\times Y)$, and let $\mathcal{A}=\langle\mathcal{E}\rangle$.
    Then
    \begin{enumerate}[nolistsep]
        \item Each element of $\mathcal{A}$ is of the form $A=\bigcup_{i=1}^n E_i\times F_i$ for $E_i\in\M$, $F_i\in\mathcal{N}$, $(E_i\times F_i)\cap (E_j\cap F_j)=\emptyset$ if $i\neq j$.
        \item We define $(\mu\times\nu)_0:\mathcal{A}\to[0,\infty]$ by
            \begin{equation*}
                (\mu\times\nu)_0(A)=\sum_{i=1}^n\mu(E_i\cup F_i)
            \end{equation*}
            if $A$ is as in (i).
            Then $(\mu\times\nu)_0$ is a pre-measure, hence extends to a measure $\mu\times\nu:M\otimes\mathcal{N}\to[0,\infty]$.
            If each of $\mu$ and $\nu$ are $\sigma-$finite, $\mu\times\nu$ is $\sigma-$finite and this extension is unique.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item We see that $\mathcal{E}$ is an elementary family of sets: if $E,E_1\in\M$, $F,F_1\in\mathcal{N}$, then
            \begin{itemize}[nolistsep]
                \item $(E\times F)\cap(E_1\times F_1)=(E\cap E_1)\times(F\cap F_1)\in\mathcal{E}$
                \item $(X\times Y)\setminus (E\times F)=[(X\setminus E)\times F]\cup[E\times (Y\setminus F)]\cup[(X\setminus E)\cup(Y\setminus F)]$.
            \end{itemize}
            Thus the result follows from an earlier lemma.
        \item We need to establish that the formula for $(\mu\times\nu)_0(A)$ is well-defined.
            Suppose
            \begin{align*}
                A=\bigcupdot_{i=1}^n(E_i\times F_i)=\bigcupdot_{j=1}^m(M_j\times N_j)
            \end{align*}
            Then for each $x\in X$ we see that $1_A(x,\cdot)=\sum_{i=1}^n1_{E_i}(x)1_{F_i}=\sum_{j=1}^n1_{M_j}(x)1_{F_j}$ and hence
            \begin{align*}
                \int_Y1_A(x,y)\d{\mu}(y)=\sum_{i=1}^n\nu(F_i)1_{E_i}(x)=\sum_{j=1}^m\mu(N_j)1_{M_j}(x)
            \end{align*}
            and moreover
            \begin{align*}
                \int_X\left[\int_Y1_A(x,y)\d{\nu(y)}\right]\d{\mu(x)} &= \sum_{i=1}^n\mu(E_i)\nu(F_i)\\
                                                                      &= \sum_{j=1}^m\mu(M_j)\nu(N_j)\tag{$\dagger$}
            \end{align*}
            which gives an unambiguous value for $(\mu\times\nu)_0(A)$.
            Evidently, $\emptyset=\emptyset\times\emptyset$, so $(\mu\times\nu)_0(\emptyset)=0$.
            Now suppose $A,(A_n)_{n=1}^\infty$ are in $\mathcal{A}$, with $A=\bigcupdot_{n=1}^\infty A_n$.
            But then $1_A=\sum_{n=1}^\infty 1_{A_n}$ and for $x\in X$, $1_A(x,\cdot)=\sum_{n=1}^\infty 1_{A_n}(x,\cdot)$.
            Thus, by 2 applications of (a Corollary to) MCT and $(\dagger)$,
            \begin{align*}
                (\mu\times\nu)_0(A) &= \int_X\int_Y1_A(x,y)\d{\nu(y)}\d{\mu(x)}\\
                                    &= \int_X\int_Y\sum_{n=1}^\infty 1_{A_n}(x,y)\d{\nu(y)}\d{\mu(x)}\\
                                    &= \int_X\left[\sum_{n=1}^\infty\int_Y 1_{A_n}(x,y)\d{\nu(y)}\right]\d{\mu(x)}\\
                                    &= \sum_{n=1}^\infty\int_X\int_Y 1_{A_n}(x,y)\d{\nu(y)}\d{\mu(x)}\\
                                    &= \sum_{n=1}^\infty(\mu\times\nu)_0(A_n)
            \end{align*}
            We appeal to the canonical measure construction to get $\mu\times\nu$ on $\M\otimes\mathcal{N}=\sigma\langle\mathcal{E}\rangle=\sigma\langle\mathcal{A}\rangle$.
            If $(X_n)_{n=1}^\infty\subseteq\M$, $(Y_n)_{n=1}^\infty\subseteq\mathcal{N}$ show $\sigma-$finitenes of $\mu$, (resp. $\nu$), then each $(\mu\times\nu)(X_n\times Y_n)=\mu(X_n)\nu(Y_n)<\infty$ and $X\times Y=\bigcup_{n=1}^\infty X_n\times Y_n$, showing $\sigma-$finiteness of $\mu\times\nu$.
    \end{enumerate}
\end{proof}
\begin{theorem}
    Let $(X,\mathcal{M},\mu)$, $(Y,\mathcal{N},\nu)$ be $\sigma-$finite measure spaces.
    If $E\in\M\otimes\mathcal{N}$, then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $x\mapsto\nu(E_x):X\to[0,\infty]$ is $\M-$measurable
        \item $y\mapsto\mu(E^y):Y\to[0,\infty]$ is $\mathcal{N}-$measurable.
        \item $\mu\times\nu(E)=\int_Y\mu(E^Y)\d{\nu(y)}=\int_X\nu(E_x)\d{\mu(x)}$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    (I) We assume that $\mu(X)$, $\mu(Y)<\infty$.
    Set $\mathcal{C}$ be the set of $E\in \M\otimes\mathcal{N}$ for which $(i),(ii),(iii)$ hold.
    We will establish that $\mathcal{A}=\langle\{M\otimes N:M\in\mathcal{M},N\in\mathcal{N}\}\rangle\subseteq \mathcal{C}$ and that $\mathcal{C}$ is a monotone class.
    Hence, the Monotone Class lemma show that $M\otimes\mathcal{N}=\sigma\langle\mathcal{A}\rangle=C(\mathcal{A})\subseteq C\subseteq M\mathcal{M}\otimes\mathcal{N}$.
    If $E\in A$, write $E=\bigcupdot_{i=1}^n A_i\times B_i$, $A_i\in\mathcal{M}$, $B_i\in\mathcal{N}$ for $i=1,\ldots,n$.
    Then or $x\in X$, we have
    \begin{equation*}
        E_x=\bigcup_{x\in A_i,i=1}^n B_i\Longrightarrow\nu(E_x)=\sum_{i=1}^n\nu(B_i)1_{A_i}(x)
    \end{equation*}
    Thus it is clear that $(i)$ and part of $(iii)$ hold or $E$.
    In the same way, $(ii)$ holds, and the other part of $(iii)$, so $E\in\mathcal{C}$, so $\mathcal{A}\subseteq\mathcal{C}$.

    Let's see that $\mathcal{C}$ is a monotone class.
    Let $E_1\supseteq E_2\supseteq\cdots$ in $\mathcal{C}$.
    Then, for $x\in X$, $E_{1x}\supseteq E_{2x}\supseteq\cdots$ in $\mathcal{N}$, and $\left(\bigcap_{n=1}^\infty E_n\right)_x=\bigcap_{n=1}^\infty(E_{nx})$.
    Since $\nu(E_{1x})\leq\nu(X)<\infty$, we may appeal to continuity from above to see that
    \begin{equation*}
        \nu\left(\left(\bigcap_{n=1}^\infty E_n\right)_x\right)=\nu\left(\bigcap_{n=1}^\infty(E_{nx})\right)=\lim_{n\to\infty}\nu(E_{nx})
    \end{equation*}
    and hence (i) holds for $\bigcap_{n=1}^\infty E_n$.
    Furthermore, by LDCT with integrable majorant $\mu(X)\nu(Y)1_{X\times Y}$ and again by continuity from above,
    \begin{align*}
        (\mu\times\nu)\left(\bigcap_{n=1}^\infty E_n\right) &= \lim_{n\to\infty}(\mu\times\nu)(E_n)\\
                                                            &= \lim_{n\to\infty}\int_X\nu(E_{nx})\d{\mu(x)}\\
                                                            &= \int_X\lim_{n\to\infty}\nu(E_{nx})\d{\mu(x)}\\
                                                            &=\int_X\nu\left(\left(\bigcap_{n=1}^\infty E_n\right)_x\right)\d{\mu(x)}
    \end{align*}
    so $\bigcap_{n=1}^\infty$ satisfies part of (iii).
    Likewise, if $E_1\subseteq E_2\subseteq\cdots$ in $\mathcal{C}$, we may apply continuity from below, and MCT to see that $\bigcup_{n=1}^\infty E_n$ satisfies (i) and part of (iii).
    Similarly, in each case above, then $y-$sections of intersections of decreasing sequences or unions of increasing sequences are in $\mathcal{C}$.

    (II) Now let each of $\mu,\nu$ be $\sigma-$finite.
    Hence there are $X_1\subseteq X_2\subseteq\cdots$ in $\mathcal{M}$, so $\bigcup_{n=1}^\infty X_n=X$, and $Y_1\subseteq Y_2\subseteq\cdots$ in $\mathcal{N}$ so $\bigcup_{n=1}^\infty Y_n=Y$.
    If $E\in\mathcal{M}\otimes\mathcal{N}$, then $E\cap(X_1\times Y_1)\subseteq E\cap(X_2\times Y_2)\subseteq\cdots$ and each $E\cap(X_n\times Y_n)$ satisfies (i), (ii), and (iii) in the finite measure space $(\mu\times\nu)|_{X_n\times Y_n}$.
    Hence, we conclude by continuity from below
    \begin{equation*}
        y\mapsto\mu(E^Y)=\lim_{n\to\infty}\mu(E^Y\cap Y_n)
    \end{equation*}
    since $\left(E\cap(X_n\times Y_n)\right)^Y=E^Y\cap Y_n$ is an increasing sequence and this function is $\mathcal{N}-$measurable.
    Thus, by MCT and again by continuity from below,
    \begin{align*}
        \mu\times\nu(E) &= \lim_{n\to\infty}\mu(E\cap(X_n\times Y_n))\\
                        &= \lim_{n\to\infty}\int_Y\nu(E^Y\cap Y_n)\d{\nu(y)}\\
                        &= \int_Y\lim_{n\to\infty}\nu(E^Y\cap Y_n)\d{\nu(y)}\\
                        &= \int_Y\nu(E^Y)\d{\nu(y)}
    \end{align*}
    Thus, $E$ satisfies (ii) and part of (iii).
    Likewise, $E$ satisfies (i) and the other part of (iii).
\end{proof}
\begin{theorem}[Tonelli and Fubini]
    Let $(X,\mathcal{M},\mu)$ $(Y,\mathcal{N},\nu)$ be $\sigma-$finite measure spaces.

    (\textit{Tonelli's Theorem}) If $f\in\overline{M}^+(X\times Y,\mathcal{M}\otimes\mathcal{N})$, then
    \begin{align*}
        x\mapsto \int_Y f_x\d{\nu}:X\to[0,\infty]&\text{ is $\mathcal{M}-$measurable.}\\
        y\mapsto \int_X f^y\d{\mu}:Y\to[0,\infty]&\text{ is $\mathcal{N}-$measurable.}\\
    \end{align*}
    and
    \begin{equation*}
        \int_Y\int_X f^y\d{\mu}\d{\nu(y)}=\int_{X\times Y}f\d{\mu\times\nu}=\int_X\int_Yf_x\d{\nu}\d{\mu(x)}\tag{$\dagger$}
    \end{equation*}

    (\textit{Fubini's Theorem}) If $f\in L(\mu\times\nu)$, then
    \begin{align*}
        \left(x\mapsto\int_Yf_x\d{\nu}\right)\in L(\mu)\\
        \left(y\mapsto\int_Xf^y\d{\mu}\right)\in L(\nu)
    \end{align*}
    and $(\dagger)$ holds.
\end{theorem}
\begin{proof}
    For an indicator function, we have
    \begin{align*}
        \int_{X\times Y}1_E\d{\mu\times\nu}=\mu\times\nu(E)&=\int_X\nu(E_x)\d{\mu(x)}\\
                                                           &=\int_X\int_Y1_{E_x}\d{\nu}\d{\mu(x)}\\
                                                           &= \int_X\int_Y(1_E)_x\d{\nu}\d{\mu(x)}
    \end{align*}
    Similarly, this is true for the $y-$sections and the other itegrated integral.
    Hence Tonelli holds for $f\in S^+(X\times Y,\mathcal{M}\otimes\mathcal{N})$.

    If $f\in\mathcal{M}^+(X\times Y,\mathcal{M}\otimes\mathcal{N})$, we have $(\phi_n)_{n=1}^\infty\subset S^+(X\times Y,\mathcal{M}\otimes\mathcal{N})$ such that $\lim\phi_n=f$.
    We use MCT.
    \begin{itemize}
        \item $\int_Y f_x\d{\nu}=\int_Y\lim_{n\to\infty}\phi_{nx}\d{\nu}=\lim_{n\to\infty}\int_Y\phi_{nx}\d{\nu}$, so $x\mapsto\int_Y f_x$ is $\mathcal{M}-$measurable, and
        \item
            \begin{align*}
                \int_{X\times Y}f\d{\mu\times\nu} &= \lim_{n\to\infty}\int_{X\times Y}\phi_n\d{\mu\times\nu)}\\
                                                  &= \lim_{n\to\infty}\int_X\int_Y\phi_{nx}\d{\nu}\d{\mu(x)}\\
                                                  &= \int_X\lim_{n\to\infty}\int_Y\phi_{nx}\d{\nu}\d{\mu(x)}\\
                                                  &= \int_X\int_Y\lim_{n\to\infty}\phi_{nx}\d{\nu}\d{\mu(x)}\\
                                                  &= \int_X\int_Y f_x\d{\nu}\d{\mu(x)}
            \end{align*}
    \end{itemize}
    and the same holds for $y-$sections, and Tonelli's Theorem holds.

    For Fubini's Theorem, we proceed as above.
    Recall that if $f\in L(\mu\times\nu)$, we can find $(\phi_n)_{n=1}^\infty\subset S(X\times Y,\mathcal{M}\otimes\mathcal{N})$ such that each $|\phi_n|\leq f$ and $\lim_{n\to\infty}\phi_n=f$.
    We use LDCT with integrable majorants to see that
    \begin{equation*}
        \int_{X\times Y}|f|\d{\mu\times\nu}=\int_X\int_Y|f|_x\d{\nu}\d{\mu(x)}
    \end{equation*}
    so that $x\mapsto\left\lvert\int_Yf_x\d{\nu}\right\rvert\leq\int_Y|f_x|\d{\nu}$, which shows that $x\mapsto\int_Yf_x\d{\nu}$ is in $L(\mu)$.
    Likewise for the other section.
\end{proof}
\begin{remark}
    If $f\in M(X\times Y,\mathcal{M}\otimes\mathcal{Y})$, we may wish to see that $f\in L(\mu\times\nu)$.
    This is equivalent to saying that $|f|\in L(\mu\times\nu)$, and we may be able to compute this with an integrated integral, using Tonelli's Theorem.
\end{remark}
\section{Multidimensional Lebesgue Measure}
Let $\mathcal{B}(\R)$,$\mathcal{L}\subseteq\mathcal{P}(\R)$ denote the Borel and Lebesgue $\sigma-$algebras.
Recall that the Lebesgue measure is translation invariant.
\begin{remark}
    If $x,c\in\R$, $c\neq 0$, then the maps $T_x:\R\to\R$ by $y\mapsto x+y$ and $M_c:\R\to\R$ by $y\mapsto cy$ are continuous, hence Borel measurable.
    Thus if $E\in\mathcal{B}(\R)$, $x+E=T_x(E)=T_{-x}^{-1}(E)\in\mathcal{B}(\R)$.
    Similarly, $cE=M_{1/c}^{-1}(E)\in\B(\R)$.
\end{remark}
\begin{proposition}
    Let $f\in L(\R,\B(\R),\lambda)=L(\lambda)$.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item For $x\in\R$, $f\circ T_x\in L(\lambda)$ with $\int_{\R}f\circ T_x\d{\lambda}=\int_{\R}f\d{\lambda}$.
        \item For $0\neq c\in\R$, $f\circ M_c\in L(\lambda)$ with $\int_{\R}f\circ M_c\d{\lambda}=\frac{1}{|c|}\int_{\R}f\d{\lambda}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    This is a direct application of A2 Q3(b).
\end{proof}
Now, recall that $\B(\R^d)=\B(\R)\otimes\cdots\otimes\B(\R)$.
Let $\lambda_d=\lambda\times\cdots\times\lambda:\B(\R^d)\to[0,\infty]$ denote the $d-$dimensional Lebesgue measure.
We define $\mathcal{L}_d$ to be the completion of $(\R^d,\B(\R^d),\lambda_d)$.
\begin{remark}
    For suitable $f$, we say
    \begin{equation*}
        \int_{\R^d}f\d{\lambda_d}=\int_{\R^d}f(x_1,\ldots,x_d)\d{(x_1,\ldots,x_d)}
    \end{equation*}
    Fubini-Tonelli theorem tells us that
    \begin{equation*}
        \int_{\R^d}f\d{\lambda_d}=\int_{\R}\cdots\int_{\R}f(x_1,\ldots,x_d)dx_{\sigma(1)}\cdots\d{x_{\sigma(d)}}
    \end{equation*}
    where $\sigma:[d]\to[d]$ is any bijection.
\end{remark}
\begin{proposition}
    Let $f\in L(\R^d,\B(\R^d),\lambda_d)=L(\lambda_d)$.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item For $x\in\R^d$, let $T_x:\R^d\to\R^d$ be given by $T_x(y)=x+y$.
            Then $f\circ T_x\in L(\lambda)$ with
            \begin{equation*}
                \int_{\R^d}f\circ T)x\d{\lambda_d}=\int_{\R^d}f\d{\lambda_d}
            \end{equation*}
        \item For $A\in\Gl(d,\R)$, $f\circ A\in L(\lambda)$ with
            \begin{equation*}
                \int_{\R^d}f\circ A\d{\lambda_d}=\frac{1}{|\det A|}\int_{\R^d}f\d{\lambda_d}
            \end{equation*}
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[label=(\roman*)]
        \item This follows from the previous proposition as well as Fubini-Tonelli:
            \begin{align*}
                \int_{\R^d}f\circ T_x\d{\lambda_d} &= \int_{\R}\cdots\int_{\R}f(x_1+y_1,\ldots,x_d+y_d)\d{\lambda_1}\cdots\d{\lambda_d}\\
                                                   &= \int_{\R}\cdots\int_{\R}f(x_1,\ldots,x_d+y_d)\d{\lambda_1}\cdots\d{\lambda_d}\\
                                                   &\vdots\\
                                                   &= \int_{\R}\cdots\int_{\R}f(x_1,\ldots,x_d)\d{\lambda_1}\cdots\d{\lambda_d}\\
                                                   &= \int_{\R}f\d{\lambda_d}
            \end{align*}
        \item We can factor $A=A_1\cdots A_n$ where each $A_i$ is one of the following 3 types:
            \begin{itemize}[nolistsep]
                \item (add row to vector) $A_{ij}(x_1,\ldots,x_d)=(x_1,\ldots,x_i+x_j,\ldots,x_d)$.
                \item (swap) $S_{ij}(x_1,\ldots,x_d)=(x_1,\ldots,x_j,\ldots,x_i,\ldots,x_d)$
                \item (multiply row) $M_{ic}(x_1,\ldots,x_d)=(x_1,\ldots,cx_i,\ldots,x_d)$
            \end{itemize}
            Notice that $\det(A_{ij})=1=|\det S_{ij}|$, while $|\det(M_{ic})|=|c|$.
            If $f\geq 0$, we have for $i<j$
            \begin{equation*}
                \int_{\R^d}f\circ A_{ij}\d{\lambda_d}=\int_{\R}\cdots\int_{\R} f(x_1,\ldots,x_i+x_j,\ldots,x_d)\d{\lambda_1}\cdots\d{\lambda_d}=\int_{\R^d}f\d{\lambda_d}
            \end{equation*}
            by translation invariance.
            Similarly, $\int_{\R^d}f\circ S_{ij}\d{\lambda_d}=\int_{\R^d}f\d{\lambda_d}$ and $\int_{\R^d}f\circ M_{ic}\d{\lambda_d}=\frac{1}{|c|}\int_{\R^d}f\d{\lambda_d}$.
            Then
            \begin{align*}
                \int_{\R^d}f\circ A\d{\lambda_d} &= \int_{\R^d}f\circ A_1\circ\cdots\circ A_n\d{\lambda_d}\\
                                                 &=\frac{1}{|\det(A_n)|}\int_{\R^d}f\circ A_1\circ\cdots\circ A_{n-1}\d{\lambda_d}\\
                                                 &= \frac{1}{|\det(A)|}\int_{\R^d}f\d{\lambda_d}
            \end{align*}
    \end{enumerate}
\end{proof}
\chapter{Complex Measures}
\section{Signed Measures}
\begin{definition}
    Let $(X,\M,\mu)$ be a measurable space.
    A (finite) \textbf{signte measure)} on $(X,\M)$ is a function $\nu:\M\to\R$ such that
    \begin{itemize}[nolistsep]
        \item $\nu(\emptyset)=0$
        \item If $E_1,E_2,\ldots\in\M$ are disjoint, then $\nu\left(\bigcup_{i=1}^\infty E_i\right)=\sum_{i=1}^\infty\nu(E_i)$.
    \end{itemize}
\end{definition}
\begin{remark}
    \begin{enumerate}[nolistsep]
        \item It is possible to defined a signed measure into $(-\infty,\infty]$ or $[-\infty,\infty)$. %]
            For convenience, we work only with the finite case.
        \item As well, note that the series above is always absolutely convergent.
        \item If $F\subseteq E$ in $\M$, then $\nu(E\setminus F)=\nu(E)-\nu(F)$.
    \end{enumerate}
\end{remark}
\begin{example}
    \begin{enumerate}[nolistsep]
        \item If $\mu_1,\mu_2:\M\to[0,\infty)$, then $\nu=\mu_1-\mu_2$ is a signed measure. %]
        \item If $\mu:\M\to[0,\infty]$ is a measure and $f\in L(\mu)$, we define $f\cdot\mu:\M\to\R$ by $f\cdot\mu(E)=\int_E f\d{\mu}=\int_X 1_E f\d{\mu}$.
            This is a signed measure (LDCT).
    \end{enumerate}
\end{example}
\begin{proposition}
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $E_1\subseteq E_2\subseteq\cdots$ in $\M$, then $\nu\left(\bigcup_{i=1}^\infty E_i\right)=\lim_{n\to\infty}\nu(E_n)$.
        \item If $E_1\supseteq E_2\supseteq\cdots$ in $\M$, then $\nu\left(\bigcap_{i=1}^\infty E_i\right)=\lim_{n\to\infty}\nu(E_n)$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Identical as the proof as for (non-negative) measures.
\end{proof}
\begin{definition}
    Let $(X,\M,\mu)$ be a signed measure space.
    A set $E\in\M$ is \textbf{positive} (or \textbf{negative} or \textbf{null}) for $\nu$ if for any $F\subseteq E$, $F\in\M$, we have $\nu(F)\geq 0$ (or $\nu(F)\leq 0$ or $\nu(F)=0$).
\end{definition}
\begin{lemma}
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $P\in\M$ is positive and $Q\subseteq P$, then $Q$ is positive.
        \item If $P_1,P_2,\ldots\in\M$, then $P=\bigcup_{i=1}^\infty P_i$ is positive.
    \end{enumerate}
\end{lemma}
\begin{proof}
    The first statement is clear.
    For the second, suppose $E\subseteq P$, $E\in\M$, and let $Q_1=P_1$, $Q_{n+1}=P_{n+1}\setminus\bigcup_{i=1}^n P_i$.
    Each $Q_n$ is positive by (i) and $E=\bigcup_{i=1}^\infty(E\cap Q_i)$ as $E\subseteq P$.
    Thus $\nu(E)=\sum_{i=1}^\infty\nu(E\cap Q_i)\geq 0$.
\end{proof}
\begin{theorem}[Hahn Decomposition]
    Let $(X,\M,\mu)$ be a signed measure space.
    Then there exist $P,N$ in $\M$ such that
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $P$ is positive for $\nu$.
        \item $N$ is negative for $\nu$
        \item $P\cup N=X$, $P\cap N=\emptyset$.
    \end{enumerate}
    Furthermore, if $P',N'$ also satisfy the above constraints, then $P\triangle P'$ and $N\triangle N'$ are each null for $\nu$.
\end{theorem}
\begin{definition}
    A pair $(P,N)$, as above, is called a \textbf{Hahn decomposition} for $\nu$.
\end{definition}
\begin{proof}
    Every set named in this proof is assumed to be in $\M$.

    \textbf{I: If $E\in\M$, $\epsilon>0$, then there is $E_\epsilon\subseteq E$ such that
        \begin{enumerate}[nolistsep]
            \item $\nu(E_\epsilon)\geq\nu(E)$
            \item for any $B\subseteq E_\epsilon$, $\nu(B)-\epsilon$.
        \end{enumerate}
    }
    If not, then every $A\subseteq E$ satisfying (1), there exists $B\subseteq A$ such that $\nu(B)\leq-\epsilon$.
    Then, inductively, we find
    \begin{itemize}[nolistsep]
        \item $B_1\subseteq E$ such that $\nu(B_1)\leq -\epsilon$ and $\nu(E\setminus B_1)=\nu(E)-\nu(B_1)>\nu(E)$; hence
        \item $B_2\subseteq E\setminus B_1$ such that $\nu(B_2)\leq-\epsilon$ and $\nu(E\setminus(B_1\cup B_2))=\nu(E)-\sum_{i=1}^2\nu(B_i)>\nu(E)$.
        \item $B_{n+1}\subseteq E\setminus\bigcup_{i=1}^n B_i$, with $\nu(B_{n+1})\leq -\epsilon$ and $\nu(E\setminus\bigcup_{i=1}^{n+1}B_i)>\nu(E)$.
    \end{itemize}
    However, as $B_i\cap B_j=\emptyset$, we would have $\nu(\bigcup_{i=1}^\infty B_i)=\sum_{i=1}^\infty\nu(B_i)=-\infty$, violating finiteness of $\nu$.

    \textbf{II: If $E\in\M$, there is a positive $P\subseteq E$ such that $\nu(P)\geq\nu(E)$.}
    Let $E_0=E_1$ and we use $(I)$ and induction fo find $E_n\subseteq E_{n-1}$ such that $\nu(E_n)\geq\nu(E_{n-1})$ and if $B\subseteq E_n$, then $\nu(B)>-1/n$.
    Let $P=\bigcap_{n=1}^\infty E_n$.
    By continuity from above, $\nu(P)=\lim\nu(E_n)\geq\nu(E_0)=\nu(E)$.
    If $B\subseteq P$, then $B\subseteq E_n$ for each $n$ so $\nu(B)>-1/n$.
    Thus $P$ is positive for $\nu$.

    \textbf{III: Let $s=\sup\{\nu(E):E\in\M\}$.
        Then there is a sequence $E_1,E_2,\ldots$ such that $s=\lim_{n\to\infty}\nu(E_n)$.
    }
    For each $n$, find $P_n\subseteq E_n$, which is positive for $\nu$, with $\nu(P_n)\geq\nu(E_n)$.
    Let $P=\bigcup_{i=1}^\infty P_i$.
    We note that $P$ is positive for $\nu$ and we compute
    \begin{align*}
        s\geq \nu(P) &= \lim_{n\to\infty}\nu\left(\bigcup_{i=1}^\infty P_i\right)\geq \lim_{n\to\infty}\nu(P_n)\geq\nu(E_n)=s
    \end{align*}
    so $\nu(P)=s$.
    We let $N=X\setminus P$.
    If there were $E\subseteq N$ with $\nu(E)>0$, then $\nu(E\cup P)>\nu(E)+\nu(P)>s$, violating definition of $s$.
    Thus $\nu(E)\leq 0$, so $N$ is negative.

    \textbf{IV: Essential Uniqueness}
    If $P'$, $N'$ are another Hahn decomposition, then $P\triangle P'\subseteq N'\cup N$.
    Then $P\triangle P'$ is positive and negative, and thus null.
    The same result holds for $N'\triangle N$.
\end{proof}
\begin{proposition}
    Let $\mu$, $\nu$ be as above with $\mu$ finite.
    Then $\nu\ll\mu$ if and only if for any $\epsilon>0$, there is $\delta>0$ such that for $E\in\M$, $\mu(E)<\delta$ implies $|\nu(E)|<\infty$.
\end{proposition}
\begin{proof}
    First, since $|\nu(\bigcdot)|\leq \Re\nu^++\cdots+\Im\nu^-|$, it suffices to show the equivalence for finite measures.
    Suppose (AC') fails.
    Then there exists $\epsilon>0$ such that there is $E_n\in\M$ with $\mu(E_n)<1/2^n$ while $\nu(E_n)\geq\epsilon$.
    Let $F_n=\bigcup_{i=n}^\infty E_i$ so $F_1\supseteq F_2\supseteq\cdots$ with $\mu(F_n)\leq 1/2^{n-1}$ and hence by continuity from above, $\mu(\bigcap_{n=1}^\infty F_n)=\lim_{n\to\infty} \mu(F_n)$ while
    \begin{equation*}
        \nu\left(\bigcap_{n=1}^\infty F_n\right)=\lim_{n\to\infty}\nu(F_n)\geq\liminf_{n\to\infty}\nu(E_n)\geq\epsilon
    \end{equation*}
    so AC fails.
    Thus AC implies AC'.

    If AC' holds, there is $\delta_n>0$ so for $E$ in $\M$, $\mu(E)<\delta_n$ implies $\nu(E)<1/n$.
    Hence if $\mu(E)=0<\delta_n$ for all $n$, then $\nu(E)<1/n$ for any $n$, i.e. $\nu(E)=0$.
\end{proof}
\begin{lemma}
    Let $\mu,\nu:\M\to[0,\infty)$ be finite measures.
    Then either $\mu\perp\nu$ or to every $\epsilon>0$ and $E\in\M$ for which $\mu(E)>0$ and $E$ is positive $\nu-\epsilon\mu$.
\end{lemma}
\begin{proof}
    Let $(P_n,N_n)$ be a Hahn decomposition for $\nu-\frac{1}{n}\mu$ and $P=\bigcup_{n=1}^\infty P_n$, $N=X\setminus P=\bigcap_{n=1}^\infty N_n$.
    Then $N$ is negative for each $\nu-\frac{1}{n}$, so $0\leq\nu(N)\leq\frac{1}{n}\mu(N)$ for each $n$, so $\nu(N)=0$.
    If $\mu(P)=0$, then $\nu\perp\mu$.
    Otherwise, $\mu(P)>0$, so $\mu(P_n)>0$ for some $n$, and $E=P_n$ satisfies $\mu(E)>0$ and $(\nu-\frac{1}{n}\mu)(E)>0$.
\end{proof}
\begin{theorem}[Lebesgue-Radon-Nikodym]
    Let $(X,\M)$ be a measurable space, $\nu:\M\to\C$ a complex measure and $\mu:\M\to[0,\infty]$ be a $\sigma-$finite measure.
    Then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item There is a unique complex measure $\rho:\M\to\C$ such that $\rho\perp\mu$ and $\nu-\rho\ll\mu$
        \item There is $f\in L(\mu)$ such that $\nu-\rho=f\cdot\mu$.
    \end{enumerate}
\end{theorem}
\begin{remark}
    The decomposition $\nu=\rho+(\nu-\rho)$ is called the \textbf{Lebesgue decomposition} of $\nu$ with respect to $\mu$.
    The element $f\in L(\mu)$, above, is called the \textbf{Radon-Nikodym derivative} of $\nu$ with respect to $\mu$.
    We will often write $f=\frac{\d{\nu}}{\d{\mu}}$.
\end{remark}
\begin{proof}
    (I) Assume $\mu,\nu:\M\to[0,\infty)$ are finite measures.
    Let
    \begin{equation*}
        \mathcal{F}=\{f\in\overline{M}^+(X,\M):\int_E f\d{\mu}\leq\nu(E)\text{ for all $E$ in $\M$}\}
    \end{equation*}
    Indeed, let $A=\{x\in X:f(x)>g(x)\}$.
    Then for $E\in\M$,
    \begin{align*}
        \int_E\max\{f,g\}\d{\mu}=\int_{E\cap A}f\d{\mu}+\int_{E\setminus A} g\d{\mu}\leq \nu(E\cap A)+\nu(E\setminus A)=\nu(E)
    \end{align*}
    Thus if $f_1,\ldots,f_n\in\mathcal{F}$, then $\max\{f_1,\ldots,f_n\}\in\mathcal{F}$.
    Let $s=\sup\{\int_X f\d{\mu}:f\in\mathcal{F}\}\leq\nu(X)<\infty$.
    Hence for each $n$, there is $f_n\in\mathcal{F}$ such that $s-\frac{1}{n}<\int_X f_n\d{\mu}\leq s$.
    We let $g_n=\max\{f_1,\ldots,f_n\}\in\mathcal{F}$ so $g_n\leq g_{n+1}$, and we let $f=\lim_{n\to\infty}g_n$.
    Then
    \begin{equation*}
        s\geq\lim_{n\to\infty}\int_X \geq\lim_{n\to\infty}\int_X f_n\d{\mu}\geq\lim_{n\to\infty}\left(s-\frac{1}{n}\right)=s
    \end{equation*}
    so $s=\lim_{n\to\infty}\int_X g_n\d{\mu}=\int_X f\d{\mu}$ by monotone convergence.
    In particular, $f\in\overline{L}^+(\mu)$, so we may assume that $f\in L^+(\mu)$ (i.e. $\R$-valued).
    Again, by MCT,
    \begin{align*}
        \int_E f\d{\mu}=\lim_{n\to\infty}\int_E g_n\d{\mu}\leq\lim_{n\to\infty}\nu(E)=\nu(E)
    \end{align*}
    so $f\in\mathcal{F}$.

    Now, let $\rho=\nu-f\cdot\mu$, which is non-negative as $f\in\mathcal{F}$.
    If $\rho\not\perp\mu$, then the last lemma provides $\epsilon>0$ and $E\in\M$ which is positive such that
    \begin{equation*}
        \rho-\epsilon\mu=(\nu-f\cdot\mu)-\epsilon\mu=\nu-(f+\epsilon1)\mu
    \end{equation*}
    i.e. for $B\subseteq E$, $B\in\M$, $\int_B(f+\epsilon1)\d{\mu}=(f+\epsilon 1)\mu(B)\leq\nu(B)$.
    Hence if $A\in\M$, we have
    \begin{align*}
        \int_A(f+\epsilon1_E)\d{\mu} &= \int_{A\setminus E}f\d{\mu}+\int_A(f+\epsilon1_E)\d{\mu}\\
                                     &\leq \nu(A\setminus E)+\nu(A\cap E)
    \end{align*}
    so $f+\epsilon1_E\in\mathcal{F}$.
    However,
    \begin{align*}
        \int_X(f+\epsilon1_E)\d{\mu} &= \int_Xf\d{\mu}+\epsilon\mu(E)=s+\epsilon\mu(E)>s
    \end{align*}
    But these last two statements contradict definitions of $\mathcal{F}$ and $s$.
    Thus $\rho\perp\mu$.

    (II) Assume $\nu:\M\to[0,infty)$ and $\mu:\M\to[0,\infty]$ is $\sigma-$finite.
    We get $(X_n)_{n=1}^\infty\subseteq\M$ such that $X=\bigcupdot_{n=1}^\infty X_n$ and each $X_n\in\M$ has $\mu(X_n)<\infty$.
    Let $\nu_x=\nu_{X_i}$, $\mu_i=\mu_{X_i}$.
    Apply (I) to pairs $(\nu_i,\mu_i)$ to obtain measures $\rho_i:\M_{X_i}\to[0,\infty)$ $\rho_i\perp\mu_i$ and $\nu_i-\rho_i=f_i\cdot\mu_i\ll\mu_i$ where $f_i\in L^+(\mu_i)$.
    Define
    \begin{itemize}[nolistsep]
        \item $\rho:\M\to[0,\infty]$ by $\rho(E)=\sum_{i=1}^\infty\rho_i(E\cap X_i)$
        \item $f:X\to[0,\infty)$ by $f(x)=f_i(x)$ if $x\in X_i$.
    \end{itemize}
    It is easily checked that $\rho$ defines a measure and that $f\in M^+(X,\M)$.
    If $(E_i,F_i)$ realize $(E_i,F_i)$ reaizes $\rho_i\perp\mu_i$, then $\left(\bigcup_{i=1}^\infty E_i,\bigcup_{i=1}^\infty F_i\right)$ realizes $\rho\perp\mu$.
    Furthermore, for $E\in\M$ we have
    \begin{align*}
        \nu(E) &=\sum_{i=1}^\infty\nu(E\cap X_i)=\sum_{i=1}^\infty\left(\rho_i(E\cap X_i)+\int_{E\cap X_i}f_i\d{\mu_i}\right)\\
               &= \rho(E)+\int_E f\d{\mu}
    \end{align*}
    by monotone convergence.
    In particular, since $\nu(X)<\infty$, we see that $\rho$ is a finite measure and $f\in L^+(\mu)$.

    (III) Now suppose $\nu:\M\to\C$, $\mu:\M\to[0,\infty]$ is $\sigma-$finite.
    Apply the Jordan decomposition so that $\nu=(\Re\nu^+-\Re\nu^-)+i(\im\nu^+-\im\nu^-)$.
    Apply (II) to each component to get $(\rho_i,f_i)$ and let $\rho=\rho_1-\rho_2+i(\rho_3-\rho_4)$ and $f=f_1-f_2+i(f_3-f_4)$, which certainly satisfy the properties.

    (IV) Uniqueness.
    Suppose we have $\rho,\rho':\M\to\C$ satisfying the requiremenets.
    Since $\rho+(\nu-\rho)=\nu=\rho'+(\nu-\rho')$, we have $\rho-\rho'=(\nu-\rho')-(\nu-\rho)$ simulaneously singular and absolutely continuous with respect to $\mu$, so $\rho-\rho'=0$.
\end{proof}
\subsection{The Radon-Nikodym Derivative}
\begin{definition}
\end{definition}
Let us assume above that $\nu\ll\mu$, so (L-)R-N tells us that $\nu=f\cdot\mu$ for some $f\in L(\mu)$.
\begin{enumerate}
    \item If $f\in L(\mu)$, $f\cdot\mu=0$ if and only if $1_Ef=0$ $\mu-$a.e. for each $E\in\M$ if and only if $f=0$ $\mu-$a.e.
        Hence if $f,g\in L(\mu)$, then $f\cdot\mu=g\cdot\mu$ if and only if $f=g$ $\mu-$a.e.
    \item We let $L^1(\mu)=L(\mu)/\sim_\mu$ where $f\sim_\mu g$ if and only if $f=g$ $\mu-$a.e.
        Pointwise $\mu-$a.e. operations are legal.
\end{enumerate}
If $\nu=f\cdot\mu$ as above, we write $f=\frac{\d{\nu}}{\d{\mu}}$ in $L^1(\mu)$, so $\nu=\frac{\d{\nu}}{\d{\mu}}\cdot\mu$.
\begin{definition}
    Let $\nu:\M\to\C$ be a complex measure.
    We let $L(v)=L(\Re v^+)\cap\cdots L(\Im v^-)$ and for $f\in L(v)$, we define the \textbf{Lebesgue integral} by
    \begin{equation*}
        \int_X f\d{\nu}=\int_X f\d{(\Re v^+)}-\int_X f\d{(\Re v^-)}+i\left[\int_X f\d{(\Im v^+)}-\int_X f\d{(\Im v^-)}\right]
    \end{equation*}
    We let $L^1(\nu)=L(\nu)/\sim_\nu$.
\end{definition}
\begin{proposition}
    Let $\nu$ be a complex measure, $\mu$ a finite easure, and $\lambda$ a $\sigma-$finite measure, on a measurable space $X$.
    Then
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item If $\nu\ll\lambda$, then for $g\in L(\nu)$, $g\frac{\d{\nu}}{\d{\lambda}}\in L^1(\lambda)$.
        \item If $\nu\ll\mu$, $\mu\ll\lambda$, then $\nu\ll\lambda$ and $\frac{\d{\nu}}{\d{\lambda}}=\frac{\d{\nu}}{\d{\mu}}\frac{\d{\mu}}{\d{\lambda}}$
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[label=(roman*)]
        \item If $E\in\M$, then $\int 1_E\d{\nu}=\nu(E)=\frac{\d{\nu}}{\d{\lambda}}\cdot\lambda(E)=\int 1_E\frac{\d{\nu}}{\d{\lambda}}\d{\lambda}$.
            Thus the result holds by LDCT.
        \item If $E\in\M$, if $\lambda(E)=0$, then $\mu(E)=0$ so $\nu(E)=0$ so $\nu\ll\lambda$.
            Then for any $E\in\M$, apply (i) to get
            \begin{align*}
                \int 1_E\frac{\d{\nu}}{\d{\lambda}}\d{\lambda} = \nu(E) &= \int 1_E\frac{\d{\nu}}{\d{\mu}}\d{\mu}\\
                                                                        &= \int 1_E\frac{\d{\nu}}{\d{\mu}}\cdot\frac{\d{\mu}}{\d{\lambda}}
            \end{align*}
            and from above, $\frac{\d{\nu}}{\d{\lambda}}=\frac{\d{\nu}}{\d{\mu}}\frac{\d{\mu}}{\d{\lambda}}$ $\lambda-$a.e.
    \end{enumerate}
\end{proof}
\section{\texorpdfstring{$L^p-$}{Lp-}spaces}
Let $(X,\M,\mu)$ be a measure space.
Recall that $L^1(\mu)=L(\mu)/\sim_\mu$.
Likewise, if $1<p<\infty$, then we let $L^p(\mu)=\{f\in M(X,\M):\int_X|f|^p\d{\mu}<\infty\}/\sim_\mu$.
Note that the functional $\norm{\cdot}_1$ on $L^1(\mu)$ given by $\norm{f}_1=\int_X|f|\d{\mu}$ is a norm on $L^1(\mu)$.

If $\phi:\R\to\R$ is twice differentiable and for which $\phi''>0$, then $\phi$ is \textbf{strictly convex}.
If $x<y$ in $\R$, $0<t<1$, then $\phi((1-t)x+ty)<(1-t)\phi(x)+t\phi(y)$.
\begin{proposition}[Young's Inequality]
    If $a,b\geq 0$, $p,q>1$, $\frac{1}{p}+\frac{1}{q}=1$, then $ab\leq\frac{1}{p}a^\frac{1}{q}b^q$ with equality if $a^p=b^q$.
\end{proposition}
\begin{proof}
    By convexity of $e^x$,
    \begin{equation*}
        ab=e^{\log(ab)}=e^{\frac{1}{p}\log(a^p)+\frac{1}{q}\log(b^q)}\leq\frac{1}{p}e^{\log(a^p)}+\frac{1}{q}e^{\log(b^q)}=\frac{1}{p}a^p+\frac{1}{q}b^q
    \end{equation*}
    and equality holds if and only if $a^p=b^q$.
\end{proof}
\begin{remark}
    If $f,g\in L^{\R}(\mu)$, $f\geq g$ $\mu-$a.e. and $f\neq g$ $\mu-$a.e, then $\int_X f\d{\mu}>\int_X g\d{\mu}$.
    Indeed, $(f-g)\cdot\mu$ is a non-zero (positive) measure.
\end{remark}
\begin{proposition}[H\"older's Inequality]
    Let $p,q>1$, $\frac{1}{p}+\frac{1}{q}=1$, $f\in L^p(\mu)$, $g\in L^q(\mu)$.
    Then $fg\in L^1(\mu)$ with
    \begin{equation*}
        \norm{f}_1\leq\norm{f}_p\norm{g}_q
    \end{equation*}
    with equality holding onliy if there are $\alpha,\beta\geq 0$ such that $\alpha|f|^p=\beta|g|^q$ $\mu-$a.e.
\end{proposition}
\begin{proof}
    We may assume that $\norm{f}_p\norm{g}_q>0$.
    By Young's inequality,
    \begin{equation*}
        \frac{|f(x)g(x)|}{\norm{f}_p\norm{g}_q}\leq\frac{1}{p}\frac{|f(x)|^p}{\norm{f}_p^p}+\frac{1}{q}\frac{|g(x)|^q}{\norm{g}_q^q}
    \end{equation*}
    Integrate over $X$ and multiply by $\norm{f}_p^p\norm{g}_q^q$ to see that
    \begin{align*}
        \norm{fg}_1 &\leq\frac{1}{p}\cdot\frac{\norm{f}_p^p}{\norm{f}_p^{p-1}}\norm{g}_q+\frac{1}{q}\frac{\norm{g}_q^q}{\norm{g}_q^{q-1}}\norm{f}_p\\
                    &\leq\left(\frac{1}{p}+\frac{1}{q}\right)\norm{f}_p\norm{g}_q
    \end{align*}
    with equality holding if and only if $\norm{g}_q^q|f|^p=\norm{f}_p^p|g|^q$.
\end{proof}
\begin{remark}
    We define $\sgn:\C\to\C$ by $\sgn(z)=\frac{z}{|z|}$ if $z\neq 0$, and $0$ if $z=0$.
\end{remark}
\begin{proposition}[Minkowski's Inequality]
    If $p>1$ and $f,g\in L^p(\mu)$, then $f+g\in L^p(\mu)$ with $\norm{f+g}_p\leq\norm{f}_p+\norm{g}_q$ with equality if and only if $\sgn f=\sgn g$ $\mu-$a.e. and there are $\alpha,\beta\geq 0$ so $\alpha|f|=\beta|g|$ $\mu-$a.e.
\end{proposition}
\begin{proof}
    We have, by H\"older's inequality used twice,
    \begin{align*}
        |f+g|^p &= |f+g||f+g|^{p-1}\\
                &\leq(|f|+|g|)|f+g|^{p-1}\\
                &\leq \norm{f}_p\norm{|f+g|^{p-1}}_q+\norm{g}_q\norm{ |f+g|^{p-1}}_q\\
                &= (\norm{f}_p+\norm{g}_q)\norm{|f+g|^{p-1}}_q\tag{$*$}
    \end{align*}
    where equality holds at the first inequality $\sgn f=\sgn g$, and at the second inequality $\alpha|f|^p=\norm{f}_p\norm{ |f+g|^{p-1}}_q$ and $\alpha|g|^p=\norm{g}_p\norm{|f+g|^{p-1}}_q$ where $\alpha=\norm{ |f+g|^{p-1}}_q$.
    Notice that $q(p-1)=p$ so that
    \begin{equation*}
        \norm{ |f+g|^{p-1}}_q=\left(\int |f+g|^{(p-1)q}\right)^{1/q}=\norm{f+g}_p^{p/q}
    \end{equation*}
    Furthermore, $|f+g|^p\leq(|f|+|g|)^p\leq 2^p\max\{|f|,|g|\}^p\in L^1(\mu)$.
    Thus by ($*$),
    \begin{align*}
        \norm{f+g}_p=\frac{\norm{f+g}_p}{\norm{f+g}_p^{p/q}}\leq\norm{f}_p+\norm{g}_q
    \end{align*}
    and the equality situation is described above.
\end{proof}
\begin{remark}
    This implies that $(L^p(\mu),\norm{\bigcdot}_p)$ is a normed space.
\end{remark}
\begin{lemma}
    Let $(L,\norm{\bigcdot})$ be a normed space.
    Then $(L,\norm{\bigcdot})$ is a Banach space if and only $\sum_{k=1}^\infty f_k$ converges in $L$ whenever $\sum_{k=1}^\infty\norm{f_k}<\infty$ in $\R$.
\end{lemma}
\begin{proof}
    ($\Leftarrow$) Let $(f_n)_{n=1}^\infty$ be Cauchy in $(L,\norm{\bigcdot})$.
    Then we can find a subsequence $(f_{n_k})_{k=1}^\infty$ such that $\norm{f_{n_{k+1}}-f_{n_k}}<1/2^k$ for each $k$.
    We then use our assumption to let $f=f_{n_1}+\sum_{k=1}^\infty(f_{n_{k+1}}-f_{n_k})\in L$.
    Check that $f=\lim f_{n_k}$, so $f=\lim f_n$.
\end{proof}
\begin{theorem}
    Let $(X,\M,\mu)$ be a measure space and $1\leq p<\infty$.
    Then $(L^p(\mu),\norm{\bigcdot}_p)$ is a Banach space.
\end{theorem}
\begin{proof}
    We use the lemma.
    Let $(f_k)_{k=1}^\infty\subset L^p(\mu)$ such that $s=\sum_{k=1}^\infty\norm{f_k}_p<\infty$.
    We think of each $f_k$ as an element of $M(X,\M)$.
    Let for $n\in\N$ $g_n=\sum_{k=1}^n|f_k$ and $g=\sum_{k=1}^\infty|f_k|\in M^+(X,\M)$.
    Now by Minkowski's inequality,
    \begin{equation*}
        \norm{g_n}_p\leq\sum_P{k=1}^n\norm{f_k}_p\leq s
    \end{equation*}
    so
    \begin{equation*}
        \norm{g_n}^p\leq s^p
    \end{equation*}
    and hence by monotone convergence
    \begin{equation*}
        \int|g|^p=\lim_{n\to\infty}\int|g_n|^p\leq s^p<\infty
    \end{equation*}
    so $|g|^p\in \overline{L}^+(\mu)$. By replacing values on a null set, we may assume $|g|^q\in L^+(\mu)$.
    Now, set $f(x)=\sum_{k=1}\infty f_k(x)$ for $\mu-$ae. $x$ in $X$.
    Then $|f|\leq\sum_{k=1}^\infty|f|\leq|g|$ which shows that $f$ is finite and thus $\mu-$a.e. equivalent to an element of $M(X,\M)$, which we will also call $f$.
    Since $|f|^p\leq|g|^p$< we see that $f\in L^p(\mu)$.
    Now for each $n$,
    \begin{equation*}
        \left\lvert f-\sum_{k=1}^n f_k\right\rvert^p \leq\left(|f|+\sum_{k=1}^n|f_k|\right)^p\leq|g|^p\in L(\mu)
    \end{equation*}
    and $\lim_{n\to\infty}\left\lvert f-\sum_{k=1}^\infty f_j\right\rvert^p=0$ $\mu-$a.e.
    Thus by LDCT, we have
    \begin{equation*}
        \norm{f-\sum_{k=1}^n f_k}_p^p=\int\left\lvert f-\sum_{k=1}^\infty f_k\right\rvert^p
    \end{equation*}
    so $f=\sum_{k=1}^\infty f_k\in L^p(\mu)$.
\end{proof}
\begin{definition}
    Let $(L,\norm{\cdot})$ be a $\C-$normed Banach space.
    We let its \textbf{dual space} be
    \begin{equation*}
        L^*=\{\Phi:L\to\C\mid\phi\text{ linear and }\norm{\phi}_*=\sup\{|\phi(f)|:f\in L,\norm{f}\leq 1\}<\infty\}
    \end{equation*}
\end{definition}
\begin{remark}
    \begin{enumerate}
        \item $L^*$ is itself a $\C-$vector space with norm $\norm{}_*$:
            \begin{align*}
                \norm{\phi}_*=0 &\Leftrightarrow |\Phi(f)|=0\text{ for all $f\in L$}, \norm{f}\leq 1\\
                                &\Leftrightarrow \Phi(f)=\norm{f}\Phi\left(\frac{1}{\norm{f}}f\right)=0\text{ for all }f\in L\setminus\{0\}\\
                                &\Leftrightarrow \Phi=0
            \end{align*}
            Linearity and respecting scalars is obvious.
        \item If $\Phi\in L^*$, $\Phi$ is Lipschitz, hence continuous.
            Indeed, if $f\in L\setminus\{0\}$, then $|\Phi(f)|=\norm{f}\left\lvert\Phi\left(\frac{1}{\norm{f}}f\right)\right\rvert\leq\norm{\phi}_*\norm{f}$ and hence if $f,g\in L$, $|\Phi(f)-\Phi(g)|=|\Phi(f-g)|\leq\norm{\Phi}_*\norm{f-g}$.
    \end{enumerate}
\end{remark}
\begin{theorem}
    Let $(X,\M,\mu)$ be a measure space, $p,q>1$, $\frac{1}{p}+\frac{1}{q}=1$.
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item For $g\in L^q(\mu)$ we have $\Phi_g\in L^p(\mu)^*$ given by
            \begin{equation*}
                \Phi_g(f)=\int_X fg\d{\mu}
            \end{equation*}
            satisfies $\norm{\Phi_g}_*=\norm{g}_q$
        \item If $\Phi\in L^p(\mu)^*$, then $\Phi=\Phi_g$ for some $g\in L^q(\mu)$.
            Hence, $g\mapsto\Phi_g:L^q(\mu)\to L^p(\mu)^*$ is an isometric surjection.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}[label=(\roman*)]
        \item First notice for $f\in L^p(\mu)$,
            \begin{equation*}
                \int|fg|=\norm{fg}_1\leq\norm{f}_p\norm{g}_q
            \end{equation*}
            so $fg\in L^1(\mu)$, so $\Phi_g(f)=\int fg$ makes sense.
            Again, we use H\"older's inequality to see for $f\in L^p(\mu)$ with $\norm{f}_p\leq 1$, we have
            \begin{equation*}
                \left\lvert\Phi_g(f)\right\rvert=\left\lvert\int fg\right\rvert\leq\int|fg|=\norm{fg}_1\leq\norm{f}_p\norm{g}_q\leq\norm{g}_q
            \end{equation*}
            so $\norm{\Phi_g}_*\leq\norm{g}_q$.
            To see the converse inequality, for $g\neq 0$, let
            \begin{equation*}
                f=\frac{1}{\norm{g}_q^{q-1}}|g|^{q-1}\overline{\sgn g}
            \end{equation*}
            Then $\frac{1}{p}=1-\frac{1}{q}=\frac{q-1}{q}$, $q=(q-1)p$ and we have
            \begin{equation*}
                \int|f|^p\leq\frac{1}{\norm{g}_q^{(q-1)p}}\int|g|^{(q-1)p}=\frac{1}{\norm{g}_q^q}\int|g|^q=1
            \end{equation*}
            so $\norm{f}_p\leq 1$.
            Thus
            \begin{align*}
                \norm{\Phi_g}_* &\geq |\Phi_g(h)|=\left\lvert\frac{1}{\norm{g}_q^{q-1}}\int|g|^{q-1}\overline{\sgn g}g\right\rvert\\
                                &= \frac{1}{\norm{g}_q^{q-1}}\int|g|^q=\frac{\norm{g}_q^q}{\norm{g}^{q-1}}=\norm{g}_q
            \end{align*}
        \item Let $\Phi\in L^p(\mu)^*$.
            (I) Suppose that $\mu(X)<\infty$.
            Let $\nu:\M\to\C$ be $\nu(E)=\Phi(1_E)$.
            Then $\nu(\emptyset)=\Phi(1_\emptyset)=0$.
            If $E_1,E_2,\ldots\in\M$, $E_i\cap E_j=\emptyset$ for $i\neq j$, then $E=\bigcupdot_{i=1}^\infty E_i$ and we have
            \begin{align*}
                \norm{1_E-\sum_{i=1}^n 1_{E_i}}_p^p &= \int\left\lvert 1_{\bigcup_{i=n+1}^\infty E_i}\right\rvert^p\d{\mu}\\
                                                    &= \mu\left(\bigcup_{i=n+1}^\infty E_i\right)\\
                                                    &= \sum_{i=n+1}^\infty\mu(E_i)
            \end{align*}
            which goes to $0$ as $n\to\infty$.
            Thus $1_E=\lim_{n\to\infty}\sum_{i=1}^n 1_{E_i}$ in $L^p(\mu)$.
            Thus, as $\Phi$ is linear and continuous, we have
            \begin{align*}
                \nu(E)=\Phi(1_E) &= \Phi\left(\lim_{n\to\infty}\sum_{i=1}^n 1_{E_i}\right)=\lim_{n\to\infty}\sum_{i=1}^n\Phi(1_{E_i})\
                                 &= \lim_{n\to\infty}\sum_{i=1}^n\nu(E_i)=\sum_{i=1}^\infty\nu(E_i)
            \end{align*}
            and thus $\nu$ is a $\C-$measure.
            Furthermore, if $E\in\M$ satisfies $\mu(E)=0$, then $1_E=0$ $\mu-$a.e, so $\nu(E)=\Phi(1_E)=\Phi(0)=0$ and $\nu\ll\mu$.
            Thus the Radon-Nikodym Theorem provides $g=\frac{\d{\nu}}{\d{\mu}}$ in $L^1(\mu)$ such that $\nu(E)=\int_E g\d{\mu}$.

            We now show that $g\in L^q(\mu)$.
            First, if $f\in M(X,\M)/\sim_\mu$ is essentially bounded, then
            \begin{equation*}
                \int|fg|\d{\mu}\leq\int M|g|\d{\mu}=M\norm{g}<\infty
            \end{equation*}
            so $fg\in L^1(\mu)$.
            We then note that
            \begin{align*}
                M(g) &\geq \sup\{\left\lvert\int fg\d{\mu}\right\rvert:f\in M(X,\M)/\sim_\mu\text{ is essentially bounded and }\norm{f}_p\leq 1\}\tag{$*$}
            \end{align*}
            For $f$ as in ($*$), we find $(\psi_n)_{n=1}^\infty\subset S(X,\M)/\sim_\mu$ such that $f=\lim_{n\to\infty}\psi_n$ $\mu-$a.e. and such that $|\psi_n|\leq|f|$.
            Notice for $\phi\in S(X,\M)/\sim_\mu$, $\psi=\sum_{j=1}^n c_i1_{E_i}$ in standard form, that
            \begin{align*}
                \Phi(\psi)&= \sum_{j=1}^m c_i\Phi(1_{E_j})=\sum_{j=1}^n c_i\nu(E_j)\\
                          &=\sum_{j=1}^m c_j\int_X 1_{E_j}g\d{\mu}=\int\psi g\d{\mu}
            \end{align*}
            Thus, $|\psi_n-f|^p\leq(|\psi_n|+|f|)^p\leq 2^p|f|^p\in L^1(\mu)$ so by LDCT,
            \begin{equation*}
                \lim_{n\to\infty}\norm{\psi_n-f}_p^p=\lim_{n\to\infty}|\phi_n-f|^p\d{\mu}=0
            \end{equation*}
            and $|\psi_ng|=|\psi_n||g|\leq|fg|\in L^1(\mu)$.
            Thus for such $f$, using continuity of $\phi$, and then LDCT,
            \begin{align*}
                \Phi(f)=\lim_{n\to\infty}\Phi(\psi_n)=\lim_{n\to\infty}\int\psi_n g\d{\mu}=\int fg\d{\mu}
            \end{align*}
            Thus we see that $M(g)\leq\norm{\Phi}_*<\infty$.
            Now we let $(\varphi_n)_{n=1}^\infty\subset S(X,\M)/\sim_\mu$ such that $\lim\varphi_n=g$ and $|\varphi_n|\leq|\varphi_{n+1}|\leq|g|$.
            We define
            \begin{equation*}
                f_n=\frac{1}{\norm{\varphi_n}_q^{q-1}}|\varphi_n|^{q-1}\overline{\sgn g}
            \end{equation*}
            which is essntially bounded and with $\int|f_n|^p\leq 1$ as above.
            Furthermore, by MCT,
            \begin{equation*}
                \int|g|^q\d{\mu}=\lim_{n\to\infty}\int|\varphi_n|^q\d{\mu}
            \end{equation*}
            and we compute
            \begin{align*}
                \norm{g}_q&=\lim_{n\to\infty}\norm{\varphi_n}_q=\lim_{n\to\infty}\frac{1}{\norm{\varphi_n}_q^{q-1}}\int|\varphi_n|^q\\
                          &\lim_{n\to\infty}\int|f_n||\varphi_n|\leq\liminf_{n\to\infty}\int|f_n||g|\d{\mu}\\
                          &= \liminf\int f_ng\d{\mu}\leq\norm{\Phi}_\infty<\infty
            \end{align*}
            so $g\in L^q(\mu)$.
            We see that $\Phi=\Phi_g$ by mimicking the same computation as earlier, but for $f$ not necessarily essentially bounded.

            (II) Assume now that $\mu$ is a general measure.
            If $E\in\mathcal{M}$, identify $L^p(\mu_E)\cong 1_EL^p(\mu)\subseteq L^p(\mu)$ and likewise for $q$.
            If $F\in\M$, $\mu(F)<\infty$, then (I) provides $g_G$ in $1_FL^p(\mu)$ such that $\phi(1_Ff)=\int_F fg_F\d{\mu}=\int_X fg_F\d{\mu}$ as $g_F=1_Fg_F$.
            Notice that if $F\subseteq F'$, where $F'\in\M$, $\mu(F')<\infty$, then $g_F=g_{F'}$ $\mu_F-$a.e.
            Hence if $F_1,F_2,\ldots\in\M$, each $\mu(F_i)<\infty$, then on $E=\bigcup_{i=1}^\infty F_i$, we may uniquely define $g_E$ so $g_E=g_{F_n}$ $\mu_{F_n}-$a.e. and $1_Eg_E=g_E$.
            Let $E_n=\bigcup_{i=1}^n F_i$, and MCT and (I) and (i) provide
            \begin{equation*}
                \int|g_E|^q\d{\mu}=\lim_{n\to\infty}\int|g_{E_n}|^q=\lim_{n\to\infty}\norm{\Phi|_{1_{E_n}L^p(\mu)}}_*\leq\norm{\Phi}_*
            \end{equation*}
            so that $g_E\in L^q(\mu)$.
            In fact, $g_E=1_EL^q(\mu)$.
            We then let
            \begin{equation*}
                s=\sup\left\{\int|g_E|^q:E\in\M\text{ is $\sigma-$finite for $\mu$}\right\}\leq\norm{\Phi}_*<\infty
            \end{equation*}
            Then let $E_1,E_2,\ldots,\in\M$ each be $\sigma-$finite for $\mu$, such that $\lim_{n\to\infty}|g_{E_n}|^q=s$.
            Then $E=\bigcup_{i=1}^\infty E_i$ is $\sigma-$finite, and again using MCT,
            \begin{equation*}
                s\geq\int|g_E|^q\d{\mu}=\lim_{n\to\infty}\int|g_{\bigcup_{i=1}^\infty E_i}|^q\d{\mu}\geq\lim_{n\to\infty}\int|g_{E_n}|^qd{\mu}=s
            \end{equation*}
            so that $s=\int|g_E|^q=s$.
            Now if $E'\in\M$ is $\sigma-$finite for $\mu$ such that
            \begin{equation*}
                s+\int|g_{E'\setminus E}|^q\d{\mu}=\int|g_E|^q\d{\mu}+\int|g_{E\setminus E}|^q\d{\mu}=\int|g_E|^q\d{\mu}\leq s
            \end{equation*}
            and we conclude that $g_{E'\setminus E}=0$ $\mu-$a.e.

            Finally, if $f\in L^p(\mu)$, we think of $f$ as a function and let
            \begin{equation*}
                E_f=\bigcup_{n=1}^\infty\left\{x\in X:|f(x)|^p<\frac{1}{n}\right\}
            \end{equation*}
            so $E_f$ is $\sigma-$finite.
            Decompose $E_f\cup E=\bigcup_{i=1}^\infty E_i$, each $E_i\in\M$, $\mu(E_i)<\infty$, $E_1\subseteq E_2\subseteq\cdots$ and we have
            \begin{itemize}[nolistsep]
                \item $\lim_{n\to\infty}\norm{f-1_{E_n}f}_p=0$ (LDCT argument we saw in (I))
                \item $|fg_{E_n}|\leq|fg_E|\in L^1(\mu)$
            \end{itemize}
            Thus by continuity of $\Phi$, by LDCT and (I),
            \begin{equation*}
                \Phi(f)=\lim_{n\to\infty}\Phi(1_{E_n}f)=\lim_{n\to\infty}\int 1_{E_n}fg_E\d{\mu}=\int fg_E\d{\mu}
            \end{equation*}
            Hence $\Phi=\Phi_{g_E}$.
    \end{enumerate}
\end{proof}
\section{Radon Measures}
\begin{definition}
    Let $(X,d)$ be a metric space.
    We say that $(X,d)$ is \textbf{locally compact} if for each $x\in X$, there is $\epsilon_x>0$ such that $\overline{B_{\epsilon_x}}(x)$ is compact.
\end{definition}
\begin{example}
    \begin{enumerate}[label=(\roman*)]
        \item $\R^d$ with the usual metric is locally compact.
            Any closed ball $\overline{B_\epsilon(x)}$ is cmpact (Heine-Borel)
        \item Let $X$ be any non-empty set, $d$ the discrete metric.
            If $x\in X$, then $B_\epsilon(x)=\overline{B_\epsilon(x)}$ is compact, provided that $X$ is infinite, exactly for $0<\epsilon\leq 1$.
            Note that we distinguish $\overline{B_{\epsilon}(x)}$ from $\overline{B}_\epsilon(x)=\{y:d(x,y)<\epsilon\}$.
        \item If $C$ is a closed subset and $U$ an open subset of a locally compact space, then $C,U$ and $C\cap U$, $C\cup U$ are locally compact.
    \end{enumerate}
\end{example}
\begin{definition}
    Let $(X,d)$ be a locally compact metric space.
    A measure $\mu:\B(x)\to[0,\infty]$ is called a \textbf{Radon measure} if it satisfies
    \begin{itemize}[nolistsep]
        \item \textit{(outer regularity)} For $E\in\B(X)$, $\mu(E)=\inf\{\mu(U):E\subseteq U, U\text{ open}\}$.
        \item \textit{(locally finite)} For $K\subseteq X$ compact, $\mu(K)<\infty$
        \item \textit{(inner regular on open sets)} If $U\subseteq X$ is open, then $\mu(U)=\sup\{\mu(K):K\subseteq U, K\text{ is compact}\}$.
    \end{itemize}
\end{definition}
\begin{proposition}
    Let $\mu$ be a Radon measure, as above.
    Then if $E\in\B(X)$ such that $\mu(E)<\infty$, then inner regularity holds for $E$ as well.
    Thus, if $X$ is $\sigma-$finite for $\mu$, then $\mu$ is inner regular for each $E\in\B(X)$.
\end{proposition}
\begin{proof}
    First assume that $\mu(E)<\infty$.
    Let $\epsilon>0$.
    Let
    \begin{itemize}[nolistsep]
        \item $E\subseteq U$, $U$ open, $\mu(E)<\mu(E)+\epsilon$ implies $\mu(U\setminus E)<\epsilon$.
        \item $F\subseteq U$, $F$ compact, $\mu(U)<\mu(F)+\epsilon$, and
        \item $U\setminus E\subseteq C$, so $V$ is open and $\mu(V)<\epsilon$.
    \end{itemize}
    Let $K=F\setminus V=F\cap(X\setminus V)\subseteq F\setminus(U\setminus E)\subseteq F\cap E\subseteq E$ and is compact with
    \begin{align*}
        \mu(K) &= \mu(F)-\mu(F\cap V)\\
               &> \mu(U)-\epsilon-\mu(V)>\mu(E)-2\epsilon
    \end{align*}
    Now, if $E$ is $\sigma-$finite for $\mu$, write $E=\bigcup_{i=1}^\infty E_i$, each $E_i\in\mathcal{B}(X)$, $\mu(E_i)<\infty$, $E_1\subseteq E_2\subseteq\cdots$.
    For each $n$, let $K_n\subseteq E_n$ such that $\mu(K_n)\leq\mu(E_n)<\mu(K_n)+1/n$.
    Then by continuity from below, $\mu(E)=\lim\mu(E_n)=\lim\mu(K_n)$ so $\mu(E)=\sup_{n\in\N}\mu(K_n)$.
\end{proof}
\begin{remark}
    We say that $(X,d)$ is \mbf{$\sigma$-compact} if $X=\bigcup_{n=1}^\infty K_n$, where each $K_n$ is compact.
    If $\mu$ is a Radon measure, then $\sigma-$compact implies $\sigma-$finite.
\end{remark}
\chapter{Fourier Series}
If $f$ is the sum $f(x)=a_0+\sum_{n=1}^\infty a_n\cos nx+\sum_{n=1}^\infty b_n\sin nx$.
Then, assuming we can integrate term by term,
\begin{equation*}
    a_0=\frac{1}{2\pi}\int_{-\pi}^\pi f(x)\d{x},\quad a_n=\frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos nx\d{x},\quad b_n=\frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin nx\d{x}
\end{equation*}

Riesz Representation Theorem.
Let $(X,d)$ be a metric space, $I:C_c(X)\to\C$ a positive linear functional.
Then there is a unique Radon measure $\mu:\B(X)\to[0,\infty]$ such that $I(f)=\int_X f\d{\mu}$, $f\in C_c(G)$.
We let $U\subseteq C$, $\mu^0(U)=\sup\{I(f):f\prec U\}$, $E\subseteq X$, $\mu^*(E)=\inf\left\{\sum_{i=1}^\infty\mu^0(E_i):U\subseteq\bigcup_{i=1}^\infty,U_i\in\tau\right\}$.

(III) We have that $\B(X)\subseteq\M$.
In particular, $\mu=\mu^*|_{\B(x)}$ satisfies $\mu(U)=\mu^*(U)$ for $U$ open, and $\mu$ is outer regular, by (I), and locally finite, by (II).
It suffices to show that $U\in\M$ whenever $U$ is open.

Suppose $V\subseteq X$ is open with $\mu^*(V)<\infty$ (say $\overline{V}$ is compact), and let $\epsilon>0$.
We let
\begin{itemize}[nl]
    \item $f\prec U\cap V$ be so $\mu^*(U)\cap V<I(f)+\epsilon$
    \item $g\prec V\setminus\supp f$ be such $\mu^*(V\setminus\supp f)< I(g)+\epsilon$
\end{itemize}
Then $f+g\prec V$ as $\supp f\cap\supp g=\emptyset$, and we have
\begin{align*}
    \mu^*(V\cap U)+\mu^*(V\setminus U) &< I(f)+\epsilon+\mu^*(V\setminus\supp f)\\
                                       &< I(f)+I(g)+2\epsilon\\
                                       &= I(f+g)+2\epsilon\\
                                       &\leq \mu^0(V)+2\epsilon=\mu^*(V)+2\epsilon
\end{align*}
so, since $\epsilon>0$ is arbitrary, $\mu^*(V\cap U)+\mu^*(V\setminus U)\leq\mu^*(V)$.
Now, if $E\subseteq X$, $\mu^*(E)<\infty$, for each $\epsilon>0$ we find open $V\supseteq E$ such that $\mu^*(V)=\mu^0(E)<\mu^*(E)+\epsilon$.
Then
\begin{equation*}
    \mu^*(E)+\epsilon > \mu^*(V) \geq \mu^*(V\cap U)+\mu^*(V\setminus U)\geq\mu^*(E\cap U)+\mu^*(E\setminus U)
\end{equation*}
and since $\epsilon$ is arbitrary, $\mu^0(E)\geq\mu^*(E\cap U)+\mu^*(E\setminus U)$.
Notice that this also holds immediately if $\mu^*(E)=\infty$.

(IV) $I(f)=\int_X f\d{\mu}$ for $f$ in $C_c(X)$.
First, if $f\in C_c(X)$, we may write $f_1-f_2+i(f_3-f_4)$ where $f_i\geq 0$.
Let $M_i=\sup\{f_i(x):x\in X\}$ and we see that each $_i=(M_i+1)\frac{1}{M_i+1}f_i$, where $0\leq\frac{1}{M_i+1}f_i\leq 1$.
Hence it suffices to establish this for $0\leq f\leq 1$.
Now let $K_0=\supp f$, for $j=1,\ldots,n$, let $K_j=f^{-1}\left(\left[\frac{j}{n},1\right]\right)$ so each $K_0,\ldots,K_n$ is compact and $K_0\supseteq K_1\supseteq\cdots\supseteq K_n$.
Then let $f_j=\min\left\{\max\left\{f-\frac{j-1}{n}1,0\},\frac{1}{n}\right\}\right\}$.

Then $f=\sum_{j=1}^n f_j$ and $1_{K_j}\leq nf_j\leq 1_{K_{j-1}}$, $j=1,\ldots,n$.
Hence, taking integrals, we see $\mu(K_j)\leq n\int_X f_j\d{\mu}\leq \mu(K_{j-1})$, so that
\begin{equation*}
    \frac{1}{n}\sum_{j=1}^n\mu(K_j)\leq \int_X f\d{\mu}\leq\frac{1}{n}\sum_{j=1}^n\mu(K_{j-1})\tag{$*$}
\end{equation*}
On the other hand, we have $K_j\prec nf_j\prec K_{j-1}^\circ$, so using (II), $\mu(K_j)\leq nI(f_j)\leq\mu(K_{j-1}^\circ)\leq\mu(K_{j-1})$.
Thus
\begin{equation*}
    \frac{1}{n}\sum_{j=1}^n\mu(K_j)\leq I(f)\leq\frac{1}{n}\mu(K_{j-1})\tag{$\dagger$}
\end{equation*}
Hence, by ($*$) and ($\dagger$), we obtain
\begin{equation*}
    |I(f)-\int_X f\d{\mu}|\leq\frac{1}{n}(\mu(K_0)-\mu(K_1))\leq\frac{1}{n}\mu(K_0)
\end{equation*}
and this holds for any $n\in\N$, so $I(f)=\int_X f\d{\mu}$.

(V) Inner regularity on open sets.
Let $U\subseteq X$ be open.
Find $(f_n)_{n=1}^\infty\subseteq C_c(X)$, each $f_n\prec U$ so $\lim_{n\to\infty}I(f_n)=\mu^0(U)=\mu(U)$.
Let $K_n=\supp f_n\subseteq U$.
Then, by (IV),
\begin{equation*}
    I(f_n)=\int f_n\d{\mu}\leq\int 1_{K_n}\d{\mu}=\mu(K_n)\leq \mu(U)
\end{equation*}
and hence, by squeeze, $\lim_{n\to\infty}\mu(K_n)=\mu(U)$, i.e. $\mu(U)\leq\sup\{\mu(K):K\subseteq U,K\text{ compact}\}$ where ``$\geq$'' is obvious.

(VI) Uniqueness.
Let $\mu'$ be a Radon measure for which $\int f\d{\mu'}=I(f)$ for $f\in C_c(X)$.
Then, if $U$ is open and $K\prec f\prec U$, then
\begin{equation*}
    \mu'(K)=\int_{1_K}\d{\mu'}\leq\int f\d{\mu'}=I(f)=\int f\d{\mu}\leq 1_U\d{\mu}=\mu(U)
\end{equation*}
so
\begin{equation*}
    \sup\{\mu'(K)LK\subseteq U,K\text{ compact}\}\leq\sup\{I(f):f\prec U\}\leq\mu'(U)
\end{equation*}
but, by inner regularity of $\mu'$ on open sets and definition of $\mu(U)=\mu^0(U)$, we see $\mu'(U)\leq \mu(U)\leq\mu'(U)$.
Thus $\mu'=\mu$ on open sets.
Since each is outer regular, hence $\mu'=\mu$ on $\B(X)$.
\begin{proposition}
    Let $(X,d)$ be a locally compact measure space and $\mu:\B(x)\to[0,\infty]$ a Radon measure.
    Then for $1\leq p<\infty$, we have that $C_c(X)/{\sim_\mu}$ is dense in $L^p(\mu)$.
\end{proposition}
\begin{proof}
    Note that $C_c(X)/{\sim_\mu}\subseteq L^p(\mu)$ as $\mu$ is lcoally finite.
    If $E\in\B(X)$, $\mu(E)<\infty$, then by inner and outer regularity we can find for any $\epsilon>0$ and $\mu(E)<\mu(K)+\epsilon/2$, and $\mu(U)<\mu(E)+\epsilon/2$.
    Thus $\mu(U\setminus K)=\mu(U\setminus E)+\mu(E\setminus K)<\infty$.
    Then for any $K\prec f\prec U$, we have
    \begin{equation*}
        \norm{f-1_E}_\mu^p=\int|f-1_E|^p\d{\mu}\leq|1_U-1_K|^p\d{\mu}=\int1_{U\setminus K}\d{\mu}<\epsilon
    \end{equation*}
    Thus simple elements of $L^p(\mu)$ are approximated from $C_c(X)/{\sim_\mu}$, and hence arbitrary elements.
\end{proof}
\begin{theorem}
    Let $(X,d)$ be a $\sigma-$compact locally compact metric space.
    Then every locally finite measure $\nu:\B(x)\to[0,\infty]$ (i.e. $\nu(K)<\infty$, $K$ compact) is a Radon measure.
    In particular, $\nu$ is outer regular and inner regular.
\end{theorem}
\begin{proof}
    Since $\nu$ is locally finite, each $f\in C_c(X)$ is Borel measurable and $||\leq 1_{\supp f}$, so $f\in L(\mu)$.
    Since $\nu$ is non-negative, $I(f)=\int_X f\d{\nu}$ defines a positive linear function on $C_c(X)$.
    Hence, the Riesz Representation Theorem provides us with a Radon measure $\mu$ such that $\int_X f\d{\nu}=\int_X f\d{\mu}$.
    Let's show that $\nu=\mu$.

    (I) Let $U\subseteq X$ be open.
    Since $X$ is $\sigma-$compact, write $X=\bigcup_{n=1}^\infty L_n$, each $L_n\subseteq X$ compact and $L_1\subseteq L_2\subseteq\cdots$.
    For each $n$, let $F_n=\{x\in U: d(x,X\setminus U)\geq1/n\}$ and let $K_n=L_n\cap F_n\subseteq U$.
    Since $F_1\subseteq F_2\subseteq\cdots$, $K_1\subseteq K_2\subseteq\cdots$.
    Furthermore, if $x\in U$, there is $n_1$ so that $d(x,X\setminus U)\geq \frac{1}{n}$, and $n_2$ such that $x\in L_{n_2}$.
    Thus for $n\geq\max\{n_1,n_2\}$, we have $x\in K_n\cap L_n$.
    Thus $U=\bigcup_{n=1}^\infty K_n$.
    Let's choose $(f_n)_{n=1}^\infty\subset C_c(X)$ inductively:
    \begin{itemize}[nl]
        \item $K_1\prec f_1\prec U$
        \item $K_2\cup \supp f_1\prec f_2\prec U$
        \item $K_{n+1}\cup\supp f_n\prec f_{n+1}\prec U$
    \end{itemize}
    Thus $f_1\leq f_2\leq\cdots$ and $\lim_{n\to\infty}f_n=1_U$.
    Thus by MCT, we have
    \begin{equation*}
        \nu(U)=\int 1_U\d{\nu}=\lim_{n\to\infty}f_n\d{\nu}=\lim_{n\to\infty}\int f_n\d{\mu}=\int 1_U\d{\mu}=\mu(U)
    \end{equation*}

    (II) Now let $E\in\B(X)$, $\mu(E)<\infty$.
    Given $\epsilon>0$, find $K\subseteq E\subseteq V$, $K$ compact, $V$ open, so that $\mu(E)<\mu(K)+\epsilon/2$ and $\mu(V)<\mu(E)+\epsilon/2$.
    Hence by (I),
    \begin{equation*}
        \nu(V)-\nu(K) = \nu(V\setminus K) =\mu(V\setminus K)<\epsilon
    \end{equation*}
    Thus
    \begin{equation*}
        \nu(E)\leq\mu(V)<\nu(K)+\epsilon\leq\nu(E)+\epsilon
    \end{equation*}
    Thus $\nu(E)=\inf\{\nu(V):E\subseteq V,V\text{ open}\}=\inf\{\mu(V):E\subseteq V,V\text{ open}\}=\mu(E)$.

    Finally, by (II) and continuity from below, we have
    \begin{equation*}
        \mu(E)=\lim_{n\to\infty}\mu(E_n)=\lim_{n\to\infty}\nu(E_n)=\nu(E)
    \end{equation*}
\end{proof}
\begin{corollary}
    If $(X,d)$ is a $\sigma-$compact locally compact metric space, and $\mu:\B(X)\to\C$, then $\mu$ is a linear combination of up to 4 finite Radon measures.
\end{corollary}
\begin{proof}
    We consider, for example, the Jordan decomposition, $\mu=\mu_1-\mu_2+i[\mu_3-\mu_4]$.
    Each $\mu_k$ is a finite measure, and hence Radon.
\end{proof}
\begin{corollary}
    The $d-$dimensional Lebesgue measure $\lambda_d:\B(\R^d)\to[0,\infty]$ is inner and outer regular.
\end{corollary}
\begin{proof}
    We note that $\R^d=\bigcup_{n=1}^\infty\overline{B_n(0)}$ is $\sigma-$compact.
    If $K\subseteq\R^d=\bigcup_{n=1}^\infty(-n,n)^d$ is compact, then $K\subseteq(-n_0,n_0)^d$ for some $n_0$.
    Hence $\lambda_d(K)\leq\lambda_d((-n_0,n_0)^d)=(2n_0)^d<\infty$.
    Thus $\lambda_d$ is a locally finite measure on a $\sigma-$compact space, hence Radon.
\end{proof}
\begin{remark}
    If $\emptyset\neq U\subseteq\R^d$ is open, then $\lambda_d(U)>0$.
    Indeed, if $x\in U$, find $\epsilon>0$ such that $\prod_{j=1}^d(x_j-\epsilon,x_j+\epsilon)=B(x,d_\infty)\subseteq U$, and we have $\lambda_d(U)\geq(2\epsilon)^d>0$.
\end{remark}
TODO: dual of L1 is Linfty (for finite measures)
\section{Differentiation in \texorpdfstring{$\R^d$}{Rd}}
If $f:(a,b)\to\C$ is continuous and bounded (with $\lim_{t\to\infty}f(t)=f(a)$), then for $x\in(a,b)$,
\begin{equation*}
    f(x)=\frac{\d{}}{\d{t}}\left[\int_a^t f(s)\d{s}\right]=\lim_{r\to 0^+}\frac{1}{2r}\int_{x-r}^{x+r}f(s)\d{s}
\end{equation*}
We shall generalize this so integrable $f$ and $d>1$.

If $x\in\R^d$, $r>0$, we let $B_r(x)=\{y\in\R^d:\norm{x-y}_2<r\}$.
In fact, we could replace $\norm{\bigcdot}_2$ with any norm on $\R^d$ and the results will remain true as stated.
\begin{lemma}[Covering]
    Let $\mathcal{C}$ be a collection fo Euclidean balls in $\R^d$, $U=\bigcup_{B\in\mathcal{C}}B$.
    Then for any $0<c<\lambda_d(U)$, there exist $B_1,\ldots,B_n$ in $\mathcal{C}$ such that $B_i\cap B_j=\emptyset$ for $I\neq j$ and $3^d\sum_{i=1}^n\lambda_d(B_i)$.
\end{lemma}
\begin{proof}
    Since $U\neq\emptyset$, there is $c$ a above.
    By inner regularity, there is $K\subseteq U$ compact such that $\lambda_d(K)>c$.
    Since $K\subseteq U=\bigcup_{B\in\mathcal{C}}B$, there is $B'_1,\ldots,B'_m$ in $\mathcal{C}$ such that $K\subseteq \bigcup_{j=1}^m B_j'$.
    Write each $B_j'=B_{r_j'}(x_j')$, we may relabel $r_1'\geq \cdots\geq r_m'$.
    Then 
    \begin{itemize}[nl]
        \item $B_1=B_1'$
        \item $B_2=B_{j_2}'$ where $j_2=\min\{j\in[m]:B_j'\cap B_1=\emptyset\}$.
        \item $B_n=B_{j_n}'$ where $j_n=\min\{j\in\{j_{n+1}+1,\ldots,m\}:B_j'\cap\bigcup_{j=1}^{n-1}B_i\}$
    \end{itemize}
    where $n$ is determined by where this process stops.
    If $B_j'\notin\{B_1,\ldots,B_n\}$, then $B_j'\cap B_i=B_{j_i}'$ for some $j_i<j$, ro $r_i:=r_{j_i}'\geq r_j'$.
    If we write $B_i=B_{r_i}(x_i)$, then $B_j'\subseteq B_{3r_i(x_i)}$.
    Notice that
    \begin{equation*}
        \lambda_d(B_{3r_i}(x_i)=\lambda_d(3I(B_{r_i}(0))+x_i)=3^d\lambda_d(B_{r_i(x_i)})
    \end{equation*}
    Thus
    \begin{align*}
        c<\lambda_d(K)&\leq\lambda_d\left(\bigcup_{j=1}^n B_j'\right) \leq\lambda_d\left(\bigcup_{j=1}^n B_{3r_i}(x_i)\right)\\
                      &\leq\sum_{i=1}^n \lambda_d(B_{3r_i}(x_i))=3^d\sum_{i=1}^n \lambda_d(B_i)
    \end{align*}
\end{proof}
\begin{definition}
    If $f\in L(\lambda_d)$, we let $A_rf(x)=\frac{1}{\lambda_d(B_r(x))}\int_{B_r(x)} f(y)\d{y}$ denote the ``average value'', for $r>0$, $x\in\R^d$.
    We let the \textbf{Hardy-Littlewood maximal functions}
    \begin{equation*}
        Hf(x)=\sup_{r>0}A_r|f|(x)
    \end{equation*}
\end{definition}
\begin{remark}
    \begin{enumerate}[nl,r]
        \item $(r,x)\mapsto A_rf(x):(0,\infty)\times\R^d\to\R$ is continuous.
            FIrst, as above, $\lambda_d(B_r(x))=\lambda_d(rI(B_1(0)))=r^d\lambda_d(B_r(0))$.
            Second, if $((r_n,x_n))_{n=1}^\infty$ with $\lim_{n\to\infty}(r_n,x_n)=(r,x)$, then $1_{B_{r_n}(x_n)}|f|\leq|f|$ and $|\lim_{n\to\infty}1_{B_{r_n}}(x_n)f=f|$ pointwise.
            Hece by LDC,
            \begin{equation*}
                A_{r_n}f(x)=\frac{1}{r_n^d\lambda_d(B_1(0))}\int 1_{B_{r_n}(x_n)}f\overset{n\to\infty}{\longrightarrow}\frac{\int 1_{B_r(x)}f}{r^d\lambda_d(B_1(0))}=A_rf(x)
            \end{equation*}
        \item $Hf(x)=\sup_{r>0}A_r|f|(x)=\sup_{r\in(0,\infty)\cap\Q} A_r|f|(x)$ so $Hf$ is the supremum of a countable family of continuous functions and hence Borel measurable.
        \item We may define $A_rf$ and hence $Hf$ for $f$ in
            \begin{equation*}
                L_{loc}(\lambda_d)=\{f\in M(\R^d,\B(\R^d)):1_Kf\in L(\lambda_d)\text{ for any compact }K\subset\R^d\}
            \end{equation*}
    \end{enumerate}
\end{remark}
\begin{theorem}[Hardy Littlewood Maximal]
    If $f\in L(\lambda_d)$ and $\alpha>0$, then
    \begin{equation*}
        \lambda_d\left(Hf^{-1}((\alpha,\infty)]\right)\leq\frac{3^d}{\alpha}\int_{\R^d}|f|\d{\lambda}
    \end{equation*}
\end{theorem}
\begin{proof}
    Let $E_\alpha = Hf^{-1}((\alpha,\infty])$.
    Then for each $x\in E_\alpha$, $Hf(x)>\alpha$ so there is $r_x>0$ such that $A_{r_x}|f|(x)>\alpha$.
    Now, $E_\alpha\subseteq\bigcup_{x\in E_\alpha}B_{r_x}(x)=U$, so if $0<\lambda_d(E_\alpha)$ and $0<c<\lambda_d(E_\alpha)\leq\lambda_d(U)$, the last lemma provides $x_1,\ldots,x_n\in E_\alpha$ with $B_i=B_{r_{x_i}}(x_i)$ for $i=1,\ldots,n$ such that $B_i\cap B_j=\emptyset$ and $c<3^d\sum_{i=1}^n\lambda_d(B_i)$.
    Then for each $i$,
    \begin{equation*}
        \frac{1}{\lambda_d(B_i)}\int_{B_i}|f|=A_{r_{x_i}}(x_i)>\alpha\quad\Rightarrow\quad\frac{1}{\alpha}\int_{B_i}|f|>\lambda_d(B_i)
    \end{equation*}
    and hence
    \begin{equation*}
        c<3^d\sum_{i=1}^n \lambda_d(B_i)<\frac{3^d}{\alpha}\sum_{i=1}^n\int_{B_i}|f|=\frac{3^d}{\alpha}\int_{\bigcup_{i=1}^n B_i}|f|\leq\frac{3^d}{\alpha}\int|f|
    \end{equation*}
\end{proof}
\begin{corollary}
    If $f\in\overline{M}^+(X,\M)$ and $\mu:\M\to[0,\infty]$ is a measure, and $\alpha>0$, then
    \begin{equation*}
        \int_{f^{-1}((\alpha,\infty])}f\d{\mu}\geq\int_{f^{-1}((\alpha,\infty])\alpha 1\{\mu}=\alpha\mu(f^{-1}((\alpha,\infty])
    \end{equation*}
    so that
    \begin{equation*}
        \frac{1}{\alpha}\int_{f^{-1}}((\alpha,\infty])f\d{\mu}\geq\mu(f^{-1}((\alpha,\infty])
    \end{equation*}
\end{corollary}
\begin{theorem}[First Differentiation]
    If $f\in L_{loc}(\lambda_d)$, then $\lim_{r\to 0^+}A_rf(x)=f(x)$ for $\lambda_d-$a.e. in $\R^d$.
\end{theorem}
\begin{proof}
    Since $\R^d=\bigcup_{N=1}^\infty B_N(0)$, it suffices to prove this result for $1_{B_N(x)}f$.
    Hence we may assume $f\in L(\lambda)$.
    Given $\epsilon>0$, since $\lambda_d$ is a Radon measure, there is $h\in C_c(\R^d)$ such that $\int|h-f|<\epsilon$.
    Notice that
    \begin{align*}
        |A_rh(x)-h(x)|&=\left\lvert\frac{1}{\lambda_d(B_r(x))}\int_{B_r(x))}\left(h(y)-h(x)\right)\d{\lambda}\right\rvert\\
                      &= \frac{1}{\lambda_d(B_r(x))}\int_{B_r(x)}|h(y)-h(x)|\d{y}\\
                      &\leq \sup_{y\in B_r(x)}|h(y)-h(x)|\to 0
    \end{align*}
    as $r\to 0^+$.
    Thus
    \begin{align*}
        \limsup_{r\to 0^+}|A_rf(x)-f(x)|&\leq\limsup_{r\to 0^+}\left[|A_rf(x)-A_rh(x)|+|A_rh(x)|+|A_rh(x)-h(x)|+|h(x)-f(x)|\right]\\
                                        &\leq\lim_{r\to 0}\sup_{r'\in(0,r)}\left[A_r|f-h|(x)+|h(x)-f(x)|\right]\\
                                        &\leq H(f-h)(x)+|f(x)-h(x)|
    \end{align*}
    Given $\delta>0$, let $E_\delta=\{x\in\R^d:\limsup_{r\to 0^+}|A_rf(x)-f(x)|>\delta\}$.
    Then
    \begin{equation*}
        E_\delta\subseteq\left\{x\in\R^d:H(f-x)(x)>\frac{\delta}{2}\right\}\cup\left\{x\in\R^d:|f(x)-f(x)|>\frac{\delta}{2}\right\}
    \end{equation*}
    so by the Hardy-Littlewood maximal theorem and Chebeshev's inequality,
    \begin{align*}
        \lambda_d(E_\delta) &\leq\lambda_d(H(f-h)^{-1}((\delta/2,\infty]))+\lambda_d(|h-f|^{-1}((\delta/2,\infty]))\\
                            &\leq\frac{2\cdot 3^d}{\delta}\int|f-h|+\frac{2}{\delta}\int_{|f-h|^{-1}((\lambda/2,\infty])}|f-h|\\
                            &< \frac{2\cdot 3^d+2}{\delta}\epsilon
    \end{align*}
    Then, since $\epsilon>0$ is arbitrary, $\lambda_d(E_\delta)=0$.
    Then for $x\in\R^d\setminus\bigcup_{n=1}^\infty E_{1/n}$, we have $\lim_{r\to 0^+}|A_rf(x)-f(x)|=0$.
\end{proof}
\begin{corollary}
    For $f\in L_{loc}(\lambda_d)$, we define its \textbf{Lebesgue set} to be
    \begin{equation*}
        L_f=\left\{x\in\R^d:\lim_{r\to 0^+}\frac{1}{\lambda_d(B_r(x))}\int_{B_r(x)}|f(y)-f(x)|\d{y}=0\right\}
    \end{equation*}
    Then $\lambda_d^*(\R^D\setminus L_f)=0$, where $\lambda_d^*$ is tthe outer measure associated to $\lambda_d$.
\end{corollary}
\begin{proof}
    Let $\overline{\{c_n\}_{n=1}}^\infty=\C$.
    Let
    \begin{equation*}
        E_n=\left\{x\in\R^d:\limsup_{r\to 0^+}\left\lvert A_r|f-c_n1|f(x)-|f(x)-c_n|\right\rvert>0\right\}
    \end{equation*}
    so $E_n$ is a $\lambda_d-$null set, and $E=\bigcup_{n=1}^\infty E_n$ is also null.
    If $x\in\R^d\setminus E$ and $\epsilon>0$, then $|f(x)-c_n|<\epsilon$ for some $n$.
    Thus for any $y\in\R^d$,
    \begin{equation*}
        |f(y)-f(x)|\leq|f(y)-c_n|+|c_n-f(x)|<|f(y)-c_n|+\epsilon
    \end{equation*}
    Thus, as $x\notin E_n$,
    \begin{align*}
        \frac{1}{\lambda_r(B_r(x))}\int_{B_r(x)}|f(y)-f(x)|\d{y}&\leq\frac{1}{\lambda_d(B_r(\lambda))}\int_{B_r(x)}\left(|f(y)-c_n|+\epsilon)\d{y}\right)\\
                                                                &=\frac{1}{\lambda_d(B_r(x))}\int_{B_r(x)}|f(y)-c_n1(y)|\d{y}+\epsilon\\
                                                                &\fto{r\to 0^+}|f(x)-c_n|+\epsilon<2\epsilon
    \end{align*}
    Thus as $\epsilon>0$ is arbitrary, the limit
    \begin{equation*}
        \lim_{r\to 0^+}\frac{1}{\lambda_d(B_r(x))}\int_{B_r(x)}|f(y)-f(x)|\d{y}=0
    \end{equation*}
    for $x\in E$.
    We have $\R^d\setminus E\subseteq L_f$, so $\R^d\setminus L_f\subseteq E$.
\end{proof}

\begin{theorem}
    Let $\mu:\B(\R^d)\to[0,\infty]$ be a locally finite measure such that $\mu\perp\lambda_d$.
    Then
    \begin{equation*}
        \lim_{r\to 0^+}\frac{\mu(B_r(x))}{\lambda_d(B_r(x))}=0
    \end{equation*}
    for $\lambda_d-$a.e. $x$.
\end{theorem}
\begin{proof}
    Let $(E,F)$ be a Borel partition of $\R^d$ such that $\mu(F)=0=\lambda_d(E)$.
    For $\delta>0$, let
    \begin{equation*}
        F_\delta=\left\{x\in F:\limsup_{r\to 0^+}\frac{\mu(B_r(x))}{\lambda_d(B_r(x))}>\delta\right\}
    \end{equation*}
    Since $\mu$ is a Radon measure, given $\epsilon>0$, there is open $U\supseteq F$ such that $\mu(E)\epsilon$.
    If $x\in F_\delta\subseteq F\subseteq U$, there is $r_x>0$ be so that
    \begin{equation*}
        B_x:=B_{r_x(x)}\subseteq U\text{ and }\frac{\mu(B_x)}{\lambda_d(B_x)}\geq\delta
    \end{equation*}
    Then $F_\delta\subseteq\bigcup_{x\in F_\delta}B_x:=V\subseteq U$ and given $0<f<\lambda_d(V)$, we may find $B_{x_1},\ldots,B_{x_n},x_1,\ldots,x_n\in F_\delta$ such that
    \begin{equation*}
        B_{x_i}\cap B_{x_j}=\emptyset\text{ and }c<3^d\sum_{i=1}^n \lambda_d(B_{x_i})
    \end{equation*}
    Thus,
    \begin{align*}
        c<e^d\sum_{i=1}^n\lambda_d(B_{x_i})\leq\frac{3^d}{\delta}\sum_{i=1}^n\mu(B_{x_i})=\frac{3^d}{\delta}\sum_{i=1}^n\mu\left(\bigcup_{i=1}^n B_{x_i}\right)\\
        &\leq\frac{3^d}{\delta}\mu(V)\leq\frac{3^d}{\delta}\mu(U)<\frac{3^d}{\delta}\epsilon
    \end{align*}
    But then we have
    \begin{equation*}
        \lambda_d^*(F_\delta)\leq\lambda_d(V)=\lim_{c\to\lambda_d(V)^-}c\leq\frac{3^d}{\delta}\epsilon
    \end{equation*}
    since $\epsilon>0$ is arbitrary, we see that $\lambda_d^*(F_\delta)=0$.
    Hence, if $x\in\R^d\setminus\bigcup_{k=1}^\infty F_{1/k}$, then
    \begin{equation*}
        \lim_{r\to 0^+}\frac{\mu(B_r(x))}{\lambda_d(B_r(x))}=0
    \end{equation*}
\end{proof}
\begin{definition}
    A collection of sets $\{E_r(x):x\in\R^d,r>0\}\subseteq\B(\R^d)$ is called \textbf{nicely shrinking} if for each $x\in\R^d$, $r>0$,
    \begin{itemize}[nl]
        \item $E_r(x)\subseteq B_r(x)$
        \item $\lambda_d(E_r(x))>\alpha\lambda_d(B_r(x))$, where $\alpha$ is a fixed constant.
    \end{itemize}
\end{definition}
\begin{corollary}
    Let $\nu:\B(\R^d)\to\C$ be a complex measure with Lebesgue-Radon-Nikodym decomposition
    \begin{equation*}
        \nu=\rho+f\cdot\lambda_d,\rho\perp\lambda_d,f\in L(\lambda_d)
    \end{equation*}
    Then for any nicely shrinking family $\{E_r(x):x\in\R^d,r>0\}$, we have
    \begin{equation*}
        \lim_{r\to 0^+}\frac{\nu(E_r(x))}{\lambda_d(E_r(x))}=f(x)
    \end{equation*}
    for $\lambda_d-$a.e. $x$ in $\R^d$.
\end{corollary}
\begin{proof}
    Write $\rho=\Re\rho^+-\Re\rho^-+i[\Im\rho^+-\Im\rho^-]$, $\Re\rho^+,\ldots,\Im\rho^-\leq|\rho|\leq\Re\rho^++\cdots+\Im\rho^-$.
    Thus each $\Re\rho^+,\ldots,\Im\rho^-\perp\lambda_d$.
    By Differentiation Theorem II, we see that
    \begin{equation*}
        \lim_{r\to 0^+}\frac{\mu(E_r(x))}{\lambda_d(E_r(x))}\leq\lim_{r\to 0^+}\frac{\mu(B_r(x))}{\alpha\lambda_d(B_r(x))}=0
    \end{equation*}
    $\lambda_d-$a.e.
    Hence we conclude the same for $\rho$.
    On the other hand,
    \begin{equation*}
        \left\lvert\frac{1}{\lambda_d(E_r(x))}\int_{E_r(x)}f(x)\d{y}-f(x)\right\rvert &\leq\frac{1}{\lambda_d(E_r(x))}\int_{E_r(x)}|f(y)-f(x)|\d{y}\\
                                                                                      &\leq\frac{1}{\alpha\lambda_d(B_r(x))}\int_{B_r(x)}|f(y)-f(x)|\d{y}\\
                                                                                      &\fto{r\to 0^+} 0
    \end{equation*}
    provided that $x\in L_f$.
\end{proof}
\begin{proposition}
    If $F\in\ND_r(\R)$, then $F'(x)$ exists for $\lambda-$a.e. $x$ in $\R$.
\end{proposition}
\begin{proof}
    If $h\neq 0$, then
    \begin{equation*}
        \frac{F(x+h)-F(x)}{h}=
        \begin{cases}
            \frac{\mu_F((x,x+h])}{\lambda_d((x,x+h])}&:h>0\\
            \frac{\mu_F((x+h,x])}{\lambda_d((x+h,x])}&:h<0
        \end{cases}
    \end{equation*}
    Since each family $\{(x,x+h]:x\in\R,h>0\}$ and $\{(x-h,x]:x\in\R,h>0\}$ is nicely shrinking, we see that
    \begin{equation*}
        \lim_{h\to 0^+}\frac{F(x+h)-F(x)}{h},\lim_{h\to 0^-}\frac{F(x+h)-F(x)}{h}
    \end{equation*}
    converge for $\lambda-$a.e. $x$, s right and left limits both exist for such $x$.
    However, each is $\lambda-$a.e. equal to $\frac{\d{\mu_F}}{\d{\lambda}}$, thanks to the last corollary.
    Hence $F'$ exists $\lambda-$a.e.
\end{proof}
\begin{example}
    Consider the Cantor ternary function $\phi\in\ND_r(\R)$.
    It is easy to see that $\phi'(x)=0$ whenever $x\in\R\setminus C$.
\end{example}
\begin{definition}
    Let $F:\R\to\C$.
    If $a<b$ in $\R$, we define the \textbf{variation} of $F$ on $[a,b]$ by
    \begin{equation*}
        V_F[a,b]=\sup\left\{\sum_{i=1}^n|F(a_i)-F(a_{i-1})|:a=a_0<a_1<\cdots<a_n=b,n\in\N\right\}
    \end{equation*}
\end{definition}
\begin{example}
    Consider $F(x)=x\sin(1/x)$ for $x>0$, and $0$ when $x=0$.
    Then $V_F[0,\epsilon]=\infty$ for $\epsilon>0$.
\end{example}
\begin{proposition}
    \begin{enumerate}[nl,r]
        \item If $a<b<c$, then $V_F[a,c]=V_F[a,b]+V_F[b,c]$.
        \item If $a'\leq a\leq b\leq b'$, then $V_F[a,b]\leq V_F[a',b']$
    \end{enumerate}
\end{proposition}
\begin{definition}
    Define $V_F(a,b]=\lim_{x\to a^} V_F[x,b]$ and $V_F(-\infty,b]=\lim_{x\to -\infty}V_F[x,b]$.
\end{definition}
\begin{proposition}
    \begin{enumerate}[nl,r]
        \item If $F$ is right continuous at $a$ and $V_F[a,b]<\infty$, then $V_F(a,b]=V_F[a,b]$.
        \item If $V_F(-\infty,b]<\infty$, then $\lim_{x\to -\infty}(-\infty,x]=0$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[r]
        \item Certainly $V_F(a,b]\leq V_F[a,b]$.
            To see the converse inequality, given $\epsilon>0$, let $\delta>0$ be such that $a<x<a+\delta$ so $|F(x)-F(a)|<\epsilon$.
            Now we let $a<a_0<\cdots<a_n=b$ be so
            \begin{itemize}[nl]
                \item $\sum_{i=1}^n|F(a_i)-F(a_{i-1})|>V_F[a,b]-\epsilon$
                \item $a<a+1<a+\delta$
            \end{itemize}
            Then
            \begin{align*}
                V_f[a,b] &< |F(a_1)-F(a_0)|+\sum_{i=2}^n|F(a_i)-F(a_{i-1})|+\epsilon\\
                         &< \epsilon+V_F[a_1,b]+\epsilon\leq V_F(a,b]+2\epsilon
            \end{align*}
            Since $\epsilon>0$ is arbitrary, $V_F[a,b]\leq V_F(a,b]$.
        \item For fixed $x<b$, then by (A)
            \begin{align*}
                V_F(-\infty,b] &= \lim_{y\to -\infty}V_F[y,b]\\
                               &= \lim_{y\to -\infty,y<x}\left(V_F[y,x]+V_F[x,b]\right)\\
                               &= V_F(-\infty,x]+V_F[x,b]
            \end{align*}
            Then take $x\to -\infty$.
    \end{enumerate}
\begin{definition}
    If $V_F(-\infty,x]<\infty$ for each $x\in\R$, we define the \textbf{total variation} function of $F$ by $T_F(x)=V_F(-\infty,x]\in[0,\infty)$.
    If $\sup_{x\in\R}T_F(x)<\infty$, we say that $F$ is of \textbf{bounded variation}.
    Write $F\in\BV(\R)$.
    We further let
    \begin{equation*}
        \BV_r(\R)=\{F\in \BV(\R):F\text{ is right continuous}\}
    \end{equation*}
\end{definition}
\begin{remark}
    \begin{enumerate}[nl,r]
        \item It follows (ii) that $T_F(-\infty)=\lim_{x\to -\infty}T_F(x)=0$.
        \item If $F\in \BV_r(\R)$, then $T_F$ is right continuous.
            Let $a<x<b$, and we use ($*$), (A), and part (i) of the last proposition to see that
            \begin{align*}
                T_F(x)-T_F(a) &= V_F[a,x]=V_F[a,b]-V_F[x,b]\\
                              &= V_F(a,b]-V_F[x,b]\to 0
            \end{align*}
            so $\lim_{x\to a^+}T_F(x)=T_F(a)$.
    \end{enumerate}
\end{remark}
\begin{proposition}
    \begin{enumerate}[nl,r]
        \item $F\in\BV(\R)$ if and only if $\Re F$, $\Im F\in\BV(\R)$
        \item If $G\in\BV^{\R}(\R)$, then each of $T_F\pm F$ is non-decreasing.
        \item If $F\in\BV(\R)$, we let
            \begin{align*}
                F_1 &= \frac{1}{2}\left(T_{\Re F}+ \Re F\right), & F_2&=\frac{1}{2}\left(T_{\Re F}-\Re F\right)\\
                F_3 &= \frac{1}{2}\left(T_{\Im F}+ \Im F\right), & F_4&=\frac{1}{2}\left(T_{\Im F}-\Im F\right)
            \end{align*}
            Then $F=F_1-F_2+i[F_3-F_4]$.
            Thus, $F$ is bounded and $F(\pm\infty)=\lim_{x\to \pm\infty}F(x)$ exists.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[r]
        \item If $x<y$ in $\R$, then by using definitions of $V_H$, $H=F,\Re F,\Im F$, we see
            \begin{equation*}
                V_{\Re F}[x,y],V_{\Im F}[x,y]\leq V_F[x,y]\leq V_{\Re F}[x,y]+V_{\Im F}[x,y]
            \end{equation*}
            Taking $x\to -\infty$, we see that
            \begin{equation*}
                T_{\Re F}(x),T_{\Im F}(y\leq T_F(y)\leq T_{\Re F}(y)+T_{\Im F}(y)
            \end{equation*}
            and then taking $y\to\infty$ does the job.
        \item If $x<y\in\R$, then
            \begin{align*}
                (T_G\pm G)(y)-(T_G\pm G)(x)&=T_G(y)-T_G(x)\pm[G(y)-G(x)]\\
                                           &= V_G[x,y]+[G(y)-G(x)]\geq|G(y)-F(x)|\pm[G(y)-F(x)]\geq 0
            \end{align*}
            Furthermore, $T_G(\pm\infty)$ always exists...
        \item Obvious
\end{proof}
\begin{remark}
    If $F$ above is right continuous, so too are $\Re F$, $\Im F$, and ence $F_1,F_2,F_3,F_4$.
    If $F:\R\to\R$ is bounded, then $F\in\BV^{\R}(\R)$.
\end{remark}
\begin{theorem}[Complex Borel Measures on $\R$]
    Let $F\in\BV_r(\R)$.
    \begin{enumerate}[nl,r]
        \item There is a complex measure $\mu_F:\mathcal{B}(\R)\to\C$ such that
            \begin{equation*}
                \mu_F((a,b])=F(b)-F(a)\text{ for }a<b\text{ in }\R\tag{$\dagger$}
            \end{equation*}
        \item If $G\in\BV_r^{\R}(\R)$ (real-valued), then $|\u_G|=\mu_{T_G}$.
            Hence $\mu_G^\pm=\mu_{\frac{1}{2}(T_G\pm G)}$ and the two notions of Jordan decomposition coincide for $F$.
        \item If $\nu:\B(\R)\to\C$ is any measure such that
            \begin{equation*}
                \nu((a,b])=F(b)-F(a)\text{ for }a<b\text{ in }\R\tag{$\dagger\dagger$}
            \end{equation*}
    \end{enumerate}
\end{theorem}
\begin{proof}

    \begin{enumerate}[nl,r]
        \item Let $F=F_1-F_2+i[F_3-F_4]$.
            Then each $F_K\in\ND_r(\R)$ and corresponds to a measure $\mu_{F_k}$ satisfying the analogue of ($\dagger$).
            Let $\mu_K=\mu_{F_1}-\mu_{F_2}+i[\mu_{F_3}-\mu_{F_4}]$.
        \item Let $a<b$ in $\R$.
            we recall that
            \begin{itemize}[nl]
                \item $\displaystyle|\mu_G|((a,b])=\sup\left\{\sum_{i=1}^n|\mu_G(E_i)|:\{E_1,\ldots,E_n\}\text{ is a Borel partition of }(a,b],n\in\N\right\}$
                \item $\mu_{T_G}((a,b])=T_G(b)-T_G(a)=V_G[a,b]=\sup\left\{\sum_{i=1}^n\abs{G(a_i)-G(a_{i-1})}:(a,b]=\bigcupdot_{i=1}^n (a_{i-1},a_i],n\in\N\right\}$
            \end{itemize}
            Hence, it is immediate that $\mu_{T_G}((a,b])\leq|\mu_G((a,b])$.

            Now, $\abs{\mu_G((a,b])}=|G(b)-G(a)|\leq V_G[a,b]=T_G(b)-T_G(a)=\mu_{T_G}((a,b])$.
            We let $\mathcal{H}=\{(c,d]:a\leq c<d\leq b\}$ and for any $A\in\langle\mathcal{H}\rangle\subseteq\mathcal{P}((a,b])$, we have $A=\bigcupdot_{i=1}^n(c_i,d_i]$ and hence we have
            \begin{align*}
                |\mu_G(A)|=\abs{\sum_{i=1}^n\mu_G((c_i,d_i]))} &\leq \sum_{i=1}^n|\mu_G((c_i,d_i])|\\
                                                              &\leq \sum_{i=1}^n\mu_{T_G}((c_i,d_i])=\mu_{T_G}(A)
            \end{align*}
            We let $\mathcal{C}=\{E\in\mathcal{B}((a,b]):|\mu_G(E)|\leq\mu_{T_G}(E)\}$.
            Then
            \begin{itemize}[nl]
                \item $\langle\mathcal{H}\rangle\subseteq\mathcal{C}$
                \item If $E_1\supseteq E_2\supseteq\cdots$ in $\mathcal{C}$, then by continuity from above,
                    \begin{equation*}
                        \abs{\mu_G\left(\bigcap_{n=1}^\infty E_n\right)}=\lim_{n\to\infty}\abs{\mu_G(E_n)}\leq\lim_{n\to\infty}\mu_{T_G}
                    \end{equation*}
                \item If $E_1\subseteq E_2\subseteq\cdots$ in $\mathcal{C}$, then by continuity from below,
                    \begin{equation*}
                        \abs{\mu_G\left(\bigcup_{n=1}^\infty E_n\right)}\leq\mu_{T_G}\left(\bigcup_{n=1}^\infty E_n\right)
                    \end{equation*}
            \end{itemize}
            Thus by the Monotone Class Lemma, $C\supseteq\sigma\langle\mathcal{H}\rangle=\B((a,b])$, so $\mathcal{C}=\B((a,b])$.
            Thus, for any Borel partition $\{E_1,\ldots,E_n\}$ of $(a,b]$, we have
            \begin{equation*}
                \sum_{i=1}^n\abs{\mu_G(E_i)}\leq\sum_{i=1}^n\mu_{T_G}(E_i)=\mu_{T_G}\left(\bigcup_{i=1}^n E_i\right)=\mu_{T_G}((a,b])
            \end{equation*}
            Thus, $|\mu_G|((a,b])\leq\mu_{T_G}((a,b])$.
            In conclusion, $|\mu_G|((a,b])=\mu_{T_G}((a,b])$ and hence, by characterization of (locally) finite Borel measures on $\R$, $|\mu_G|=\mu_{T_G}$.

            We have
            \begin{equation*}
                \mu_G^\pm=\frac{1}{2}(|\mu_G|\pm\mu_G)=\frac{1}{2}(\mu_{T_G}\pm\mu_G)=\mu_{\frac{1}{2}(T_G\pm G)}
            \end{equation*}
        \item If $\nu$ satisfies $(\dagger\dagger)$, then we see for $a<b$ in $\R$ that
            \begin{equation*}
                \Re v\nu((a,b])=\Re F(b)-\Re F(a)=\mu_{\Re F}((a,b])
            \end{equation*}
            By (i), $\Re\nu$, $\mu_{\Re F}$ admit the same Jordan decompsition at least on intervals of the form $(a,b]$.
            Hence, by uniqueness for measures, $\Re\nu=\mu_{\Re F}$.
            Likewise, $\Im\nu=\mu_{\Im F}$.
    \end{enumerate}
\end{proof}
\begin{definition}
    If $F:\R\to\C$ is \textbf{absolutely continuous}, write $F\in\AC(\R)$, provided: given $\epsilon>0$, there is $\delta>0$ such that $a_1\leq b_1\leq a_2\leq b_2\leq\cdots\leq a_n\leq b_n$ such that $\sum_{i=1}^n(b_i-a_i)<\delta$, we have $\sum_{i=1}^n|F(b_i)-F(a_i)|<\epsilon$.
\end{definition}
Note that Lipschitz$\Rightarrow$Absolutely continuous$\Rightarrow$uniformly continuous$\Rightarrow$ continuous.
\begin{proposition}
    If $F\in\BV(\R)\cap\AC(\R)$, then $T_F\in\AC(\R)$.
\end{proposition}
\begin{proof}
    Given $\epsilon>0$, find $\delta>0$ as in absolute continuity, with $a_i<b_i$.
    Then as $F\in\BV(\R)$, for each $i=1,\ldots,n$, we find $a_i=t_{i,0}<\cdots<t_{i,m_i}=b_i$ be so
    \begin{equation*}
        \sum_{j=1}^{m_i}|F(t_{i,j})-F(t_{i,j-1})|>V_F[a_i,b_i]-\epsilon/2^i
    \end{equation*}
    Then
    \begin{equation*}
        \sum_{i=1}^n|T_F(b_i)-T_F(a_i)| &= \sum_{i=1}^n V_F[a_i,b_i]\\
                                        &<\sum_{i=1}^n\left(\sum_{j=1}^{m_i}|F(t_{i,j})-F(t_{i,j-1})|+\frac{\epsilon}{2^i}\right)\\
                                        &<2\epsilon
    \end{equation*}
    since $\sum_{i=1}^n\sum_{j=1}^{m_i}(t_{i,j}-t_{i,j-1})=\sum_{i=1}^n (b_i-a_i)<\delta$.
\end{proof}
\begin{theorem}[Fundamental Theorem of Calculus]
    \begin{enumerate}[nl,r]
        \item If $F\in\BV(\R)\cap\AC(\R)\subseteq\BV_r(\R)$, then $\mu_F\ll\lambda$.
        \item If $f\in L(\lambda)$, then $F(x)=\int_{-\infty}^xf(t)\d{\lambda(t)}$ satisfies $F\in\BV(\R)\cap\AC(\R)$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}[r]
        \item By Jordan decomposition of $F$, it suffices to show this for $F\in\AC(\R)\cap\ND(\R)$.
            Let $E\in\B(\R)$ be so $\lambda(E)>0$.
            Given $\epsilon>0$, let $\delta>0$ be as in the definition of absolute continuity.
            Let $\{(a_i,b_i]\}_{i=1}^\infty$ be so $E\subset\bigcup_{i=1}^\infty(a_i,b_i]$ and $\sum_{i=1}^\infty(b_i-a_i)=\sum_{i=1}^\infty\lambda((a_i,b_i])<\delta$.
            Find a sequence $\{(a_i',b_i']\}_{i=1}^\infty$ be such that there are $m_1<m_2<\cdots$ such that
            \begin{equation*}
                \bigcup_{i=1}^n(a_i,b_i]=\bigcupdot_{i=1}^{m_n}(a_i',b_i'],\qquad(a_i',b_i']\cap(a_j',b_j']=\emptyset\text{ if }i\neq j
            \end{equation*}
            Then for each $n$, $\sum_{i=1}^{m_n}(b_i'-a_i')\leq\sum_{i=1}^n(b_i-a_i)<\delta$ so
            \begin{align*}
                \mu_F(E)\leq\mu_F\left(\bigcup_{i=1}^\infty(a_i,b_i]\right) &= \lim_{n\to\infty}\mu_F\left(\bigcup_{i=1}^n(a_i,b_i]\right)\\
                                                                     &= \lim_{n\to\infty}\mu_F\left(\bigcupdot_{i=1}^{m_n}(a_i',b_i']\right)\\
                                                                     &= \lim_{n\to\infty}\sum_{i=1}^n\left[F(b_i')-F(a_i')\right]\leq\epsilon
            \end{align*}
            as $\epsilon>0$, we conclude that $\mu_F(E)=0$.
        \item Write $f=\Re f^+-\Re f^-+i[\Im f^+-\Im f^-]$ so
            \begin{equation*}
                F(x)=f\cdot\mu((-\infty,x])=\Re f^+\cdot\mu((-\infty,]) - \cdots +i \Im f^+\cdot\mu((-\infty,x])
            \end{equation*}
            is a linear combination of 4 non-decreasing bounded functions.
            Thus $F\in\BV(\R)$.

            We recall a proposition proven prior; since $|f|\cdot\lambda\ll\lambda$, the alternate characterization of absolute continuity applies.
            Hence if $a\leq b_1\leq a_2\leq b_2\leq\cdots\leq a_n\leq b_n$ in $\R$ with
            \begin{equation*}
                \lambda\left(\bigcup_{i=1}^n(a_i,b_i]\right)=\sum_{i=1}^n(b_i-a_i)<\delta
            \end{equation*}
            then
            \begin{align*}
                \sum_{i=1}^n|F(b_i)-F(a_i)| &= \sum_{i=1}^n\left\lvert\int_{(a_i,b_i]}f\d{\lambda}\right\rvert\\
                                            &\leq \sum_{i=1}^n\int_{(a_i,b_i]}|f|\d{\lambda}=|f|\cdot\lambda\left(\bigcup_{i=1}^n(a_i,b_i])\right)<\epsilon
            \end{align*}
            Hence, $F\in\AC(\R)$.
    \end{enumerate}
\end{proof}
\begin{remark}
    $F\in\BV(\R)\cap\AC(\R)$ if and only if there is $f\in L(\lambda)$ such that $F'=f$ $\lambda-$a.e., and $F(x)=\int_{-\infty}^x f\d{\lambda}$.
    Indeed, we saw earlier that $F\in\BV_r(\R)$ is $\lambda-$a.e. differentiable.
    Since $F\in\BV(\R)\cap\AC(\R)$, $\mu_F\ll\lambda$ implies $\mu_F=f\cdot\lambda$ and hence $F'=f$ $\lambda-$a.e. by Differentiation Theorem 1.
    Converse is just given.
\end{remark}
\end{document}
